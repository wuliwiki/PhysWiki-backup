% 傅里叶级数（指数）
% 微积分|傅里叶级数|欧拉公式|狄利克雷条件|指数函数|三角函数|函数基底

\pentry{傅里叶级数（三角）\upref{FSTri}， 欧拉公式\upref{CExp}}
$f(x)$ 是自变量为实数的复变函数，若满足狄利克雷条件，则可在区间 $[- l,l]$ 展开成复数的傅里叶级数
\begin{equation}\label{FSExp_eq1}
f(x) = \sum_{n =  - \infty }^{ + \infty } c_n \exp ( \I\frac{n\pi }{l}x )
\end{equation}
其中 $c_n$ 是复常数， 可以用定积分\upref{DefInt}计算
\begin{equation}\label{FSExp_eq2}
c_n = \frac{1}{2l} \int_{ - l}^l  f(x)\exp( -\I\frac{n\pi }{l}x ) \dd{x} 
\end{equation}
当 $f(x)$ 为实函数时，$c_n$ 与 $c_{-n}$ 互为复共轭．当 $f(x)$ 为偶函数或奇函数时，分别有 $c_{-n} = c_n$ 或 $c_{-n} = -c_n$．

\subsection{几何理解}
若把\autoref{FSExp_eq1} 中的 $x$ 改成时间 $t$， 那么 $f(t)$ 可以看作是复平面上一个点随时间的运动． 而根据欧拉公式（\autoref{CExp_eq2}~\upref{CExp}）， \autoref{FSExp_eq1} 中的每一项， 则是平面上一个矢量的匀速圆周运动（$n=0$ 的项是例外， 它不随时间变化）． 由于复数的加法相当于复平面上矢量的相加（\autoref{GVecOp_fig1}~\upref{GVecOp}）， 那么 $f(t)$ 所代表的运动就是从坐标原点出发， 把所有这些做圆周运动的矢量首尾相接后， 最后一个矢量的末端的运动．

\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/FSExp_1.png}
\caption{动画见\href{https://wuli.wiki/apps/FFTplt.html}{这里}． 这里的曲线使用小时百科的图标\upref{xwLogo}． 代码见 “用傅里叶级数画曲线（Matlab）\upref{FFTdrw}”．} \label{FSExp_fig1}
\end{figure}

根据\autoref{FSExp_eq1}， 第 $n$ 个圆周运动的角速度为 $\omega_n = n\pi/l$， 注意逆时针为正， 顺时针为负． 周期为 $T_n = 2\pi/\omega = 2l/n$（$n\ne 0$）． 也就是说在一个周期内， $n=1$ 的圆周运动在时间 $T = 2l$ 内逆时针转一圈， $n=2$ 的逆时针转两圈， $n=-1$ 的顺时针转一圈， $n=-2$ 的顺时针转两圈……

\subsection{推导}
类比三角傅里叶级数\upref{FSTri}的情况．这时，完备正交归一的函数基底变为
\begin{equation}\label{FSExp_eq3}
f_n(x) = \exp( \I\frac{n\pi }{l}x ) \quad{n \in N}
\end{equation} 
定义复函数 $f(x)$ 与 $g(x)$ 的内积为
\begin{equation}
\braket{f}{g} = \int_{-l}^{l}  f(x)\Cj g(x) \dd{x}
\end{equation}
可证明函数基底（\autoref{FSExp_eq3} ）正交且模长为 $2l$， 用克罗内克 $\delta$ 函数%未完成：词条
表示为
\begin{equation}\label{FSExp_eq4}
\braket{f_m}{f_n} = 2l \delta_{mn}
\end{equation}
与三角傅里叶级数同理，可得\autoref{FSExp_eq1} 和\autoref{FSExp_eq2}．

\subsection{与三角傅里叶级数的关系}
% 未完成
考虑到正余弦函数和复指数函数的关系
\begin{equation}
\cos x = \frac{\E^{\I x} + \E^{-\I x}}{2}, \qquad
\sin x = \frac{\E^{\I x} - \E^{-\I x}}{2\I}
\end{equation}
三角傅里叶级数的系数\autoref{FSTri_eq2}~\upref{FSTri} 和\autoref{FSTri_eq3}~\upref{FSTri}可以用指数傅里叶级数的系数表示
\begin{equation}
\ali{
a_n &= \frac{1}{l}\int_{ - l}^l f( x )\cos (\frac{n\pi }{l}x) \dd{x}\\
&=  \frac{1}{2l}\int_{ - l}^l f( x )\exp(\I\frac{n\pi }{l}x) \dd{x} + \frac{1}{2l}\int_{ - l}^l f( x )\exp(-\I\frac{n\pi}{l}x) \dd{x} \\
&= c_{-n} + c_n
}\end{equation}
同理，
\begin{equation}\ali{
b_n &= \frac{c_{-n}-c_n}{\I}
}\end{equation}
注意这里全都有 $n\geqslant 0$． 由以上两式，也可以解得
\begin{equation}\label{FSExp_eq9}
c_n = \frac{a_n - \I b_n}{2}, \qquad
c_{-n} = \frac{a_n + \I b_n}{2}
\end{equation}

\subsection{实函数，奇函数，和偶函数的情况}
特殊地，当 $f(x)$ 为实函数时，由于 $a_n$ 和 $b_n$ 必定是实数，根据\autoref{FSExp_eq9} 可知
\begin{equation}
c_{-n} = c_{n}\Cj
\end{equation}
即正负系数互为复共轭．当 $f(x)$ 为偶函数或奇函数时， 三角傅里叶级数分别只有 $a_n$ 或 $b_n$ 不为零\upref{FSTri}， 同样根据\autoref{FSExp_eq9} 可得，两种情况分别对应
\begin{equation}
c_{-n} = c_n =\frac{a_n}{2}, \qquad
c_{-n} = -c_n = \I \frac{b_n}{2}
\end{equation}
由以上两式可得，如果 $f(x)$ 既是实函数又是偶函数时，$c_n$ 和 $c_{-n}$ 是相等的实数，如果既是实函数又是奇函数，$c_n$ 和 $c_{-n}$ 是相反的纯虚数．

\subsection{性质}
\begin{equation}
\int_{-l}^l \abs{f^2(x)} \dd{x} =  2l\sum_n \abs{c_n}^2
\end{equation}
证明： 用狄拉克符号记为 $\ket{f} = \sum_n c_n \ket{n}$， 利用基底的正交性（\autoref{FSExp_eq4}）
\begin{equation}
\braket{f}{f} = \sum_i c_i^* \bra{i} \sum_j c_j \ket{j} = 2l \sum_{i,j} \abs{c_i}^2 \delta_{i,j} = 2l \sum_n \abs{c_n}^2
\end{equation}
如果把基底为正交归一化（每个基底 $\ket{n}$ 除以 $\sqrt{2l}$， 使得 $\braket{i}{j} = \delta_{i,j}$， 则有更简洁的关系
\begin{equation}\label{FSExp_eq5}
\int_{-l}^l \abs{f^2(x)} \dd{x} =  \sum_n \abs{c_n}^2
\end{equation}

\subsection{任意区间}
\addTODO{任意区间 $[a, b]$ 的函数展开成傅里叶级数， 有多种方式， 取决于周期是多少， 或者区间两端的边界条件． $T = 2\pi/\Delta \omega$， $\Delta\omega$ 就是相邻两项的频率之差． 事实上只要 $T > b - a$ 都可以． 其实这比三角傅里叶级数要简单， 因为 $\exp$ 里面的相位可以提到系数中．}

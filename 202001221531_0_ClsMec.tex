% 经典力学笔记
% 正则动量|拉格朗日方程形式不变性|泊松括号|正则坐标

拉格朗日方程为
 \begin{equation}
\dv{t} \pdv{L}{\dot q_i}  = \pdv{L}{q_i}  \qquad L(q,\dot q, t) = T - V
\end{equation}

正则动量（canonical momentum） $p_i = \pdv*{L}{\dot q_i}$，  广义力（generalized force） $\pdv*{L}{q_i}$，  拉氏方程就是广义力与正则动量的牛顿第二定律． 对于任何广义坐标， 拉格朗日方程的形式不变．

拉格朗日变换（略） 后， 得到哈密顿正则（canonical）方程为
\begin{equation}\leftgroup{
&\dot q_i = \pdv*{H}{p_i} \\
&\dot p_i = -\pdv*{H}{q_i}
}\end{equation} 
其中 $H(p,q) = T + V$． 

\subsection{泊松括号}

对任意物理量 $\omega (q,p)$，   都有
\begin{equation}
\dot \omega  = \sum_i \qty[ \pdv{\omega}{q_i} \dot q_i + \pdv{\omega}{p_i} \dot p_i ]  = \sum_i \qty[\pdv{\omega}{q_i} \pdv{H}{p_i} - \pdv{H}{q_i} \pdv{\omega}{p_i} ]  =  \pb{\omega}{H} 
\end{equation}
量子力学中的对易算符对应泊松括号． 注意该物理量不能显含时间， 即不能是 $\omega (q,p,t)$．  所以若泊松括号消失， 则该物理量守恒！ 当显含时间时
\begin{equation}
\dot \omega  =  \pb{\omega}{H}  + \pdv{\omega}{t}
\end{equation}
对应量子力学中的算符平均值演化方程． 注意若调换泊松括号里面的物理量， 结果取相反数．


\subsection{坐标变换}

若变换到另一套广义坐标 $q'(q)$
\begin{equation}
\dot q'_i = \sum_j \pdv{q'_i}{q_j} \dot q_j \qquad
\dot q_i = \sum_j \pdv{q_i}{q'_j} \dot q'_j
\end{equation}
拉格朗日量是系统的状态量， 所以 $L(q',\dot q', t) = L[q(q'),\dot q(q',\dot q'), t]$，  所以
\begin{equation}
p'_i = \pdv{L}{\dot q'_i} = \sum_k \pdv{L}{\dot q_k} \pdv{\dot q_k}{\dot q'_i}  = \sum_k \pdv{q_k}{q'_i} p_k
\end{equation}
这就从坐标变换推出了动量变换． 对于任何广义坐标以及对应的正则动量， 哈密顿方程的形式不变（因为拉格朗日方程的形式不变， 哈密顿是由拉格朗日推出来的）． 但是还有其他情况也不变， 所有使正则方程成立的坐标叫做正则坐标（canonical coordinates）． 下面推导判断正则坐标的一般条件．

对于不显含时的物理量有
\begin{equation}
\dot \omega  = \pb{\omega}{H}  = \sum_i \qty[\pdv{\omega}{q_i}\pdv{H}{p_i} - \pdv{H}{q_i} \pdv{\omega}{p_i}]
\end{equation}
现在若把 $H$ 看成是 $H[q'(q,p),p'(q,p)]$，  
\begin{equation}
\pdv{H}{p_i} = \sum_k \pdv{H}{q'_k} \pdv{q'_k}{p_i} + \pdv{H}{p'_k} \pdv{p'_k}{p_i}
\end{equation}
\begin{equation}
\pdv{H}{q_i} = \sum_k \pdv{H}{q'_k} \pdv{q'_k}{q_i} + \pdv{H}{p'_k} \pdv{p'_k}{q_i}
\end{equation}
 
代入得， 并对 $H$ 的偏微分合并同类项得
\begin{equation}
\dot \omega  = \pb{\omega}{H} = \sum_k \qty[ \pdv{H}{q'_k} \pb{\omega}{q'_k} + \pdv{H}{p'_k} \pb{\omega}{p'_k}]
\end{equation}
注意泊松括号是对 $q,p$ 进行偏微分， 记为 $\{ {}\}_{q,p}$．  分别代入 $\omega  = q'_i, p'_i$，  得到转换坐标后的哈密顿方程的一般形式． 为了保持正则方程的形式， 必须要求
\begin{equation}
\pb{q'_i}{q'_k}_{q,p} = 0 = \pb{p'_i}{p'_k}_{q,p}
\end{equation}
\begin{equation}
\pb{q'_i}{p'_k}_{q,p} = \delta_{ik}
\end{equation}
这就是判断正则变换的一般条件．

可以证明， 用任何正则坐标作为泊松括号的角标， 其值都不变． 下面是证明
\begin{equation}
\pb{a}{b}_{q,p} = \sum_i \qty( \pdv{a}{q_i}\pdv{b}{p_i} - \pdv{b}{q_i}\pdv{a}{p_i} ) 
\end{equation}
其中
\begin{equation}
\pdv{a}{q_i} \pdv{b}{p_i} = \sum_j \qty( \pdv{a}{q'_j} \pdv{q'_j}{q_i} + \pdv{a}{p'_j}\pdv{p'_j}{q_i} ) \sum_k \qty(\pdv{b}{q'_k}\pdv{q'_k}{p_i} + \pdv{b}{p'_k}\pdv{p'_k}{p_i}) 
\end{equation}
\begin{equation}
\pdv{b}{q_i} \pdv{a}{p_i} = \sum_k \qty( \pdv{b}{q'_k}\pdv{q'_k}{q_i} + \pdv{b}{p'_k}\pdv{p'_k}{q_i} ) \sum_j \qty(\pdv{a}{q'_j}\pdv{q'_j}{p_i} + \pdv{a}{p'_j}\pdv{p'_j}{p_i})
\end{equation}
 
现在我们要得到 $\pb{a}{b}_{q',p'} = \sum_i \qty(\pdv{a}{q'_i}\pdv{b}{p'_i} - \pdv{b}{q'_i} \pdv{a}{p'_i})$，  可以把上两式代入后对 $\pdv{a}{q'}\pdv{b}{p'}$ 和 $\pdv{b}{q'_i}\pdv{a}{p'_i}$ 合并同类项， 得
\begin{equation}\ali{
\pb{a}{b}_{q,p} & = \sum_{jk} \pdv{a}{q'_j} \pdv{b}{p'_k} \sum_i \qty( \pdv{q'_j}{q_i}\pdv{p'_k}{p_i} -\pdv{p'_k}{q_i}\pdv{q'_j}{p_i} )  \\
& -\sum_{jk} \pdv{b}{q'_k}\pdv{a}{p'_j} \sum_i \qty( \pdv{q'_k}{q_i}\pdv{p'_j}{p_i} - \pdv{p'_j}{q_i}\pdv{q'_k}{p_i} )   \\
&= \sum_{jk} \pdv{a}{q'_j} \pdv{b}{p'_k} \pb{q'_j}{p'_k}_{q,p}  - \sum_{jk} \pdv{b}{q'_k} \pdv{a}{p'_j} \pb{q'_k}{p'_j}_{q,p}
}\end{equation}
代入正则坐标条件， 得
\begin{equation}\ali{
\pb{a}{b}_{q,p} & = \sum_{jk} \pdv{a}{q'_j}\pdv{b}{p'_k}\delta_{jk}  - \sum_{jk}\pdv{b}{q'_k} \pdv{a}{p'_j} \delta_{jk} = \sum_j \qty( \pdv{a}{q'_j}\pdv{b}{p'_j} - \pdv{b}{q'_j}\pdv{a}{p'_j} )  \\
&= \pb{a}{b}_{q',p'}
}\end{equation}

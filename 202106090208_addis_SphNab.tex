% 球坐标系中的矢量算符
% 球坐标系|梯度|散度|旋度|拉普拉斯算符

\pentry{正交曲线坐标系中的矢量算符\upref{CVecOp}}

球坐标系中标量函数 $u(r, \theta, \phi)$ 和矢量函数 $\bvec v(r, \theta, \phi)$ 的梯度， 散度， 旋度和拉普拉斯算符的公式如下． 其中 $r$ 是极径，$\theta $ 是极角，$\phi $ 是方位角． 推导见下文．

\begin{itemize}
\item \textbf{梯度算符}
\begin{equation}\label{SphNab_eq1}
\grad u = \pdv{u}{r}\uvec r + \frac{1}{r} \pdv{u}{\theta}\uvec \theta  + \frac{1}{r\sin \theta }\pdv{u}{\phi}\uvec \phi
\end{equation}
\item \textbf{散度算符}
\begin{equation}\label{SphNab_eq2}
\div \bvec v = \frac{1}{r^2} \pdv{r} (r^2 v_r) + \frac{1}{r\sin \theta} \pdv{\theta} (\sin\theta v_\theta) + \frac{1}{r\sin \theta}\pdv{v_\phi}{\phi}
\end{equation}
\item \textbf{旋度算符}
\begin{equation}\ali{
\curl \bvec v = & \frac{1}{r\sin \theta} \qty[\pdv{\theta} (\sin \theta v_\phi) - \pdv{v_\theta}{\phi}]\uvec r  + \frac1r \qty[\frac{1}{\sin \theta}\pdv{v_r}{\phi} - \pdv{r} (r v_\phi)]\uvec \theta\\
&+ \frac1r \qty[\pdv{r} (r v_\theta) - \pdv{v_r}{\theta}]\uvec \phi
}\end{equation}
\item \textbf{拉普拉斯算符}
\begin{equation}\label{SphNab_eq4}
\laplacian u = \div (\grad u) = \frac{1}{r^2} \pdv{r} \qty(r^2 \pdv{u}{r}) + \frac{1}{r^2 \sin\theta}\pdv{\theta} \qty(\sin \theta \pdv{u}{\theta}) + \frac{1}{r^2 \sin^2 \theta} \pdv[2]{u}{\phi}
\end{equation}
\end{itemize}


\subsubsection{拉普拉斯算符的径向和角向分解}
为了书写方便本书中定义两个算符 $\laplacian_r$ 和 $\laplacian_\Omega$ 满足
\begin{equation}\label{SphNab_eq3}
\laplacian = \laplacian_r + \frac{\laplacian_\Omega}{r^2}
\end{equation}
其中 $\laplacian_r$ 只对 $r$ 求偏导（\autoref{SphNab_eq4} 右边第一项）， $\laplacian_\Omega$ 只对 $\theta,\phi$ 求偏导（\autoref{SphNab_eq4} 右边后两项）． $\laplacian_\Omega$ 还可以进一步分解为
\begin{equation}
\laplacian_\Omega = \grad_\Omega\vdot \grad_\Omega
\end{equation}
其中
\begin{equation}
\grad_\Omega = -\qty(\sin\phi\pdv{\theta} + \cot\theta\cos\phi\pdv{\phi})\uvec x
+ \qty(\cos\phi\pdv{\theta} - \cot\theta \sin\phi \pdv{\phi}) \uvec y
+ \pdv{\phi} \uvec z
\end{equation}
这在量子力学zh

\subsection{推导}
\begin{equation}\label{SphNab_eq11}
\pdv{\bvec r}{r} = \uvec r \qquad
\pdv{\bvec r}{\theta} = r\uvec \theta \qquad
\pdv{\bvec r}{\phi} = r\sin\theta\,\uvec\phi
\end{equation}
所以位置矢量的微分可以表示为
\begin{equation}\label{SphNab_eq12}
\dd{\bvec r} = \uvec r \dd{r} + r\uvec \theta\dd{\theta} + r\sin\theta\uvec \phi\dd{\phi}
\end{equation}
\addTODO{该式的推导应该在}
代入\autoref{CVecOp_eq4}~\upref{CVecOp}到\autoref{CVecOp_eq6}~\upref{CVecOp}即可完成推导．

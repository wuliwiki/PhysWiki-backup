% 多元数量函数的隐函数定理
% 多元函数|数量函数|隐函数定理

\verb|写在前面：|
本页出现的变元 $x$ 都是指 $\mathbb{R}^n$ 中的元素, 即 $x=(x_1,\cdots,x_n)\in\mathbb{R}^n.$
\pentry{连续函数的保号性、微分中值定理、梯度}


\begin{theorem}{(介值定理的一个应用)}
设 $D\times E\subset\mathbb{R}^{n}\times\mathbb{R}$ 是开集,
$F:D\times E\rightarrow\mathbb{R}$ 是数量函数. 点 $(x_{0},y_{0})\in D\times E.$ 

考虑方程 $F(x,y)=0$ 能否解出 $y=f(x)$ 满足 $F(x,f(x))=0.$ 

若满足以下 3 个条件：

① $F(x_{0},y_{0})=0$；

② $F\in\mathrm{C}(D\times E)$, 即 $F(x,y)$ 在 $D\times E$ 上连续；

③ 任意固定 $x\in D$, 函数 $y\mapsto F(x,y)$ 都是 $E$ 上的严格单调函数， 

则方程 $F(x,y)=0$ 在 $x=x_{0}$ 附近是\textbf{ 唯一、局部地连续可解} 的, 即存在 $x_{0}$
的某邻域 $B(x_{0},\delta)\subset D$ 及定义在 $B(x_{0},\delta)$ 上的 \textbf{唯一的}\textbf{
连续函数} $y=f(x)$ 使得
\[
f(x_{0})=y_{0},\quad F(x,f(x))=0,\quad\forall x\in B(x_{0},\delta).
\]

\verb|------------------------------------------------------------------------|

\textsl{证明}：不妨设条件 ③ 中是严格单增函数. 

由函数 $y\mapsto F(x,y)$ 严格单增和 ① 知存在 $y_{1}>y_{0}>y_{2}$ 使得 $F(x_{0},y_{1})>0>F(x_{0},y_{2})$. 

再由 $F(x_{0},y_{1})>0>F(x_{0},y_{2})$ 和连续函数的保号性知 $F(x,y)$ 在 $(x_{0},y_{1})$
的附近总是正的, 而在 $(x_{0},y_{2})$ 的附近总是负的. 

于是结合条件 ③ 即知, 只要每次固定住 $x$, 沿着 $y$ 轴正方向走, $F$ 就可以从负值走向正值. 因此, 可以利用连续函数的介值定理,
在 $(x_{0},y_{0})$ 的附近唯一地形成一条轨迹 $y=f(x)$ 使得 $F(x,f(x))=0$. 

下证 $f(x)$ 的连续性. 事实上, $f(x)$ 的连续性是由上述方法的构造过程决定的. 若不然, 取 $\overline{x}\in B(x_0,\delta)$ 并假设 $f(x)$ 在
$x=\overline{x}$ 不连续, 则存在 $\varepsilon_{0}>0$ 及 $x_{n}\rightarrow\overline{x}$
使得 $f(x_{n})\notin(f(\overline{x})-\varepsilon,f(\overline{x})+\varepsilon)$.
注意到
\[
F(\overline{x},f(\overline{x})+\varepsilon)>0>F(\overline{x},f(\overline{x})-\varepsilon),
\]
因此可以重复存在性的构造过程, 在 \textbf{$\overline{x}$ }的附近及区间 $(f(\overline{x})-\varepsilon,f(\overline{x})+\varepsilon)$
内部形成一条轨迹, 而根据唯一性, 该轨迹恰是 $y=f(x)$. 这就与 $f(x_{n})\notin(f(\overline{x})-\varepsilon,f(\overline{x})+\varepsilon)$
矛盾了. $\square$ 
\end{theorem}
\[
\]

下面介绍多元数量函数的隐函数定理，当 $n=2$ 时，即为二元数量函数的隐函数定理． 

另外，还有多元向量函数的隐函数定理，见下一章. 

 \begin{theorem}{(隐函数定理)}
 设 $D\times E\subset\mathbb{R}^{n}\times\mathbb{R}$ 是开集, $F:D\times E\rightarrow\mathbb{R}$
是数量函数. 点 $(x_{0},y_{0})\in D\times E.$ 

考虑方程 $F(x,y)=0$ 能否解出 $y=f(x)$ 满足 $F(x,f(x))=0.$ 

若满足以下 3 个条件：

① $F(x_{0},y_{0})=0$；

② $F\in\mathrm{C}(D\times E)$, 即 $F(x,y)$ 在 $D\times E$ 上连续； 

③ $F_{y}(x_{0},y_{0})\neq0$, 且 $F_{y}(x,y)$ 在点 $(x_0,y_0)$ 处连续，

则方程 $F(x,y)=0$ 在 $x=x_{0}$ 附近是\textbf{ 唯一、局部地连续可解} 的, 即存在 $x_{0}$
的某邻域 $B(x_{0},\delta)\subset D$ 及定义在 $B(x_{0},\delta)$ 上的 \textbf{唯一的} \textbf{
连续函数} $y=f(x)$ 使得
\[
f(x_{0})=y_{0},\quad F(x,f(x))=0,\quad\forall x\in B(x_{0},\delta).
\]

进一步, 若还有以下条件：

④ $\nabla_{x}F(x,y)$ 在 $D\times E$
都存在\footnote{条件 ④ 若只是对某个偏导数成立也有相应结论. }, 且 $F_y\in\mathrm{C}(D\times E)$ \footnote{\textsl{注}：此条件指 $F(x,y)$ 关于 $y$ 的偏导数 $F_{y}(x,y)$
 在 $D\times E$ 上连续. 注意, 这里加强了条件 ③ 的后半部分， 要求 $F_{y}(x,y)$ 必须对两个变元连续, 不可以只对 $y$
 变元连续, 更不可以只对 $(x_0,y_0)$ 连续， 因为推导公式 ( \autoref{impli_eq2} ) 时会用到.},

则相应的隐函数 $y=f(x)$ 在 $x=x_{0}$ 附近的梯度函数 $\nabla f$ 也都存在, 并且成立计算公式
\[
\nabla f(x)=-{\displaystyle \frac{\nabla_{x}F(x,f(x))}{F_{y}(x,f(x))}},\quad\forall x\in B(x_{0},\delta)．
\]

更进一步, 若还有：

⑤\footnote{条件 ⑤ 若只是对某个偏导数成立也有相应结论. } $\nabla_{x}F(x,y)$ 在 $D\times E$
上连续, 

则相应的隐函数 $y=f(x)$ 梯度函数 $\nabla f$ 在 $x=x_{0}$ 附近也连续.

\verb|------------------------------------------------------------------------|

\textsl{证明}：不妨设条件 ③ 中 $F_{y}(x_{0},y_{0})>0.$ 由 $F_{y}(x_{0},y_{0})>0$ 和
① 知存在 $y_{1}>y_{0}>y_{2}$ 使得 $F(x_{0},y_{1})>0>F(x_{0},y_{2})$. 

又由 $F_{y}(x_{0},y_{0})>0$ 和保号性知 $F_{y}(x,y)$ 在 $(x_{0},y_{0})$
的附近 $B((x_{0},y_{0}),\delta)$ 内是严格正的, 即 $F(x,y)$ 关于 $y$ 变元在 \textbf{该附近}\footnote{\textsl{注}：这一点很重要, 需保证 $F(x,y)$ 关于 $y$ 变元在该附近都是严格单增的才行, 倘若只要求 $F(x_{0},y)$
关于 $y$ 严格单增则是远远不够的. 如可定义一个连续函数 $F(x,y)$ 使得它只在区域 \{$x-y\geqslant0$,
$x+y\geqslant0$, $x\geqslant0$\} 及区域 \{$x-y\leqslant0$, $x+y\leqslant0$,
$x\leqslant0$\} 取零值而在 $y$ 轴上严格单增. } 是严格单增的 (沿 $y$ 轴正方向严格单增). 

再由 $F(x_{0},y_{1})>0>F(x_{0},y_{2})$ 和保号性知 $F(x,y)$ 在 $(x_{0},y_{1})$
的附近总是正的, 而在 $(x_{0},y_{2})$ 的附近总是负的. 

结合以上三点就可以利用上一个定理的结论, 得到相同的结论. 

进一步, 若还有条件 ④, 取 \textbf{$\overline{x}$ }为 $B(x_{0},\delta)$ 中任意一点并固定它,
而 $\overline{y}=f(\overline{x})$. 再取 $\left|\triangle x\right|\ll1$
有

\begin{equation}\label{impli_eq1}
\nabla f(x)={\displaystyle {\displaystyle \lim_{\triangle x\rightarrow0}}\frac{f(\overline{x}+\triangle x)-f(\overline{x})}{\triangle x}:={\displaystyle \lim_{\triangle x\rightarrow0}}\frac{A}{\triangle x}}.
\end{equation}

另一方面, 由于 $F(\overline{x},f(\overline{x}))=F(\overline{x}+\triangle x,f(\overline{x}+\triangle x))=0$
且
$$
\begin{eqnarray*}
0 & = & F(\overline{x}+\triangle x,f(\overline{x}+\triangle x))-F(\overline{x},f(\overline{x}))\\
 & = & \left[F(\overline{x}+\triangle x,f(\overline{x}+\triangle x))-F(\overline{x}+\triangle x,f(\overline{x}))\right]+\left[F(\overline{x}+\triangle x,f(\overline{x}))-F(\overline{x},f(\overline{x}))\right]\\
 & = & F_{y}(\overline{x}+\triangle x,\xi)\cdot A+\left[F(\overline{x}+\triangle x,f(\overline{x}))-F(\overline{x},f(\overline{x}))\right]
\end{eqnarray*}
$$
其中用了微分中值定理, 且 $\xi=\xi(\triangle x)$ 使得 $f(\overline{x})<\xi<f(\overline{x}+\triangle x)$.
上式说明了 
\[
A=-{\displaystyle \frac{F(\overline{x}+\triangle x,f(\overline{x}))-F(\overline{x},f(\overline{x}))}{F_{y}(\overline{x}+\triangle x,\xi)}}
\]
将它代入 ( \autoref{impli_eq1} ) 并取极限即得 
\begin{equation}\label{impli_eq2}
\nabla f(\overline{x})=-{\displaystyle \frac{\nabla_{x}F(\overline{x},f(\overline{x}))}{F_{y}(\overline{x},f(\overline{x}))},}
\end{equation}
而取极限的过程要用到 $F_{y}$ 在 $D\times E$ 上的连续性 (由条件 ② 保证). 

更进一步, 若还有条件 ⑤, 则 $\nabla f$ 在 $x=x_{0}$ 附近的连续性由计算公式 ( \autoref{impli_eq2} ) 的形式保证. 
 \end{theorem}

(by R.Stern)

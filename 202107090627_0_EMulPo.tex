% 电多极展开
% keys 偶极子|多极子|球谐函数|电势

\pentry{球谐函数\upref{SphHar}}

若空间中的一个球内（$r < a$） 存在静止的电荷分布 $\rho(\bvec r)$， 那么球外的电势 $V(\bvec r)$（$r > a$）可以展开为径向函数和球谐函数之积的形式
\begin{equation}\label{EMulPo_eq2}
V(\bvec r) = \sum_{l = 0}^\infty \frac{1}{r^{l+1}}\sum_{m = -l}^l C_{l,m} Y_{l,m}(\uvec r) \qqua
\end{equation}
其中常数 $C_{l,m}$ 为
\begin{equation}
C_{l,m} = \frac{1}{(2l+1)\epsilon_0} \int_{r<a} \rho(\bvec r) r^l Y_{l,m}^*(\uvec r) \dd[3]{r}
\end{equation}

当 $m = 0$ 时， $l = 0$ 的项就是\textbf{电单极子（electric monopole）} 具有球对称的电荷分布和势能分布， $l = 1$ 的项就是\textbf{电偶极子（dipole）}\upref{eleDP2}（$\propto\cos \theta$）， $l = 2$ 的项是\textbf{电四极子（quadrupole）}…… $l = N$ 的项叫做电 $2^N$ 极子．

为什么这么叫呢？ 因为电 $2^N$ 极子产生的势能项可以用 $2^{N-1}$ 个电荷为 $q$ 的正电荷以及 $2^{N-1}$ 个电荷为 $-q$ 的负电荷按照一定空间位置摆放后， 取 $r \to \infty$ 得到． 用数学归纳法的思想， 我们可以认为若电 $2^N$ 极子是一个点， 渐进势能为 $\sim 1/r^{l+1}$， 那么把两个电荷相反的 $2^N$ 极子放在一根短杆的两端组成电 $2^{N+1}$ 极子， 那么渐进势能就必须是更高阶无穷小， 即 $\sim 1/r^{l+2}$．

电多极展开的优势在于只需要预先算出系数 $C_{l,m}$ 就可以无需积分得到球外任意位置的电势分布． 而如果用常规的方法， 则计算每个位置的电势都需要重新做一次积分． 而它的缺点在于实际计算中必须取\autoref{EMulPo_eq2} 中的有限项， 会产生截断误差． 另一点是无法计算球内的电势分布．

\subsubsection{一般展开}
相反， 若 $\rho(\bvec r)$ 只存在于 $r > a$ 的球外空间， 那么可以把球内部的电势 $V(\bvec r)$ 展开为
\begin{equation}\label{EMulPo_eq4}
V(\bvec r) = \sum_{l = 0}^\infty r^l \sum_{m = -l}^l D_{l,m} Y_{l,m}(\uvec r)
\end{equation}
其中
\begin{equation}\label{EMulPo_eq3}
D_{l,m} = \frac{1}{(2l+1)\epsilon_0} \int_{r>a} \rho(\bvec r) \frac{1}{r^{l+1}} Y_{l,m}^*(\uvec r) \dd[3]{r}
\end{equation}

如果令 $a = r$ 并把\autoref{EMulPo_eq2} 和\autoref{EMulPo_eq4} 合并就可以得到一般情况的展开
\begin{equation}
V(\bvec r) = \sum_{l = 0}^\infty\sum_{m = -l}^l \qty[\frac{1}{r^{l+1}} C_{l,m}(r) + r^l D_{l,m}(r)] Y_{l,m}(\uvec r)
\end{equation}
但这计算起来比较麻烦， 因为现在 $C_{l,m}, D_{l,m}$ 成了 $r$ 的函数， 对每个较小的 $r$ 都需要计算一次积分．

\subsection{推导}
首先我们给出单个点电荷势能的展开公式
\begin{equation}\label{EMulPo_eq1}
\frac{1}{\abs{\bvec r - \bvec r'}} = 4\pi \sum_{l=0}^{\infty} \frac{1}{2l+1} \frac{r_<^l}{r_>^{l+1}} \sum_{m = -l}^l Y_{l,m}^*(\uvec r') Y_{l,m}(\uvec r)
\end{equation}
其中 $r_< := \min\qty{r, r'}$， $r_> := \max\qty{r, r'}$．

若我们要求电荷必须在 $r' < a$ 的球内而 $V(\bvec r)$ 必须在球外计算， 那么 $r_> = r, r_< = r'$， 根据库仑势能有
\begin{equation}
V(\bvec r) = \frac{1}{4\pi\epsilon_0}\int \frac{\rho(\bvec r')}{\abs{\bvec r - \bvec r'}} \dd[3]{r'}
\end{equation}
把\autoref{EMulPo_eq1} 代入可得\autoref{EMulPo_eq2}．

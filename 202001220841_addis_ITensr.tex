% 惯性张量
% 刚体|惯性张量|坐标系基底变换
% 所有连接未完成

\pentry{常见几何体的转动惯量\upref{ExMI}}

我们已经初步学习了刚体绕固定轴的转动， 现在我们做一个更一般的讨论， 也就是刚体绕某个固定点的转动． 刚体绕固定轴转动只有一个自由度 $\theta$， 而绕固定点转动却可以有 3 个自由度（见 “刚体\upref{RigBd}”）．

\subsection{瞬时转轴}
当刚体绕某个固定点做任意转动时， 我们在每个时刻仍然能找到一个经过该点的\textbf{瞬时转轴}以及延转轴的瞬时角速度（矢量） $\bvec \omega$．

某时刻瞬时转轴的定义是： 该时刻刚体在内任意落在转轴上的点速度为零． 事实上， 我们只需要在某时刻找到刚体上瞬时速度为 0 的任意两个不同点， 就可以过这两点作出瞬时转轴， 并确保该直线上的所有点瞬时速度都为 0．

\begin{example}{进动陀螺的瞬时转轴}\label{ITensr_ex2}
在陀螺的例子（\autoref{AMLaw_ex2}\upref{AMLaw}） 中， 我们可能会认为陀螺的瞬时转轴就是陀螺的轴． 但陀螺的轴时时刻刻都在运动， 除了与地面接触的点外， 任意一点的瞬时速度都不为 0．

如果陀螺的自转和进动的方向相同， 我们可以知道真正的瞬时转轴同样经经过与地面的接触点， 但会在陀螺轴的上方． 我们只需要找到陀螺圆盘表面上瞬时速度为 0 的一点即可求出瞬时转轴的倾角．
\end{example}

\subsection{惯性张量}
刚体的角动量等于\textbf{惯性张量} $\mat I$ 乘以瞬时角速度矢量 $\bvec \omega$
\begin{equation}\label{ITensr_eq3}
\bvec L = \mat I \bvec \omega
\end{equation}
惯性张量是一个 3 维方阵， 其阵元一般记为
\begin{equation}
\ten I = \begin{pmatrix}
I_{xx}& I_{xy}& I_{xz} \\
I_{yx}& I_{yy}& I_{yz} \\
I_{zx}& I_{zy}& I_{zz}
\end{pmatrix}
\end{equation}
我们现在假设刚体\textbf{绕坐标原点旋转}， 如果将 $x, y, z$ 分别记为 $x_1, x_2, x_3$， 则 $\mat I$ 的矩阵元为
\begin{equation}\label{ITensr_eq1}
I_{ij} = \delta_{i, j} \int r^2 \rho(\bvec r)\dd{V} - \int x_i x_j \rho(\bvec r)\dd{V} \qquad (i, j = 1, 2, 3)
\end{equation}
其中 $r = \abs{\bvec r}$． 也可以表示成矩阵积分的形式（每个矩阵元分别积分）
\begin{equation}\label{ITensr_eq2}
\mat I = \int \rho
\begin{pmatrix}
y^2 + z^2 & -xy & -xz\\
-yx & x^2 + z^2 & -yz\\
-zx & -zy & x^2 + y^2
\end{pmatrix}
\dd{V}
\end{equation}
可以看出， 惯性张量与坐标系的选取有关， 而这又可以划分为原点的位置和坐标轴的取向．

\begin{example}{长方体的惯性张量}\label{ITensr_ex1}
令重心在原点， 密度为常数， 质量为 $M$ 的长方体延 $x, y, z$ 方向的长度分别为 $a, b, c$， 那么有
\begin{equation}
\begin{aligned}
&\iiint xy \dd{x}\dd{y}\dd{z} = \iiint yz \dd{x}\dd{y}\dd{z} = \iiint zx \dd{x}\dd{y}\dd{z} = 0\\
&\iiint x^2 \dd{x}\dd{y}\dd{z} = \frac{1}{12} a^3 bc\\
&\iiint y^2 \dd{x}\dd{y}\dd{z} = \frac{1}{12} ab^3 c\\
&\iiint z^2 \dd{x}\dd{y}\dd{z} = \frac{1}{12} ab c^3
\end{aligned}
\end{equation}
所以
\begin{equation}\label{ITensr_eq4}
\begin{aligned}
\mat I &= \frac{1}{12} \rho abc
\pmat{
   b^2 + c^2 & 0 & 0\\
   0 & a^2 + c^2 & 0\\
   0 & 0 & a^2 + b^2
}\\
&= \frac{1}{12} M
\pmat{
   b^2 + c^2 & 0 & 0\\
   0 & a^2 + c^2 & 0\\
   0 & 0 & a^2 + b^2
}
\end{aligned}
\end{equation}
可以发现这个是一个对角矩阵． 这就意味着， 如果长方体分别绕 $x, y, z$ 轴转动， 它的角动量也分别延 $x, y, z$ 轴． 由\autoref{ExMI_eq1}\upref{ExMI} 可以验证三个方向的转动惯量是对的． 当转轴与坐标轴不重合时， 可见转动惯量的方向与转动方向一般不同．

特殊地， 当 $a = b = c$ （正方体）时， 惯性张量变为单位矩阵乘以常数
\begin{equation}
\mat I = \frac{1}{6} Ma^2
\pmat{
   1 & 0 & 0\\
   0 & 1 & 0\\
   0 & 0 & 1
}
\end{equation}
由于单位矩阵乘以任何矢量都得到相同的矢量， 正方体延任意转轴转动时都有
\begin{equation}
\bvec L = \mat I \bvec \omega = \frac{1}{6} Ma^2 \bvec \omega
\end{equation}
\end{example}

\begin{example}{细杆的角动量}
假设细杆沿 $x$ 轴放置， 长度为 $L$． 要计算它的惯性张量， 我们可以从头积分（\autoref{ITensr_exe1}）， 也可以假设细杆是一个细长的长方体， 直接用\autoref{ITensr_ex2} 的结论（令 $a = L, b \to 0, c \to 0$） 得
\begin{equation}\label{ITensr_eq5}
\mat I = \frac{1}{12} M \pmat{0 & 0 & 0\\ 0 & L^2 & 0\\ 0 & 0 & L^2}
\end{equation}
可以看到， 如果转轴延 $x$ 方向（$\bvec\omega = (\omega, 0, 0)\Tr$）， 角动量为零， 如果延 $y, z$ 方向， 则角动量大小都等于
\begin{equation}
L = \frac{1}{12} M L^2 \omega
\end{equation}
对应的转动惯量为 $I = ML^2/12$， 这与\autoref{ExMI_eq2}\upref{ExMI} 一致．

我们再来看更有意思的情况， 如果转轴和轻杆法线的夹角为 $\theta$， （未完成）
\end{example}

\begin{exercise}{}\label{ITensr_exe1}
直接使用积分计算细杆的角动量（\autoref{ITensr_eq5}）．
\end{exercise}


\subsection{推导}
根据角动量的定义\autoref{AngMom_eq1}\upref{AngMom}
\begin{equation}
\bvec L = \sum_i m_i \bvec r_i \bvec v_i = \sum_i m_i \bvec r_i \cross (\bvec \omega \cross \bvec r_i) = \sum_i m_i r_i^2 \bvec \omega - \sum_i m_i (\bvec \omega \vdot \bvec r_i) \bvec r_i
\end{equation}
写成分量的形式， 并将求和表示为密度 $\rho$ 的积分得
\begin{equation}
\begin{aligned}
\pmat{L_x\\ L_y\\ L_z} &= \int \rho r^2 \pmat{\omega_x\\ \omega_y\\ \omega_z} \dd{V} - \int \rho
\begin{pmatrix}
xx & xy & xz\\
yx & yy & yz\\
zx & zy & zz
\end{pmatrix}
\pmat{\omega_x\\ \omega_y\\ \omega_z} \dd{V}\\
&= \qty[\int \rho
\begin{pmatrix}
r^2 -xx & -xy & -xz\\
-yx & r^2 -yy & -yz\\
-zx & -zy & r^2 -zz
\end{pmatrix}
\dd{V}]
\pmat{\omega_x\\ \omega_y\\ \omega_z}
\end{aligned}
\end{equation}
对比\autoref{ITensr_eq3} 可知， 方括号中的积分就是惯性张量 $\mat I$（\autoref{ITensr_eq2}）．

\subsection{坐标旋转变换}
上文中提到惯性张量矩阵与坐标系的选取有关， 我们先来讨论如果惯性张量在两个原点相同朝向不同的坐标系之间如何变换， 这叫做惯性张量的\textbf{旋转变换}． 先建立一个与刚体相对静止的参考系叫做\textbf{体坐标系（body frame）}， 一般我们选择体坐标系的原点在刚体质心处， 但刚体做任意转动时， 体坐标系并不是一个惯性系， 所以我们还要选一个\textbf{实验室坐标系（lab frame）}． 令体坐标系的矢量到实验室系的矢量的变换矩阵\upref{Rot3D}为 $\mat R$， 记体坐标系和实验室系中的惯性张量分别为 $\mat I_0$ 和 $\mat I$， 则实验室系中的惯性张量等于
\begin{equation}
\mat I = \mat R \mat I_0 \mat R\Tr
\end{equation}
% 未完成： 要如何证明？

\subsection{坐标平移变换}




% 例子未完成， 球体的惯性张量是对角的

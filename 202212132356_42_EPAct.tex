% 端点可变的作用量
% keys 作用量的偏导数|作用量的全微分
\pentry{作用量原理\upref{HamPrn}}
本词条将证明几个个关于作用量
\begin{equation}
S=\int_{t_1}^{t_2}L\dd t
\end{equation}

的重要公式，其中两个是重要的，即作用量对时间的偏导数等于负的能量（哈密顿量），对坐标的偏导数等于动量对应分量，或说作用量的梯度等于动量．其数学形式为
\begin{equation}\label{EPAct_eq1}
\begin{aligned}
\pdv{S}{t}&=-H\\
\pdv{S}{q^i}&=p_i
\end{aligned}
\end{equation}
其中 $t$ 是作用量积分里的积分上限(末时刻) $t_2$，$q^i$ 是对应末时刻 $t$ 的广义坐标．

并且
\begin{equation}\label{EPAct_eq2}
\dd S=\sum_i p_i^{(2)}\dd {q^i}^{(2)}-H^{(2)}\dd t^{(2)}-\sum_i p_i^{(1)}\dd {q^i}^{(1)}+H^{(1)}\dd t^{(1)}
\end{equation}
这里，上标 $(1),(2)$ 分别代表起点和终点对应值．

既然\autoref{EPAct_eq1} 是关于终点的偏微分，\autoref{EPAct_eq2} 是关于两端点的微分，这就是说这里的作用量实际上是端点可变的作用量．

可能读者已经疑惑了，作用量的自变量不应是个函数么？证明这里的自变量是起止时刻和初末位置了．事实上，我们要找的作用量对应物理系统的演化，那么系统演化的曲线是使作用量取极值的曲线，而在端点和起止时刻确定时系统演化我们认为只有一个，那么作用量就可看成这一极值曲线的两端点和对应起止时刻的函数．
\subsection{证明：}
这里的公式事实上和变分学的端点可变问题\upref{EPQue} 中的一样，那里有更严格的证明，只需明确物理意义即可．然而，我们这里给出较之更适合物理人的证明，以避免深入了解变分学．

\autoref{EPAct_eq1} 两式对应的问题可以这样描述：1.初末位置及初始时刻固定，而末时刻可变作用量如何变化．
2.将 $S$ 看着系统真实演化的量，当初始位置 $q(t_1)=q^{(1)}$ 固定但 $t_2$ 时刻对应位置可变时，$S$ 如何变．

我们先回答情形2．注意到
\begin{equation}
\delta S=\left.\pdv{L}{\dot q^i}\delta q^i\right|_{t_1}^{t_2}+\int_{t_1}^{t_2}\qty(\pdv{L}{q}-\dv{}{t}\pdv{L}{\dot q})\delta q\dd t
\end{equation}
因为系统真实演化，那么\autoref{HamPrn_eq4}~\upref{HamPrn}成立，上式积分项为0．而初位置固定，即 $\delta q^{(1)}=0$，于是
\begin{equation}
\delta S=\sum_i\pdv{L}{\dot {q^i}^{(2)}}\delta {q^i}^{(2)}\Rightarrow \pdv{S}{{q^i}^{(2)}}=\pdv{L}{\dot {q^i}^{(2)}}
\end{equation}
注意动量定义
\begin{equation}
p_i:=\pdv{L}{\dot q^i}
\end{equation}
于是
\begin{equation}
\pdv{S}{{q^i}^{(2)}}=p_i^{(2)}
\end{equation}
略去上指标 $(2)$，默认此时对应的即使末位置就得\autoref{EPAct_eq1} 中第二式．

同样，若末时刻 $q^{(2)}$ 不变，仅初始刻 $q^{(1)}$ 变，就是
\begin{equation}
\pdv{S}{{q^i}^{(1)}}=-p_i^{(1)}
\end{equation}


对于情形1．根据作用量 $S$ 的定义，有
\begin{equation}\label{EPAct_eq3}
\dd{S}=L^{(2)}\dd t^{(2)}-L^{(1)}\dd t^{(1)}
\end{equation}
另一方面， $S$ 可看成初末位置和时间的函数，于是
\begin{equation}\label{EPAct_eq4}
\begin{aligned}
\dd{S}&=\pdv{S}{t^{(1)}}\dd t^{(1)}+\sum_i\pdv{S}{{q^i}^{(1)}}\dot {q^i}^{(1)}\dd t^{(1)}+\pdv{S}{t^{(2)}}\dd t^{(2)}+\sum_i\pdv{S}{{q^i}^{(2)}}\dot {q^i}^{(2)}\dd t^{(2)}\\
&=\qty(\pdv{S}{t^{(1)}}-\sum_i p_i^{(1)}\dot {q^i}^{(1)})\dd t^{(1)}+\qty(\pdv{S}{t^{(2)}}+\sum_i p_i^{(2)}\dot {q^i}^{(2)})\dd t^{(2)}
\end{aligned}
\end{equation}
比较\autoref{EPAct_eq3} ，\autoref{EPAct_eq4} ，有
\begin{equation}\label{EPAct_eq5}
\begin{aligned}
\pdv{S}{t^{(1)}}&=\sum_i p_i^{(1)}\dot {q^i}^{(1)}-\qty(L^{(1)}\\
\pdv{S}{t^{(2)}}&=-\qty(\sum_i p_i^{(2)}\dot {q^i}^{(2)}-L^{(2)})
\end{aligned}
\end{equation}
由哈密顿量 $H$ 定义：
\begin{equation}
H:=\sum_i p_i\dot {q^i}-L
\end{equation}
\autoref{EPAct_eq5} 就成为
\begin{equation}
\begin{aligned}
\pdv{S}{t^{(1)}}&=H^{(1)}\\
\pdv{S}{t^{(2)}}&=-H^{(2)}
\end{aligned}
\end{equation}


% 张量积空间
% 线性代数|多元微积分|矢量空间|傅里叶级数|二维傅里叶级数|基底|n维空间|张量积|张量积空间|结合律|子空间|分量|内积|部分内积|矩阵元|部分矩阵元|本征问题|基底展开

\pentry{多元函数的傅里叶级数\upref{NdFuri}}

\subsection{定义}

我们以二维傅里叶级数来引入张量积的概念． 我们已知一维函数的傅里叶级数展开可以看做是一个矢量在一组正交归一基底上的展开， 自然地， 我们也希望能从矢量的空间的角度理解二维傅里叶级数展开． 为了讨论方便， 我们只讨论可以用有限项傅里叶级数展开的函数．

如果 $x$ 和 $y$ 方向分别取 $N_x$ 和 $N_y$ 个函数基底， 那么二维傅里叶级数中就有 $N_xN_y$ 个基底， 即被展开的函数是一个 $N_xN_y$ 维空间中的矢量．

观察二维傅里叶级数中的函数基底可以发现， 每一个基底都是一个 $N_x$ 维空间中的 $x$ 基底和一个 $N_y$ 维空间中的 $y$ 基底的乘积（两个一元函数相乘变为二元函数）． 从矢量的角度来看， 这是一种以前没有见过的矢量乘法， 它既不是数乘%链接未完成
（得到同维度的矢量）也不是内积%链接未完成
（得到标量）， 而是将两个不同矢量空间中的矢量相乘得到一个更高维空间中的矢量， 使新矢量的维度等于前两个矢量各自的维度相乘． 我们把这样的矢量乘法叫做\textbf{张量积}， 记为
\begin{equation}
\ket{v} = \ket{x} \otimes \ket{y}
\end{equation}
我们把张量积得到的矢量所在的空间叫做\textbf{张量积空间}． 为了书写方便我们时常省略张量积号记为 $\ket{x}\ket{y}$， 或者将张量积的结果记为一个整体 $\ket{v} = \ket{x, y}$． 为了让读者熟悉， 下文会随机使用这两种符号．

我们将两个一维傅里叶变换空间中的基底分别为 $\{\ket{x_i}\}$ 和 $\{\ket{y_j}\}$， 那么我们定义张量积空间为基底 $\{\ket{x_i}\ket{y_j}\}$ 张成的空间， 里面的任意矢量都可以用基底展开．
\begin{equation}
\ket{v} = \sum_{i,j} C_{ij}\ket{x_i, y_j}
\end{equation}

定义张量积满足\textbf{结合律}， 即两个低维空间中任意各选一个矢量 $\ket{x}$ 和 $\ket{y}$， 它们都可以在各自空间的基底中展开， 则它们的张量积为
\begin{equation}\label{DirPro_eq2}
\ket{x}\ket{y} = \sum_i a_i\ket{x_i} \sum_j b_j\ket{y_j}
= \sum_{i,j} a_i b_j \ket{x_i, y_j}
\end{equation}

注意张量积空间的的任意一个矢量不一定可以分解为两个矢量的张量积． 例如 $\ket{x_1}\ket{y_1} + 2\ket{x_2}\ket{y_3}$ 就不能由张量积得到． 也可类比函数的情况， $f_x(x)f_y(y)$ 可以记为 $f(x, y)$， 但 $f(x, y)$ 不一定能分解为 $f_x(x)f_y(y)$．

任何矢量空间的基底都需要有固定的顺序， 排序可以是任意的， 但是一旦确定在所有的计算中都不能改变． %未完成：这句话应该放到更早的词条．
张量积基底通常按照以下两种方式排序\footnote{由于这里每个基底都有两个角标， 使初学者有把基底排成长方形的冲动， 这是错误的．}
\begin{equation}\label{DirPro_eq4}
\qty{\ket{x_1, y_1}, \ket{x_1, y_2}\dots  \ket{x_2, y_1}, \ket{x_2, y_2}\dots }
\end{equation}
\begin{equation}\label{DirPro_eq5}
\qty{\ket{x_1, y_1}, \ket{x_2, y_1}\dots  \ket{x_1, y_2}, \ket{x_2, y_2}\dots }
\end{equation}
排序以后， 我们就可以用单下标来区分不同的基底， 令
\begin{equation}
\ket{x, y}_\alpha = \ket{x_i, y_j}
\end{equation}
对应两种排序， 分别有
\begin{equation}
\alpha = N_y (i-1) + j
\quad \text{或} \quad
\alpha = i + N_x (j-1)
\qquad 
(1 \leqslant \alpha \leqslant N_xN_y)
\end{equation}

\subsection{矢量的内积}

若我们需要在张量积空间中讨论模长和正交这样的概念就必须先定义\textbf{内积}： 张量积空间中两矢量（先假设它们可以分解为张量积， 比如两个基底矢量）的内积等于把每个低维空间中对应矢量分别做内积再相乘． 即 $\ket{c}\ket{d}$ 和 $\ket{a}\ket{b}$ 的内积为
\begin{equation}
\qty(\bra{d}\bra{c})\qty(\ket{a}\ket{b})
= \bra{d}\braket{c}{a}\ket{b}
= \braket{c}{a}\braket{d}{b}
\end{equation}
注意 $\ket{c}\ket{d}$ 的厄米共轭%未完成
记为 $\bra{d}\bra{c}$ 而不是 $\bra{c}\bra{d}$． 这样就可以很容易看出需要把 $\braket{c}{a}$ 组合做内积而不是 $\braket{d}{a}$． 但如果把两矢量记为 $\ket{a, b}$ 和 $\ket{c, d}$， 那么内积记为\footnote{书写习惯上，ket 和对应的 bra 中的记号应保持相同．所以 $\ket{c, d}$ 的厄米共轭记为 $\bra{c, d}$ 而不是 $\bra{d, c}$．}
\begin{equation}
\braket{c, d}{a, b} = \braket{c}{a}\braket{d}{b}
\end{equation}

张量积空间中的内积是否满足交换律取决于两个低维空间中的内积是否满足交换律． 一般情况下， $\braket{u}{v} = \braket{v}{u}^*$， 所以张量积空间中的也有
\begin{equation}
\braket{a, b}{c, d} = \braket{a}{c}\braket{b}{d}
= \braket{c}{a}^*\braket{d}{b}^* = \braket{c, d}{a, b}^*
\end{equation}

如果两个低维空间中的基底都是正交归一的， 那么张量积空间中的基底也是正交归一的
\begin{equation}
\braket{x_{i'}, y_{j'}}{x_i, y_j} = \braket{x_{i'}}{x_i}\braket{y_{j'}}{y_j}
= \delta_{i,i'}\delta_{j,j'}
\end{equation}
以后我们一般讨论正交归一基底．

知道了张量积空间基底之间的内积后， 要计算张量积空间中任意两个矢量的内积， 只需先将它们分解到基底上， 再按照内积的分配律和正交归一化条件即可得到熟悉的内积公式
\begin{equation}\ali{
\braket{x}{y} &= \qty(\sum_{i',j'} C'^*_{i',j'}\bra{y_{j'}}\bra{x_{i'}}) \qty( \sum_{i,j} C_{i,j} \ket{x_{i'}}\ket{y_{j'}}) \\
&= \sum_{i',j'} \sum_{i,j} C'^*_{i',j'} C_{i,j} \delta_{i,i'}\delta_{j,j'}
= \sum_{i,j} C'^*_{i,j} C_{i,j}
}\end{equation}

正交归一基底的\textbf{完备性}%未完成引用矢量空间的对应公式
仍然可以记为
\begin{equation}\label{DirPro_eq13}
\sum_{i,j} \ket{x_i, y_j} \bra{x_i, y_j} = \mat I
\end{equation}
其中 $\mat I$ 是张量积空间的单位算符．

我们现在从张量积空间的角度来看二维傅里叶级数， 将被展开的函数记为矢量 $\ket{f}$， 则
\begin{equation}\label{DirPro_eq14}
\ket{f} = \sum_\alpha C_{i,j}\ket{x, y}_\alpha = \sum_{i,j} C_{i,j}\ket{x_i, y_j}
\end{equation}
其中
\begin{equation}\label{DirPro_eq15}
C_{i,j} = \int_{-\infty}^{+\infty} \int_{-\infty}^{+\infty} f_{x,i}(x) f_{y,j}(y) f(x, y) \dd{x}\dd{y}
= \braket{x_i, y_j}{f}
\end{equation}
我们可以验证基底的完备性（\autoref{DirPro_eq13}）， 将\autoref{DirPro_eq15} 代入\autoref{DirPro_eq14} 得
\begin{equation}
\ket{f} = \sum_{i,j} \ket{x_i, y_j}\braket{x_i, y_i}{f}
= \qty(\sum_{i,j} \ket{x_i, y_j}\bra{x_i, y_i})\ket{f}
\end{equation}
由于 $\ket{f}$ 是任意的， 这就间接证明了
\begin{equation}
\sum_\alpha \ket{x_i, y_j}\bra{x_i, y_i} = \mat I
\end{equation}

若张量积空间中一个矢量可以表示为两个低维空间矢量的张量积  $\ket{u}\ket{v}$， 则其基底展开为
\begin{equation}
\ket{u}\ket{v} = \qty(\sum_i a_i\ket{u_i}) \otimes \qty(\sum_j b_j \ket{u_j})
= \sum_{i,j} a_i b_j \ket{u_i, u_j}
\end{equation}

\subsubsection{张量积空间的子空间}
令 $\ket{u_i}$ 和 $\ket{v_j}$ 分别为两个低维空间的基底， 则张量积空间中存在两种“天然”的子空间． % 未完成：线性代数介绍子空间
一种将张量积基底根据 $i$ 的值分成许多组， 每组张成一个子空间． 同理， 也可以根据 $j$ 来划分子空间． 我们姑且分别称它们为 $u$ 子空间和 $v$ 子空间．

任意一个张量空间中的矢量可以看做是每个子空间中的一个矢量的线性组合
\begin{equation}
\ali{
\sum_{i,j} C_{ij}\ket{u_i}\ket{v_j} &= \sum_j \qty(\sum_i C_{ij}\ket{u_i}) \otimes \ket{v_j} = \sum_j \ket{a_j}\ket{v_j}\\
&= \sum_i \ket{u_i} \otimes \qty(\sum_j C_{ij}\ket{v_j})   = \sum_i \ket{u_i}\ket{b_i}
}\end{equation}
上式中的 $\ket{a_j}$ 可以理解为矢量在每个 $\ket{v_j}$ 子空间的\textbf{分量}（$u$ 空间的矢量）， $\ket{b_i}$ 理解为矢量在每个 $\ket{u_i}$ 子空间中的\textbf{分量}（$v$ 空间的矢量）．

\subsection{部分内积}
\footnote{这个运算并不是标准运算而是本书的一个定义}如果我们定义两矢量的张量积与 $u$ 空间中的矢量的\textbf{部分内积}运算为
\begin{equation}
\bra{u_1}(\ket{u}\ket{v}) = \braket{u_1}{u}\ket{v}
\end{equation}
且该运算是线性的， 那么 $u$ 空间中的任意矢量乘以任意张量的运算为
\begin{equation}
\ali{
\qty(\sum_k x_k \bra{u_k})\qty(\sum_{i,j} C_{ij}\ket{u_i}\ket{v_j})
&= \sum_{i,j} C_{ij} \qty(\sum_k  x_k \braket{u_k}{u_i})\ket{v_j}\\
&=\sum_j \qty(\sum_i x_i C_{ij}) \ket{v_j}
}\end{equation}
即对每个 $\ket{v_j}$ 子空间中的分量分别做内积， 得到 $v$ 空间的矢量．

同理， 也可以定义 $v$ 空间的部分内积
\begin{equation}
\bra{v_1}(\ket{u}\ket{v}) = \ket{u}\braket{v_1}{v}
\end{equation}
那么 $v$ 空间中的任意左矢 $\bra{v_1}$ 乘以任意张量等于将每个 $\ket{u_j}$ 子空间中的分量分别与 $\bra{v_1}$ 内积， 得到 $u$ 空间的矢量．

\subsubsection{算符}
两个低维空间的线性算符 $\Q A$ 和 $ \Q B$ 做张量积可以得到张量积空间中的算符 $\Q A \otimes \Q B$． 我们定义 $\Q A \otimes \Q B$ 为线性算符， 该算符对任意基底的作用结果为
\begin{equation}
\Q A \otimes \Q B \ket{u_i, v_j} = (\Q A \ket{u_i}) \otimes (\Q B \ket{v_j})
\end{equation}
要对任意矢量作用， 只需将矢量记为张量积基底的线性组合， 然后再分别对张量积基底作用即可．

特殊地， 可以用 $\Q A \otimes \Q I$ 运算将 $\{\ket{u_i}\}$  空间中的 $\Q A$ 拓展到张量积空间中来
\begin{equation}
\Q A \otimes \Q I \ket{u_i, v_j} = (\Q A \ket{u_i}) \otimes \ket{v_j}
\end{equation}
这说明算符 $\Q A \otimes \Q I$ 在每个 $v$ 子空间中都是闭合的． 所以， 算符 $\Q A \otimes \Q I$ 作用在张量积空间的任意矢量上， 相当于 $\Q A \otimes \Q I$ 对该矢量在各个子空间中的分量分别作用． $\Q B$ 也同理，不再赘述． 根据定义， 不难证明
\begin{equation}
(\Q A \otimes \Q I)(\Q I \otimes \Q B) = (\Q I \otimes \Q B)(\Q A \otimes \Q I) = \Q A \otimes \Q B
\end{equation}

\subsubsection{矩阵元的计算}
若张量积空间中的基底正交归一， 则张量积算符矩阵元为
\begin{equation}\ali{
(\Q A \otimes \Q B)_{\alpha_1, \alpha2} &= \bra{u_{i'} v_{j'}} \Q A \otimes \Q B \ket{u_i v_j} = \bra{u_{i'} v_{j'}} (\Q A \ket{u_i} \otimes \Q B \ket{v_j}) \\
&= \bra{u_{i'}} \Q A \ket{u_i} \bra{v_{j'}} \Q B \ket{v_j}
}\end{equation}

注意矩阵元的计算与基底的排序有关， 如果按照\autoref{DirPro_eq4} 排序， 则每个 $u$ 子空间的基底都在一起． 现在用分块矩阵的概念， 若把矢量根据 $u$ 子空间分成一段段， 每一段是 $u$ 子空间中分量的系数， 矩阵也会分成一些正方形的小块， 第 $(m, n)$ 小块中为
\begin{equation}
A_{mn} \mat B
\end{equation}
所以， $\Q A \otimes \Q B$ 的矩阵是把 $\mat A$ 的每个矩阵元 $A_{mn}$ 拓展成矩阵分块 $A_{mn} \mat B$．

同理， 若基底以\autoref{DirPro_eq5} 排序， 即每个 $v$ 子空间的基底都在一起， 则  $(\Q A \otimes \Q B)$ 的矩阵就是把 $\mat B$ 的每个矩阵元 $B_{mn}$ 拓展成矩阵分块 $B_{mn} \mat A$． 

将直积空间基底排序的做法丧失了两个空间基底的对称性． 我们可以将张量积空间中的列矢量坐标 $C_{i,j}$ 写成矩阵的形式（注意概念上这仍然是一个矢量而不表示线性映射）．矩阵的第 $i$ 行就是 $\ket{u_i}$ 子空间分量的坐标， 第 $j$ 列就是 $\ket{v_j}$ 子空间分量的坐标．

$\Q A \otimes \Q B$ 作用在该矩阵上， 就相当于用矩阵 $\mat A$ 处理每一列（矩阵 $\mat C$ 的行变换）， 再用矩阵 $\mat B$ 处理每一行（矩阵 $\mat C$ 的列变换）， 也可以是先列变换再行变换．
\begin{equation}
\sum_{j'} B_{jj'} \qty(\sum_{i'} A_{ii'} C_{i'j'})
= \sum_{i'} A_{ii'} \qty(\sum_{j'}B_{jj'} C_{i'j'})
\end{equation}
如果 $\mat A$ 或 $\mat B$ 是对角的， 那么分别只需要把矩阵的每一行或每一列的系数乘以对角元， 再分别使用矩阵 $\mat B$ 或 $\mat A$ 作用即可． 这就相当于对每个子空间中的分量独立作用．

\subsection{部分矩阵元}
每个部分矩阵元 $\mel{b_i}{\Q A \otimes \Q B}{b_j} = \mel{b_i}{\Q B}{b_j} \Q A$ 是 $a$ 空间的算符． 所以 $\Q A \otimes \Q B$ 作用在任意张量上， 就相当于先把 $\Q A$ 作用在每个 $\ket{b_j}$ 子空间的分量上， 再将这些子空间根据矩阵 $\mel{b_i}{\Q B}{b_j}$ 进行线性变换． 特殊地， 如果 $\mel{b_i}{\Q B}{b_j}$ 是对角矩阵， 那么只需要把 $\Q A$ 作用在每个 $\ket{b_j}$ 子空间的分量上再乘以对角矩阵元 $\mel{b_j}{\Q B}{b_j}$ 即可．

$\mel{a_i}{\Q A \otimes \Q B}{a_j} = \mel{a_i}{\Q A}{a_j} \Q B$ 的讨论同理．

\subsection{其他笔记}

\subsubsection{关于本征问题的定理}%（证明未完成）
	
＊如果考虑张量积空间中的本征问题， $\Q A$  的本征矢 $\ket{eig_i}$ 具有 $n$ 重简并， 简并空间的基底分别为 $\ket{eig_i}\ket{v_1}, \ket{eig_i}\ket{v_2}\dots$． 

＊ $\Q A \otimes \Q B$ 的本征值共有 $m \times n$ 个， $m$ 和 $n$ 分别是 $A$ 和 $B$ 的维度， 若 $a_1, a_2,\dots, a_m$ 和 $b_1, b_2, \dots, b_n$ 分别是 $A$ 和 $B$ 的本征值， 那么 $A \otimes B$ 的本征值和本征矢分别为 $a_i b_j$ 和 $\ket{u_i, v_j}$ （$0 \leqslant i \leqslant m,  0 \leqslant j \leqslant n$）．

＊ $A \otimes I + I \otimes B$ 的本征值和本征矢分别为 $a_i + b_j$ 和 $\ket{u_i, v_j}$． 

＊ 两个厄米矩阵张量积仍然是厄米矩阵．

＊l两个厄米矩阵相加仍然是厄米矩阵．

\subsubsection{算符的展开}
另外， 量子力学中的算符（我见过的）都可以表示为两个小空间中的算符的张量积的线性组合
\begin{equation}
\Omega = \sum_k A_k \otimes B_k
\end{equation}
例如中心力场中的单电子哈密顿算符
\begin{equation}
H = K_r + \frac{L^2}{2mr^2} + V(r) - q\bvec{\mathcal{E}} \vdot \bvec r
\end{equation}
其中 $K_r, V(r)$ 就是 $R$ 空间的算符与 $Y$ 空间的单位算符的张量积， $L^2$ 算符（\autoref{RadSE_eq3}） 是 $R$ 空间中的单位算符与 $Y$ 空间中算符的张量积． 而最后一项没有微分算符， 只是一个函数， 这个行数同样也可以展开为张量积空间中的基底的线性组合， 即两空间中的算符的张量积的线性组合．

一种简单的证明方法是，例如 2 乘 2 的矩阵 $\mat A$ 与 2 乘 2 的矩阵 $\mat B$ 直积， 就是把 $\mat A$ 的每个矩阵元乘以 $\mat B$ 变为一个 4 乘 4 的矩阵． 要得分解任意 4 乘 4 的矩阵， 我们只需要取 $\mat A_i$ 分别为一组矩阵基底 $[1, 0; 0, 0]$， $[0, 1; 0, 0]$， $[0, 0; 1, 0]$， $[0, 0; 0, 1]$， 然后再令 $\mat B_i$ 为每个子矩阵即可．

\subsubsection{单空间的基底展开}
张量积空间中的任意矢量可以只在一个小空间的基底上展开， 例如波函数可以看做径向波函数空间和角向波函数空间的张量积． 波函数可以只在角向波函数空间中的基底——球谐函数上展开
\begin{equation}
\ket{\Psi} = \sum_j \ket{R_j}\ket{Y_j}
\end{equation}
其中 $j$ 代表 $l, m$ 组合的某种排序．

如果我们在一个小空间中使用基底， 而另一个空间中不用． 例如 $Y$ 空间中我们用球谐函数作为基底， 可以得到一个“算符矩阵”， 即每个矩阵元为 R 空间的算符． 例如薛定谔方程
\begin{equation}
H \ket{\Psi} = \I \pdv{t}  \ket{\Psi}
\end{equation}
使用了 $Y$ 空间的基底后可以表示为
\begin{equation}
H \sum_j \ket{R_j}\ket{Y_j} =  \I  \sum_j\pdv{t}  \ket{R_j}\ket{Y_j}
\end{equation}
左乘 $\bra{Y_i}$ 变为
\begin{equation}
\sum_j \mel{Y_i}{H}{Y_j} \ket{R_j} =  \I  \pdv{t}  \ket{R_i}
\quad\Rightarrow\quad
\sum_j H_{ij} \ket{R_j} =  \I  \pdv{t}  \ket{R_i}
\end{equation}
其中每个 $H_{ij}$ 都是 $R$ 空间的算符．

从这里我们总结出， 张量积空间中的矢量可以展开为一个小空间中的 $N$ 个矢量分别与另一个小空间中的 $N$ 个基底的张量积． 所谓的“坐标” 就是第一个小空间中的 $N$ 个矢量排成的“列矢量”． 张量积空间中的矢量左乘一个小空间中的矢量可以得到另一个小空间中的矢量． 张量积空间的算符分别左乘右乘一个小空间中的正交归一基底可以得到另一个小空间中的算符．

另一个例子是多通道散射问题（见小时物理笔记）． 就是将总波函数看做是某个变量 $R$ （例如某个电子和质心的距离） 的空间与剩下所有自由度的空间的张量积． 每个 channel 就对应剩下所有自由与的空间中的一个基底， 系数就是 $R$ 空间中的一个径向波函数 $\psi_i$． 如果有 $N$ 个通道， 就可以得到 $N$ 个 $\psi_i$ 的 coupled equation， 其实就是矩阵形式的薛定谔方程．

另外， 参考一下 wikipedia 的 tensor product 页面吧．

% 解线性方程组

求解线性方程组（System of Linear equations）是科学计算中最普遍也是最为常见的问题，几乎所有与科学计算有关的问题都直接或间接与它有关．不论是常微分方程，偏微分方程，非线性方程，最优化，甚至是图像和信号处理，机器学习等等问题，最终都会转化成求解线性方程组．因此，线性方程组的解法也是科学计算领域里研究最广泛的问题之一．

线性方程的数值解法按照求解过程可以分为：<b>直接法</b>（Direct method）和<b>迭代法</b>（Iterative method）．其中，直接法顾名思义就是直接求得方程组的解，这个解在很多情况下就是方程组的解析解．一般常用直接法为高斯消元法（Gauss Elimination）或者是LU分解（LU decomposition）．

而相对应的，迭代法则是通过有限次的迭代，将数值解不断逼近解析解的过程．因此，迭代法通常都会引入一定的误差．这些误差可以通过增加迭代次数和改进方法逐渐逼近于机器精度．目前常见的迭代法包含了：雅可比法（Jacobi method），高斯-赛德尔迭代（Gauss-Seidel method），Krylov子空间法（Krylov subspace methods）等．由于迭代法对于数值代数的要求较高，这里就不做过多展开了．有兴趣的同学可以在下面留言，我会单独开一个子专栏进行讨论．

高斯消元法和LU分解

事实上，高斯消元法的过程就是构造LU分解的上下三角矩阵的过程．关于这个高斯消元法的基本算法我并不想过多的赘述，详细的过程可以在任意一本科学计算的书中或者网上找到，例如：



这里我想从更宏观的角度来分析一下高斯消元法和LU分解．这个方法的主要思路包含三步，以求解

图

 为例，我们接下来逐一解释．注意，这里的

图

  是一个

图

 的矩阵，

图

 都是

图

 的向量．

<ol><li><b>基本的消元运算</b></li></ol>通过高斯消元或者LU分解，得到

图

 ， 其中

图

 和

图

 分别是

图

 的上，下三角矩阵．我们将

图

 中第

图

 行， 第

图

 列的元素记做

图

 ，那么消元的算法（伪代码）如下

经过消元得到新的

图

 矩阵实际上就是LU分解中的上三角

图

 矩阵．而在消元过程中用于临时存储系数的

图

 矩阵，加上一个单位矩阵就可以得到LU分解的下三角矩阵．<b>事实上，细心的同学可以发现，这样的LU分解可以直接在</b>

图

 <b>的存储空间上进行，无需额外的内存</b>．

经过简单的计算，这样的消元过程总共需要进行

图

 次浮点运算．

<b>2. 前向替换（Forward substitution）</b>

把

图

 看做一个整体

图

 ，将求解<img src="https://www.zhihu.com/equation?tex=Ax%3Db" alt="Ax=b" eeimg="1"/> 转化为求解

图

 ．由于

图

 是下三角矩阵，它的第一行只有一个非0的元素

图

 ，因此这个求解过程可以简单的从第一行开始，逐行替换．

那么，整个的替换过程需要

图

 次浮点运算．

<b>3. 后向替换（Backward substitution）</b>

最后，我们利用从<b>2.</b>中得出的

图

 , 求解

图

 ，从而得到原本的未知数

图

 ．这个过程正好和求解下三角矩阵相反，需要从最后一行开始，依次向上．

同样的，它也需要

图

 次浮点运算．

<h2>小结</h2>这样看起来，我们把求解一个线性方程组的问题转化成了一个LU分解和求解两个线性方程组，但是由于

图

 和

图

 都是三角矩阵，它们的求解过程非常简单，因此整个过程的总体运算复杂度始终是由LU分解所主导，即为

图

 ．

<b>例子1:</b> 让我们来用下面的代码直接测试一下高斯消元法的运算复杂度．

运行后可以得到如下输出

从结果的拟合曲线可以看出，求解线性方程组的总体运算时间基本符合

图

 的三次方函数．<i><b>有兴趣的同学也可以试试用二次曲线拟合，看看是否符合．</b></i>

<b>例子2：</b>假设我们的计算机每秒可以处理

图

 次浮点运算，即1 giga FLOPS （Floating point operations per second），这其实比现在一般的笔记本电脑都要慢得多．下面这个表分别给出的是对于不同尺寸的问题，进行高斯消元运算和只进行向后替换的理论耗时．其中，

图

 是一次浮点运算所需的时间，即

图

 
即使是当今世界上最快的超级计算机，它们的运算速率可以达到

图

 FLOPS．如果用高斯消元法求解一个

图

 矩阵，也需要至少200年．

然而，很多实际应用问所需要求解的线性方程组的尺度经常会大于

图

 ，例如一些三维或者更高维度物理过程的模拟仿真，天气预报，等等．那么它们是如何被求解的呢？显然高斯消元只适用于中小尺寸的问题，对于大尺寸的线性方程组，我们需要其他运算复杂度更低的方法进行求解．这个我会在接下来的几期里陆续给大家介绍．

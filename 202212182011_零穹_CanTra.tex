% 正则变换
% 哈密顿量|分析力学|拉格朗日|哈密顿原理|哈密顿正则方程|正则变换

\begin{issues}
\issueDraft
\end{issues}

\pentry{哈密顿正则方程\upref{HamCan}}
简单来说，正则变换就是在相空间中选择另一组变量 $P,Q$ 作为坐标，使得和原来的变量 $p,q$ 之间一一对应，并且要求新坐标 $P,Q$ 仍满足哈密顿正则方程。
\subsection{为什么要作正则变换}
若存在循环坐标 $q^s$， 即拉氏量 $L$ 不显含 $q^s$，则哈密顿量
\begin{equation}
H=\sum_i p_i\dot q^i-L
\end{equation}
显然也不含循环坐标 $q^s$。由哈密顿正则方程\autoref{HamCan_eq2}~\upref{HamCan}
\begin{equation}
\dot p_s=-\pdv{H}{q^s}=0
\end{equation}
即 $p_s$ 是体系的循环积分（守恒量）。这就是说，哈密顿正则方程具有容易获得系统循环积分的优点。

之所以要在相空间中选择新的变量作为坐标，是因为人们总希望尽可能多找到系统运动方程的积分（守恒量），也就是要使尽可能多的坐标成为循环坐标。然而，能否出现循环坐标及循环坐标的数量是同坐标系的选择直接相关的，这可以从下面的例子看出。
\begin{example}{}
已知在二维平面上，质量为 $m$ 的质点受到来自 $O$ 点的引力场的作用（引力势能为 $-\mu\frac{m}{r}$）。那么在极坐标和平面直角坐标系下，其拉氏量和动量分别为
\begin{equation}
\begin{aligned}
L&=\frac{m}{2}\qty(\dot r^2+r^2\dot\theta^2)+\mu\frac{m}{r}\\
L&=\frac{m}{2}\qty(\dot x^2+\dot y^2)+\mu\frac{m}{\sqrt{x^2+y^2}}\\
p_\theta&=\pdv{L}{\dot \theta}=mr^2\dot\theta\\
p_r&=\pdv{L}{\dot r}=m\dot r\\
p_x&=\pdv{L}{\dot x}=m\dot x\\
p_y&=\pdv{L}{\dot y}=m\dot y
\end{aligned}
\end{equation}

而哈密顿量分别为（注意，在拉氏量 $L=T-V$ 时，$H=T+V$）
\begin{equation}
\begin{aligned}
H&=\frac{m}{2}\qty(\dot r^2+r^2\dot\theta^2)-\mu\frac{m}{r}\\
&=\frac{1}{2m}\qty(p_r^2+\frac{p_\theta^2}{r^2})-\mu\frac{m}{r}\\
H&=\frac{m}{2}(\dot x^2+\dot y^2)-\mu\frac{m}{\sqrt{x^2+y^2}}\\
&=\frac{1}{2m}\qty(p_x^2+p_y^2)-\mu\frac{m}{\sqrt{x^2+y^2}}
\end{aligned}
\end{equation}

从哈密顿量看到，在极坐标系中 $\theta$ 是循环坐标，从而就有一循环积分；而在直角坐标系中，并无循环坐标存在。 
\end{example}

考虑到通过正则方程获得循环积分的便利性，和循环坐标与坐标系选择的相关性，人们一方面要在进行坐标变换时，使新坐标描述系统时仍能满足正则方程；一方面要设法找到成为循环坐标的变量。说白了，我们所需要的和真正感兴趣的坐标变换，绝非随意的一种变换，而是指在限定意义下的坐标变换，即以新坐标描述的体系的哈密顿量仍能满足正则方程为前提条件，这样的坐标变换就称为\textbf{正则变换（canonical transformation）}。

\subsection{正则变换的条件}
在相空间中，设旧坐标 $(p,q)$ 和新坐标 $(Q,P)$ 的转换关系为
\begin{equation}
Q_i=Q_i(p,q,t),\quad P_i=P_i(p,q,t)
\end{equation}

设新坐标描述的哈密顿量为 $H'=H'(P,Q)$，要使运动方程具有正则形式，即新变量要满足下面的正则方程
\begin{equation}
\dot Q_i=\pdv{H'}{P_i},\quad \dot P_i=-\pdv{H'}{Q_i}
\end{equation}
该方程可以通过下面变分得到
\begin{equation}
\delta\int\qty(\sum_iP_i\dd Q_i-H'\dd t)=0
\end{equation}



\footnote{参考 \cite{Goldstein}。}对于同一系统， 我们可以采用不同的广义坐标， 广义动量和哈密顿量。 那么如何在这些不同选择中做变换呢？ 我们把一组广义坐标和广义动量记为 $q_1,\dots, q_N, p_1, \dots, p_N$， 哈密顿量为 $H(q, p, t)$。 另一组记为 $Q_1,\dots, Q_N, P_1, \dots, P_N$， 哈密顿量为 $K(Q, P, t)$。 那么他们满足什么关系，或者在二者之间进行变换呢？

首先， 根据勒让德变换\autoref{HamCan_eq1}~\upref{HamCan}， 拉格朗日量可以表示为
\begin{equation}
L = \sum_i \dot q_i p_i - H(q, p, t)
\end{equation}

如果对于不同的变量 $Q, P$， 以及哈密顿量 $K$， 那么

代入哈密顿原理

* 生成函数并不能生成所有的正则变换， 另一种方法是什么矩阵

% 开普勒问题的运动方程

\pentry{开普勒问题\upref{CelBd}， 中心力场问题\upref{CenFrc}}

开普勒问题中若已知轨道形状\upref{Keple1}， 我们来计算质点在轨道上的位置如何关于时间变化． 由\autoref{CenFrc_eq8}~\upref{CenFrc}得
\begin{equation}
t = \sqrt{\frac{m}{2}} \int_{r_0}^r \frac{\dd{r'}}{\sqrt{E - k/r' - L^2/(2mr'^2)}}
\end{equation}
该式对任何圆锥曲线轨道都适用， 其中 $r_0$ 是轨道的近日点， 对应 $\theta = \pi$． 令质点经过近日点时 $t= 0$． 把这个积分的结果 $t(r)$ 取反函数， 就可以得到 $r(t)$． 同理， 有
\begin{equation}
\dd{t} = \frac{mr^2}{L}\dd{\theta}
\end{equation}
将\autoref{Cone_eq5}~\upref{Cone}代入， 积分得
\begin{equation}
t = \frac{L^3}{mk^2} \int_{\pi}^\theta \frac{\dd{\theta'}}{(1 - e\cos \theta')^2 }
\end{equation}
以下我们令 $\Delta \theta = \theta - \pi$， 且 $\Delta \theta$ 和 $\Delta t$ 的取值区间关于原点对称． 由于轨道的对称性可知 $\Delta\theta(t)$ 是一个奇函数． 以下默认质点绕中心天体逆时针转动， 即 $\Delta\theta(t)$ 单调递增． 若要考虑顺时针， 取 $-\Delta\theta(t)$ 即可．

对\textbf{抛物线}（$e = 1$）， 假设逆时针运动， ， 有
\begin{equation}\label{EqMoKp_eq3}
t = \frac{L^3}{2mk^2} \qty(\tan\frac{\Delta\theta}{2} +  \frac{1}{3}\tan^3 \frac{\Delta\theta}{2})\quad (-\pi<\Delta\theta<\pi)
\end{equation}

对于\textbf{椭圆}（$e < 1$）， 可以用一个参数\textbf{偏近点角（eccentric anomaly）} $\psi$ 来代替 $\Delta\theta$ 会更方便． $\psi$ 的定义为
\begin{equation}\label{EqMoKp_eq1}
r = a(1-e\cos\psi)
\end{equation}
其中 $a$ 是半长轴． 当 $\Delta\theta $ 从 $-\pi$ 变化到 $\pi$ 时， $\psi$ 也从 $-\pi$ 变化到 $\pi$， $\psi(\Delta\theta)$ 是一个递增奇函数．
\begin{equation}\label{EqMoKp_eq5}
t = \sqrt{\frac{ma^3}{-k}} (\psi - e \sin\psi)
\end{equation}
该式被称为\textbf{开普勒方程（Kepler's equation）}， 开普勒第二定律也可以由该式验证．

对于\textbf{双曲线}（$k<0$）， 偏近点角 $\xi$ 使用下式定义：
\begin{equation}\label{EqMoKp_eq2} % 已经验算正确
r = a(e\cosh\xi - 1) \qquad (\xi \in \mathbb R)
\end{equation}
$\xi$ 从 $-\infty$ 到 $\infty$ 的变化对应 $\Delta\theta$ 从 $-\pi$ 到 $\pi$ 变化． $\xi(\Delta\theta)$ 是一个递增奇函数．
\begin{equation}\label{EqMoKp_eq4}
t = \sqrt{\frac{ma^3}{-k}} (e\sinh\xi - \xi)
\end{equation}


\addTODO{双曲线 $k>0$ 情况是否也相同？}

\subsection{推导}
\addTODO{……}

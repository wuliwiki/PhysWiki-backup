%一阶线性微分方程
% 微积分|微分方程|常微分方程|一阶线性微分方程|齐次|常数易变法

\begin{issues}
\issueNeedCite
\issueOther{需要补充例子}
\end{issues}

\pentry{常微分方程\upref{ODE}}

具有以下形式的微分方程叫做\textbf{一阶线性微分方程（first order linear differential equation）}
\begin{equation}\label{ODE1_eq1}
\dv{y}{x} + p(x)y = f(x)
\end{equation}
其中函数 $p(x)$ 和 $f(x)$ 是已知的， 函数 $y(x)$ 是未知的， 称为方程的解． 这三个函数的自变量都是实数， 函数值可以是实数或者复数． 若 $f(x) \equiv 0$， 则称方程为\textbf{齐次的（homogeneous）}， 否则就是\textbf{非齐次的（inhomogeneous）}． 所以 $f(x)$ 叫做方程的\textbf{非齐次项（inhomogeneous term）}．

\subsection{线性}
首先介绍函数的线性组合． \footnote{线性组合是线性代数中的概念， 线性代数中， 线性空间都可以做线性组合， 例如几何矢量（\autoref{GVecOp_eq1}~\upref{GVecOp}）． 特定函数的集合可以看作线性空间（\autoref{LSpace_ex2}~\upref{LSpace}）．}


\begin{example}{稀释酒精}
一个容器中装有质量为 $M$ （千克）的酒精， 从某时刻开始以速率 $I$ （千克每秒）加水， 且以同样的速率从底部排水． 假设水一进入容器就瞬间与酒精搅匀， 求容器中酒精浓度 $x$（酒精质量比总质量）随时间的变化关系．

令容器中酒精的质量为 $m_1$， 水的质量为 $M - m_1$． 流出容器的液体速率可以分为两部分： 流出酒精的速率为 $xI$， 流出水的速率为 $I - xI$． 所以容器中酒精质量的变化率为
\begin{equation}
m'_1 = -xI
\end{equation}
酒精浓度定义为 $x = m_1/M$， $M$ 是常数， 所以
\begin{equation}
x' = \qty(\frac{m_1}{M})' = \frac{m'_1}{M} = -\frac{I}{M}x
\end{equation}
\end{example}


 另外，如果 $f(x)$ 项不出现， 方程就是\textbf{齐次}的， 否则就是\textbf{非齐次}的． 我们先来看以上方程对应的齐次方程
\begin{equation}\label{ODE1_eq2}
\dv{y}{x} + p(x)y = 0
\end{equation}
这是一个可分离变量的方程% 什么是分离变量？
， 分离变量得
\begin{equation}
\frac{\dd{y}}{y} = -p(x) \dd{x}
\end{equation}
两边积分得
\begin{equation}
\ln\abs{y} = -\int p(x) dx + C
\end{equation}
两边取自然指数得
\begin{equation}
y = \pm \E^C \E^{-\int p(x) \dd{x}}
\end{equation}
把 $\pm \E^C $ 整体看做一个任意常数 $C$， 上式变为．
\begin{equation}\label{ODE1_eq6}
y = C \E^{-\int p(x) \dd{x}}
\end{equation}
这就是一阶线性齐次微分方程\autoref{ODE1_eq2} 的通解， 也叫\autoref{ODE1_eq1} 的\textbf{齐次解}．

\subsection{常数变易法}

现在我们用\textbf{常数变易法}来解非齐次方程\autoref{ODE1_eq1}． 为书写方便， \autoref{ODE1_eq6} 中令 $y_0(x) = \exp(-\int p(x) \dd{x})$． 假设上式中的 $C$ 是一个函数 $C(x)$ 而不是常数， 代入\autoref{ODE1_eq1} 得
\begin{equation}
C'y_0 + C[y_0' + p(x)y_0] = f(x)
\end{equation}
由于 $y_0$ 是齐次解， 上式方括号中求和为 0， 分离变量得
\begin{equation}
\dd{C}= \frac{f(x)}{y_0} \dd{x}
\end{equation}
两边积分得
\begin{equation}
C(x) = \int \frac{f(x)}{y_0} \dd{x}
\end{equation}
所以一阶线性非齐次微分方程的通解为
\begin{equation}\label{ODE1_eq10}
y = y_0  \int \frac{f(x)}{y_0} \dd{x}
\end{equation}
其中
\begin{equation}\label{ODE1_eq11}
y_0(x) = \E^{-\int p(x) \dd{x}}
\end{equation}
注意待定常数包含在\autoref{ODE1_eq10} 的不定积分中， \autoref{ODE1_eq11} 中的不定积分产生的待定常数在代入\autoref{ODE1_eq10} 后可消去．

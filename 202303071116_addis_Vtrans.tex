% 速度的参考系变换
% 速度|坐标系|参考系|速度叠加|相对速度

% 主要是说明科里奥利力词条中的

\pentry{圆周运动的速度\upref{CMVD}， 三维旋转矩阵\upref{Rot3D}}

\subsection{无相对转动}
这种情况就是高中物理中所谓的 “绝对速度 = 相对速度 + 牵连速度”： 若某时刻两个坐标系 $S$ 和 $S'$ 之间无相对转动， 那么某时刻两坐标系之间的相对速度是唯一确定的， 即 $S'$ 系中任意一个固定的点相对于 $S$ 系的速度矢量都是相同的。 注意我们不要求 $S$ 系和 $S'$ 系的单位矢量 $\uvec x, \uvec y, \uvec z$ 和 $\uvec x', \uvec y', \uvec z'$ 同方向， 只要求它们的相对方向不随时间变化。

把 $S'$ 系相对于 $S$ 系的速度记为 $\bvec v_r$ 根据高中所学的速度叠加原理， 若某点 $P$ 相对于 $S$ 系的速度瞬时为 $\bvec v_S$， 相对于 $S'$ 的瞬时速度为 $\bvec v_{S'}$ 我们有
\begin{equation}\label{Vtrans_eq1}
\bvec v_{S} = \bvec v_{S'} + \bvec v_r
\end{equation}
其中三个矢量都可以是时间的函数。 注意该式与点 $P$ 的位置无关只和速度有关。

\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/Vtrans_1.pdf}
\caption{一个简单的例子：在相对于地面运动的火车上看，飞机的速度似乎更慢一些。\textsl{假设火车和飞机的速度远低于光速！}} \label{Vtrans_fig1}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/Vtrans_2.pdf}
\caption{另一个简单的例子：在相对于地面下坡运动的火车上看，飞机似乎在抬升。} \label{Vtrans_fig2}
\end{figure}

注意\autoref{Vtrans_eq1} 中的矢量都是\textbf{几何矢量}\upref{GVec}， 不能将 $\bvec v_S$ 和 $\bvec v_S'$ 等同于点 $P$ 在 $S$ 系和 $S'$ 系中的三个直角坐标的求导。 如果要将\autoref{Vtrans_eq1} 写成坐标矢量的形式， 三个矢量必须使用同一坐标系（见\autoref{Vtrans_ex2}）。

本书中， 粗体正体的字母既可以用于表示几何矢量本身， 又可以表示其坐标\footnote{小时百科符号与规范\upref{Conven}}。 对于后者， 我们可以声明坐标所使用的坐标系
\begin{equation}\label{Vtrans_eq5}
(\bvec v_{S})_{S} = (\bvec v_{S'})_{S} + (\bvec v_r)_{S}~,
\end{equation}
\begin{equation}\label{Vtrans_eq6}
(\bvec v_{S})_{S'} = (\bvec v_{S'})_{S'} + (\bvec v_r)_{S'}~.
\end{equation}

\begin{example}{}\label{Vtrans_ex2}
令 $S$ 系和 $S'$ 系中的三个单位矢量分别为 $\uvec x, \uvec y, \uvec z$ 和 $\uvec x', \uvec y', \uvec z'$。 他们的关系以及相对速度为
\begin{equation}
\uvec y' = \uvec x~, \quad
\uvec z' = \uvec y~, \quad
\uvec x' = \uvec z~, \quad
\bvec v_r = 2\uvec x = 2\uvec y'~.
\end{equation}
点 $P$ 在 $S$ 系中坐标关于时间的导数为 $(\bvec v_S)_S = (1, 2, 3)$。 请将\autoref{Vtrans_eq1} 表示为三个分量的形式。

\textbf{解：} 容易得出， 点 $P$ 在 $S'$ 系中的坐标关于时间的导数为 $(\bvec v_{S'})_{S'} = (3, -1, 2)$。

我们先来看错误的理解： 将\autoref{Vtrans_eq1} 中 $\bvec v_S$ 等同于 $(1, 2, 3)$， $\bvec v_{S'}$ 等同于 $(3, -1, 2)$,  这时会发现， 无论 $\bvec v_r$ 取 $(\bvec v_r)_S = (2, 0, 0)$ 还是 $(\bvec v_r)_{S'} = (0, 2, 0)$ 都不能让\autoref{Vtrans_eq1} 成立。

正确的做法是将三个矢量都放到同一坐标系中。 可以验证\autoref{Vtrans_eq5} 和\autoref{Vtrans_eq6} 都成立。

对于更一般的情况， 两参考系中矢量的坐标变换需要使用三维旋转矩阵\upref{Rot3D} 。
\end{example}

\subsection{有相对转动}
对于任意两个坐标系， 他们之间的相对运动除了平移可能还有转动， 即 $\uvec x, \uvec y, \uvec z$ 和 $\uvec x', \uvec y', \uvec z'$ 之间的关系可能随时间变化。 这时\autoref{Vtrans_eq1} 是否仍然成立呢？

要回答这个问题我们首先要修改 $\bvec v_r$ 的定义。 按照上一节的定义， 如果坐标系间存在相对转动， $\bvec v_r$ 将与固定点的位置有关。 若定义某时刻点 $P$ 在 $S'$ 中的坐标为 $(x_p', y_p', z_p')$， 则 $\bvec v_r$ 可以定义为 $S'$ 系中的固定点 $(x_p', y_p', z_p')$ 相对于 $S$ 系的瞬时速度。 这时仍有
\begin{equation}\label{Vtrans_eq2}
\bvec v_{S} = \bvec v_{S'} + \bvec v_r~.
\end{equation}
证明见下文。 再次强调， 这三个矢量也表示几何矢量。 若要记为坐标的形式需要使用同一坐标系（\autoref{Vtrans_eq5} \autoref{Vtrans_eq6} ）。

\begin{example}{}\label{Vtrans_ex1}
令 $S'$ 系 $t = 0$ 时与 $S$ 系重合并绕 $z$ 轴逆时针以恒定角速度 $\omega$ 相对 $S$ 转动， 又令点 $P$ 的运动方程为 $\bvec r(t) = \alpha t \uvec x'$， 验证\autoref{Vtrans_eq2}。

首先将 $\bvec r(t)$ 用 $\uvec x, \uvec y$ 基底表示为
\begin{equation}
\bvec r(t) = \alpha t (\cos\omega t\, \uvec x + \sin\omega t\, \uvec y)~.
\end{equation}
将 $\uvec x, \uvec y, \uvec z$ 视为常矢量， $\bvec r(t)$ 关于时间求导得点 $P$ 相对于 $S$ 系的速度
\begin{equation}
\bvec v_S = \alpha (\cos\omega t \,\uvec x + \sin\omega t \,\uvec y)
+ \alpha\omega t (-\sin\omega t \,\uvec x + \cos\omega t \,\uvec y)~.
\end{equation}
将 $\uvec x', \uvec y', \uvec z'$ 视为常矢量， $\bvec r(t)$ 关于时间求导得点 $P$ 相对于 $S'$ 系的速度
\begin{equation}
\bvec v_{S'} = \dv{t} (\alpha t \uvec x') = \alpha \uvec x' = \alpha (\cos\omega t\, \uvec x + \sin\omega t \,\uvec y)~.
\end{equation}
最后， $t$ 时刻两坐标系在点 $P$ 处的相对速度（见\autoref{CMVD_eq5}~\upref{CMVD} ）为
\begin{equation}\label{Vtrans_eq3}
\begin{aligned}
\bvec v_r &= \bvec\omega \cross \bvec r = (\omega \uvec z') \cross (\alpha t \uvec x') \\
&= \alpha\omega t \uvec z'\cross\uvec x' = \alpha\omega t \uvec y' = \alpha\omega t(-\sin \omega t \,\uvec x + \cos\omega t \,\uvec y)~.
\end{aligned}\end{equation}
将以上三式代入\autoref{Vtrans_eq2} 可验证其成立。 注意以上我们将所有的矢量用 $\uvec x, \uvec y, \uvec z$ 基底， 同理我们也可以将所有矢量用 $\uvec x', \uvec y', \uvec z'$ 基底展开。
\end{example}

一般情况下， 相对速度 $\bvec v_r$ 可以拆分成 $S'$ 的原点 $O'$ 在 $S$ 中的速度和 $S'$ 相对 $S$ 旋转产生的速度两部份， 即
\begin{equation}\label{Vtrans_eq4}
\bvec v_r = \bvec v_{O'} + \bvec \omega \cross \bvec r'~.
\end{equation}
在\autoref{Vtrans_ex1} 中， 两个原点始终重合， 所以 $\bvec v_{O'} = \bvec 0$， $\bvec r' = \bvec r$， 所以有 $\bvec v_r = \bvec\omega \cross \bvec r$。

\subsubsection{证明}
现在用旋转变换矩阵\upref{Rot3D}在 $S$ 系中证明\autoref{Vtrans_eq2} 。 令 $S'$ 中坐标到 $S$ 坐标的旋转变换矩阵\upref{Rot3D}为 $\mat R$， 即对任意几何矢量 $\bvec A$ 有 $\mat R (\bvec A)_{S'} = (\bvec A)_S$， 那么有
\begin{equation}
\bvec r_S = \bvec r_{O'} + \bvec r_{S'}~.
\end{equation}
用 $S$ 中的坐标来表示， 就是
\begin{equation}
(\bvec r_S)_S = (\bvec r_{O'})_S + (\bvec r_{S'})_S = (\bvec r_{O'})_S + \mat R(\bvec r_{S'})_{S'}~.
\end{equation}
两边对时间求导得
\begin{equation}
({\bvec v}_r)_S = ({\bvec v}_{O'})_S + \dot{\mat R}(\bvec r_{S'})_{S'} + \mat R ({\bvec v}_{S'})_{S'}~.
\end{equation}
右边前两项就是固定点之间的相对速度（\autoref{Vtrans_eq4}） $(\bvec v_r)_S$， 而第三项为 $(\bvec v_{S'})_S$。 这样就得到了\autoref{Vtrans_eq5} 。

证毕。

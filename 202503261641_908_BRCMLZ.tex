% 玻尔兹曼因子（综述）
% license CCBYNCSA3
% type Wiki

本文根据 CC-BY-SA 协议转载翻译自维基百科\href{https://en.wikipedia.org/wiki/Boltzmann_distribution}{相关文章}。

在统计力学和数学中，玻尔兹曼分布（也称为吉布斯分布\(^\text{[1]}\)）是一种概率分布或概率测度，用于描述一个系统处于某一状态的概率，它是该状态能量和系统温度的函数。该分布的形式为：
\[
p_i \propto \exp\left(-\frac{\varepsilon_i}{kT}\right)~
\]
其中：\( p_i \)是系统处于状态\( i \)的概率；\( \exp \)是指数函数；\( \varepsilon_i \)是该状态的能量；常数\( kT \)是玻尔兹曼常数\( k \)与热力学温度\( T \)的乘积。符号\( \propto \)表示成比例关系（关于比例常数的具体内容，见“分布”一节）。

这里的“系统”一词具有广泛的含义；它可以指从“足够数量”的原子或单个原子\(^\text{[1]}\)到像天然气储罐这样的宏观系统。因此，玻尔兹曼分布可以用于解决各种各样的问题。该分布表明，能量较低的状态总是具有更高的被占据的概率。

两个状态的概率之比被称为玻尔兹曼因子，其特征是仅依赖于这两个状态的能量差：
\[
\frac{p_i}{p_j} = \exp\left(\frac{\varepsilon_j - \varepsilon_i}{kT}\right)~
\]
玻尔兹曼分布以路德维希·玻尔兹曼的名字命名，他最早于1868年在研究热平衡状态下气体的统计力学时提出了这一分布。\(^\text{[2]}\)玻尔兹曼的统计工作体现在他的论文《论机械热理论的第二基本定理与关于热平衡条件的概率计算之间的关系》中。\(^\text{[3]}\)之后，约西亚·威拉德·吉布斯于1902年在其现代通用形式上对该分布进行了深入研究。\(^\text{[4]}\)

玻尔兹曼分布不应与麦克斯韦–玻尔兹曼分布或麦克斯韦-玻尔兹曼统计混淆。玻尔兹曼分布给出了系统处于某一状态的概率，作为该状态能量的函数[5]，而麦克斯韦-玻尔兹曼分布给出了理想气体中粒子速度或能量的概率。然而，一维气体中的能量分布确实遵循玻尔兹曼分布。
\subsection{分布}  
玻尔兹曼分布是一种概率分布，它给出了某一状态的概率，作为该状态能量和分布所应用的系统的温度的函数\(^\text{[6]}\)。它的表达式为：
\[
p_i = \frac{1}{Q} \exp\left(-\frac{\varepsilon_i}{kT}\right) = \frac{\exp\left(-\frac{\varepsilon_i}{kT}\right)}{\sum _{j=1}^{M}\exp\left(-\frac{\varepsilon_j}{kT}\right)}~
\]
其中：
\begin{itemize}
\item exp() 是指数函数，  
\item \(p_i\)是状态\(i\)的概率，  
\item \(\varepsilon_i\)是状态\(i\)的能量，  
\item \(K\)是玻尔兹曼常数，  
\item \(T\)是系统的绝对温度，  
\item \(M\)是系统可达的所有状态的数量，[6][5]  
\item \(Q\)某些作者用\(z\)表示）是归一化分母，即经典配分函数  
\end{itemize} 
\[{\displaystyle Q=\sum _{j=1}^{M}\exp \left(-{\tfrac {\varepsilon _{j}}{kT}}\right)}~\]
这来自于所有可达状态的概率必须加起来等于 1 的约束。

使用拉格朗日乘子法，可以证明玻尔兹曼分布是最大化熵的分布：
\[
S(p_1, p_2, \cdots, p_M) = -\sum_{i=1}^{M} p_i \log_2 p_i~
\]
在归一化约束条件下，即\(\sum p_i = 1\)以及约束条件下，即\(\sum p_i \varepsilon_i\)等于一个特定的平均能量值，除了两种特殊情况。（这些特殊情况出现在平均值是能量\(\varepsilon_i\)的最小值或最大值时。在这些情况下，最大化熵的分布是玻尔兹曼分布的极限，其中\(T\)分别从上方或下方趋近于零。）

如果我们知道系统可达状态的能量，分配函数就可以计算出来。对于原子，分配函数的值可以在NIST原子光谱数据库中找到。\(^\text{[7]}\)

该分布表明，能量较低的状态总是比能量较高的状态具有更高的占据概率。它还可以为我们提供两种状态被占据的概率之间的定量关系。状态 i 和 j 的概率比率可以表示为：
\[
\frac{p_i}{p_j} = \exp \left( \frac{\varepsilon_j - \varepsilon_i}{kT} \right)~
\]
其中：
\begin{itemize}
\item \( p_i \)是状态\(i\)的概率，  
\item \( p_j \)是状态\(j\)的概率，  
\item \( \varepsilon_i \)是状态\(i\)的能量，  
\item \( \varepsilon_j \)是状态\(j\)的能量。
\end{itemize}
能量级别的人口比率还必须考虑它们的简并度。

玻尔兹曼分布常用于描述粒子（如原子或分子）在其可达的束缚态上的分布。如果我们有一个由许多粒子组成的系统，粒子处于状态\(i\)的概率实际上是这样的概率：如果我们从该系统中随机挑选一个粒子并检查它处于什么状态，那么我们发现它处于状态\(i\)。这个概率等于状态\(i\)中的粒子数除以系统中粒子的总数，也就是占据状态\(i\)的粒子的比例。
\[
p_i = \frac{N_i}{N}~
\]
其中\( N_i \)是状态\(i\)中的粒子数，\( N \)是系统中粒子的总数。我们可以使用玻尔兹曼分布来求得这个概率，即我们已经看到的，它等于处于状态 i 的粒子的比例。因此，给出状态\(i\)中粒子比例的方程是\(^\text{[5]}\)：
\[
\frac{N_i}{N} = \frac{\exp \left( -\frac{\varepsilon_i}{kT} \right)}{\sum_{j=1}^{M} \exp \left( -\frac{\varepsilon_j}{kT} \right)}~
\]
这个方程对于光谱学非常重要。在光谱学中，我们观察原子或分子从一种状态到另一种状态的跃迁所产生的光谱线。\(^\text{[5][8]}\)为了使这一过程成为可能，必须有一些粒子处于初始状态以进行跃迁。我们可以通过计算处于初始状态的粒子比例来判断这个条件是否成立。如果比例微不足道，那么在该温度下进行计算时，跃迁很可能不会被观察到。一般来说，初始状态中分子比例越大，跃迁到第二状态的数量就越多。\(^\text{[9]}\)这会产生更强的光谱线。然而，还有其他因素会影响光谱线的强度，例如它是否由允许的跃迁或禁止的跃迁引起。

在机器学习中常用的 softmax 函数与玻尔兹曼分布有关：
\[
(p_1, \ldots, p_M) = \operatorname{softmax} \left[ -\frac{\varepsilon_1}{kT}, \ldots, -\frac{\varepsilon_M}{kT} \right]~
\]
\subsection{广义玻尔兹曼分布}
形式为
\[
\Pr \left(\omega \right) \propto \exp \left[ \sum_{\eta =1}^{n} \frac{X_{\eta} x_{\eta}^{(\omega)}}{k_B T} - \frac{E^{(\omega)}}{k_B T} \right]~
\]
被一些作者称为广义玻尔兹曼分布。\(^\text{[10]}\)

玻尔兹曼分布是广义玻尔兹曼分布的一个特例。广义玻尔兹曼分布在统计力学中用于描述经典系综、大系综和等温等压系综。广义玻尔兹曼分布通常是从最大熵原理推导出来的，但也有其他的推导方法。\(^\text{[10][11]}\)

广义玻尔兹曼分布具有以下特性：
\begin{itemize}
\item 它是唯一一个使得根据吉布斯熵公式定义的熵与经典热力学中定义的熵相匹配的分布。\(^\text{[10]}\)
\item 它是唯一一个在数学上与基本热力学关系一致的分布，其中状态函数通过系综平均描述。\(^\text{[11]}\)
\end{itemize}
\subsection{在统计力学中}  
玻尔兹曼分布出现在统计力学中，当考虑处于热平衡（即能量交换平衡）的固定组成的封闭系统时。最一般的情况是正则系综的概率分布。一些特殊情况（可从正则系综推导出）展示了玻尔兹曼分布的不同方面：


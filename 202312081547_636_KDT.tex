% KD-Tree
% keys 数据结构|计算机
% license Usr
% type Wiki

KD-Tree （K-Dimension Tree）是一种空间划分数据结构，顾名思义，可以对 $k$ 维空间进行划分。它常被用于高维空间中的搜索，比如范围搜索和最近邻搜索，时间复杂度由 $k$ 和总节点数 $n$ 共同保障。一般当 $n$ 远大于 $2^k$ 时，应用 KD-Tree 的效果是最好的。

KD-Tree 具有\textbf{二叉搜索树}的形态，二叉搜索树上的每个结点都对应 $k$ 维空间内的一个点。其每个子树中的点都在一个 $k$ 维的超长方体内，这个超长方体内的所有点也都在这个子树中。

假设我们已经知道了 $k$ 维空间内的 $n$ 个不同的点的坐标，要将其构建成一棵 KD-Tree，步骤如下：

若当前超长方体中只有一个点，返回这个点。

选择一个维度，将当前超长方体按照这个维度分成两个超长方体。

选择切割点：在选择的维度上选择一个点，这一维度上的值小于这个点的归入一个超长方体（左子树），其余的归入另一个超长方体（右子树）。

将选择的点作为这棵子树的根节点，递归对分出的两个超长方体构建左右子树，维护子树的信息。
% Crank-Nicolson TDSE 笔记
% 薛定谔方程|数值解|偏微分方程|量子力学

\subsection{氢原子的数值误差}
解三维氢原子的时候， 为了防止势能为无穷， 中心点要选在八个格点中间．

首先用的 $60\times 60\times 60$ a.u. 的范围， $401\times 401\times 401$ 的格点， $0.032$ a.u. 的时间步长．

TDSE 传播时， 如果把 log 概率灰度图的范围取得很大 （$10^{-25}$ 左右）， 即使没有电场， 也会出现一个方形的花纹很快地扩散出来， 然后波函数还会向外温柔地扩散．

比较了用解析的基态波函数和 Imaginary Time 得到的基态波函数， 虽然两者都有类似情况， 但是后者的程度明显要轻．

爱华说 XUV 的强度并不太重要， 频率越大， 氢原子的截面就越小， 所以反而需要更大的强度才能电离出同样的概率． 但只要不超过 $1\times 10^{16} \Si{W/cm^2}$ （0.5338 a.u.）就好．

\subsection{Virtual Detector 的两个问题}
一个是如果电场还没有完全消失， 那么电离出来的波函数仍然会随着电场振动， 那么检测到的动量分布就不可靠了．

第二个是如果用 histogram 的办法来获得动量分布， 那么有可能数据点不够， bin 太窄又波动大， bin 太宽又分辨率不够． 如果像 Uwe 的论文那样通过 interpolate 的方法来获取动量分布， 那么要求 Virtual Detector 检测到的“概率-时间” 曲线和 “动量-时间” 曲线都非常平滑， 用高斯波（无势能）测试的时候还足够平滑， 一旦用氢原子电离的波函数就不行了． 而且电离出的波函数检测到的动量会上下波动（有可能是因为电场）， 这样就要把“动量-时间”函数分成单调的分段， 而且在导数为零的时候， 还有可能会 blowup．

所有考虑了一下还是想做傅里叶变换． 一是即使 Virtual Detector 做了种种修改后出结果了， 也可以用 FFT 进行验证． 二是如果 FFT 比较好， 就直接用呗． FFT 的一个限制就是要等到波函数电离完成后， 最远的波函数也不能超过 box 的边界， 还有就是电离出的波函数最好远离原子核， 少受库仑力的影响， 这样才能保证接下来的动量谱不随时间变化．

从高斯波包的实验来看， 即使在理想情况下 3D 的 local Virtual Detector 和 FFT 也是不同的， 因为高斯波包会随时间变大， 概率波也会更稀， 所以 Virtual Detector 检测到的动量分布并不是对称的， 而是前面胖后面瘦．

另外我觉得即使使用 FFT 也需要一圈 absorber 用于吸收开始是的方形花纹噪音．

\subsection{Streaking}
SFA 公式中当 XUV 为零时， IR 是不会对能量谱造成任何影响的． 那么 TDSE 中会吗？ 理想的情况是， IR 不会产生任何电离， 只会使基态波函数发生微弱的形变． 一旦 XUV 电场结束后， IR 电场同样不会产生任何电离， 只会让已经电离出来的波函数加速和减速．

那接下来 IR 对电离出的波函数的影响应该完全模拟吗？ 如果是的话， 那么将需要一个很大的 box， Ivanove paper 中的 TDSE 用了 5000 个径向格点（不等间距）， 2000 个原子单位的长度， 我的 GPU 代码是绝对实现不了这个的．

有一种想法是在电离波函数离开 box 之前将它们 FFT 分解成平面波， 然后在用 Volkov State 的解析办法分析接下来每个平面波在剩下的 IR 场中的变化情况， 这样或许是可行的．


\subsection{Streaking}
这里的目标是用 TDSE 模拟出氢原子的 Streaking 谱， XUV 和 IR 参数就用 Ivanov 的论文 （Attosecond recorder of ...） 中的．

XUV 是 250 as， 41 eV （动能 1.007 a.u.）， 还有 varying ellipticity， 最大强度约 $5\times 10^{-4}$ a.u. （不重要）， IR 是 800 nm， 7.2 fs （297.5 a.u.）， 强度 $3.5\times 10^{12} \Si{W/cm^2}$ （0.01 a.u.）．

用经典电子来估计 TDSE 所需 box 的大小， 速度为 $\sqrt{2}$ 左右， 若最大传播时间为 IR 长度的两倍， 可以走 841 a.u.， 比我测试 XUV 用的 60 a.u. 盒子大了一个数量级． 再加上我的直角坐标网格不能改变长度， 结果就非常地惨烈了．

唯一有可能挽救我的程序的方法就是只模拟到 XUV 消失， 这时只要保证波函数还在盒内就可以做一个 FFT 然后用 Volkov 波函数来解析传播． 但是 XUV 消失的时候电离波包也就离原子核 40 a.u. 左右， 所以如果这时开始忽略库仑力， 那么动能谱将会有 2.5\% 的误差， 这应该是不能接受的． 即使波函数继续传播到 100 a.u. 开外， 动能普也会有 1\% 的误差． 所以师兄还是老的辣， 第一反应就是不行．

所以最后的解决方法只能是用参考文献 29 的超级复杂的球坐标 TDSE 代码了（Fortran）．

\subsection{SCID-TDSE}
看来 TDSE Streaking 真的远远没有我想的那么简单． 试了一下 State of Art 的 SCID-TDSE 代码， 单核 CPU 就完爆我的 GPU 代码了！ 而且 Memory 使用更是少得不能再少． 这个算法是在球坐标中把波函数在球谐函数展开， 具体见论文就好， 总之这个算法超级复杂．

好不容易用 Matlab 写好了处理运行结果的程序， 用傅里叶变换分析最后的波函数谱． 但出来以后动量普并不是一个完美的波包． 然而师兄一跑出来就是！ 师兄真的好猛啊， 想起了当年的坦兄．

傅里叶变换的一个问题是， 如果波函数不做任何处理， 由于电离出的总概率很小， 那么基态波函数的动量谱将会把电离出的波包的动量谱覆盖． 我的第一反应是挖掉中间的波函数， 而师兄的做法是挖掉 $l = 0$ 的分量， 理由是根据微扰理论/选择定则， 电离出来的 $l = 1$． 但我试过以后发现如果电离波包和基态完全分离两种做法并无差别， 但如果有重叠的， 还是师兄的做法好． 另外用我的参数 $2\times 10^{14} \Si{W/cm^2}$ 的光强， 比师兄的 $1\times 10^{10}$ 到 $1\times 10^{11}$ 强很多， 我的电离总概率是 $1/1000$ 左右， 而师兄的是 $7.6\times 10^{-7}$， 差了三个数量级． 结果他的动量谱是高斯的， 而我的是一个不对称的包； 他的电离波包是和基态完全分离的， 我的不是． 根据微扰理论， 电离概率应该适合电场平方成正比的．

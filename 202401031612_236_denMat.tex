% 密度矩阵
% keys 量子力学|纯态|混合态|密度矩阵|测量
% license Xiao
% type Tutor

\pentry{矩阵的迹\upref{trace}， 投影算符\upref{projOp}， 量子力学的基本假设\upref{QMPos}}

\footnote{参考 Shankar, Principles of Quantum Mechanics 2ed， 以及 Wikipedia}若一个系综中的 $N$ 个系统中， 有 $n_i$ （$i = 1,2,\dots,k$） 个在状态 $\ket{i}$ （这里假设 $\ket{i}$ 是正交归一的）。 那么这个系综可以用\textbf{密度矩阵（density matrix）}（或算符）描述
\begin{equation}\label{eq_denMat_1}
\rho = \sum_i p_i\ket{i}\bra{i}   ~.
\end{equation}
其中 $p_i = n_i/N$ 是随机选一个系统， 处于状态 $\ket{i}$ 的概率。 若所有系统都处于同一个 $\ket{i}$， 那么这个系综就是\textbf{纯的（pure）}， 否则就是\textbf{混合的（mixed）}。

\subsection{非纯态的等效}
纯态 $\ket{\psi}$ 可以唯一地表示为密度矩阵 $\rho = \ket{\psi}\bra{\psi}$， 它的意义也相当明确。

然而对于非纯态， 我们可以使用不同的正交归一的（纯态）基底的概率组合来表示， 测量结果却是一样的。 因为测量并不能区分量子概率和经典概率。

例如有一束电子。 若这束电子是纯态的， 我们就可以通过多次测量得到这个纯态（除了一个总体相位因子）。 例如通过测量 $\ket{y+}$ 和 $\ket{y-}$ 的概率， 我们可以确定 $\ket{x+} + c\ket{x-}$ 中的复数 $c$。

但若这束电子的自旋方向是随机的， 我们既可将其等效为随机的一半 $\ket{x+}$ 和 $\ket{x-}$ 构成的， 也可以等效为随机的一半 $\ket{y+}$ 和 $\ket{y-}$ 构成的。 虽然 “实际” 上它们是不一样的， 但任何测量都无法区分这两种情况。 所以密度矩阵可以是 $\rho = (\ket{x+}\bra{x+} + \ket{x-}\bra{x-})/2$ 也可以是 $\rho = (\ket{y+}\bra{y+} + \ket{y-}\bra{y-})/2$。 事实上， 它们都是单位矩阵的一半。 注意如果概率不是均分的， 如 $\rho = (\ket{x+}\bra{x+}/3 + 2\ket{x-}\bra{x-})/3$ 就无法用 $\ket{y\pm}$ 基底表示（一般的对角矩阵经过相似变换后不是对角矩阵）。

纯态和非纯态都可以对应一个唯一密度矩阵。

\subsection{密度矩阵的性质}
\pentry{半正定矩阵\upref{DefMat}}
\begin{itemize}
\item 密度矩阵算符是厄米算符（自伴算符）

\item 密度矩阵的迹为 1

\item 密度矩阵是半正定矩阵。可以从\autoref{eq_denMat_1} 看到，对任意态 $\ket\varphi$，总是有 
    $\bra\varphi \rho \ket\varphi\ge 0$
\item 对于给定力学量算符$\Omega$，求取$\Omega$的期望值
    是$\left\langle \Omega \right\rangle = \opn{tr}\left(\rho\Omega\right)$
    
    对于某个物理量对应的算符 $\Omega$， 它的\textbf{系综平均值（ensemble average）}为
    \begin{equation}
    \ev{\bar\Omega} = \sum_i p_i \mel{i}{\Omega}{i}~.
    \end{equation}
    这个平均值既包含了每个 $\ket{i}$ 的平均， 又包含了对每个系统的平均。

    系综平均也可以用迹表示为 $\opn{tr}(\Omega\rho)$。 根据迹的定义，
    \begin{equation}\label{eq_denMat_3}
    \opn{tr}(\Omega\rho) = \sum_j \mel{j}{\Omega\rho}{j} = \sum_{i,j} p_i\mel{j}{\Omega}{i} \braket{i}{j} = \sum_{i} p_i\mel{i}{\Omega}{i} = \ev{\bar\Omega}~.
    \end{equation}
    证毕。

    对于纯态， 获得测量值 $\omega$ 的概率可以看作投影算符 $\mathbb P_\omega$ 的平均值
    （满足 $\mathbb P_\omega^2 = \mathbb P_\omega$）
    \begin{equation}
    P(\omega) = \abs{\braket{\omega}{\psi}}^2 = \braket{\mathbb P_\omega \psi}{\mathbb P_\omega \psi} = \mel{\psi}{\mathbb P_\omega}{\psi}~,
    \end{equation}
    所以对于混合态， 测量值 $\omega$ 的概率为
    \begin{equation}
\overline{P(\omega)} = \opn{tr}(\mathbb P_\omega\rho)~.
\end{equation}

\item 在薛定谔绘景下，密度矩阵的演化方程为：

    $$\mathrm{i}\hbar \frac{\partial}{\partial t} \rho= \left[ H, \rho \right]~.$$
    特别的，若哈密顿量不含时，其为：
    $$\rho \left( t \right) = \exp\left(-\frac{\mathrm{i}Ht}{\hbar}\right) \rho \left(0\right) \exp\left(\frac{\mathrm{i}Ht}{\hbar}\right)~.$$
    密度矩阵厄米半正定的性质使得我们总是将它在一组正交完备基 $\ket{\psi_1},\ket{\psi_2},\cdots$ 下对角化：
    \begin{equation}
    \rho = \sum\limits_k p_k\ket{\psi_k} \bra{\psi_k}~.
    \end{equation}
    这表明系统处于 $\ket{\psi_k}$ 状态的概率为 $p_k$。

    考虑薛定谔方程:
    $$\mathrm{i}\hbar\frac{\partial}{\partial t} \ket{\psi} = H \ket{\psi}~.$$

    有：

    \begin{equation}\label{eq_denMat_4}
    \begin{aligned}
    \frac{\partial}{\partial t}\ket{\psi} &= -\frac{\mathrm{i}H}{\hbar}\ket{\psi}~, \\
    \frac{\partial}{\partial t}\bra{\psi} &= \frac{\mathrm{i}}{\hbar}\bra{\psi}H~.
    \end{aligned}~
    \end{equation}

    \autoref{eq_denMat_4} 中第二行为第一行取转置复共轭，则：
    \begin{equation}\label{eq_denMat_2}
    \begin{aligned}
    \frac{\partial}{\partial t}\rho &= \sum\limits_kp_k\frac{\partial}{\partial t}\left( \ketbra{\psi_k}{\psi_k} \right) \\
    &= \sum\limits_k p_k\left[ \left(\frac{\partial}{\partial t}\ket{\psi_k}\right)\bra{\psi_k} + \ket{\psi_k}\left(\frac{\partial}{\partial t}\bra{\psi_k}\right)\right] \\ 
    &= \sum\limits_k p_k \left( -\frac{\mathrm{i}}{\hbar}H\ketbra{\psi_k}{\psi_k} + \frac{\mathrm{i}}{\hbar}\ketbra{\psi_k}{\psi_k}H \right) \\
    &=-\frac{\mathrm{i}}{\hbar}\left(  H\rho -  \rho H\right) \\
    &= -\frac{\mathrm{i}}{\hbar}\left[ H, \rho \right]~.
    \end{aligned}~
    \end{equation}
    上式中$\left[ H, \rho \right] = H\rho -  \rho H$表示对易子，则整整理可得：
    \begin{equation}\label{eq_denMat_5}
    \mathrm{i}\hbar \frac{\partial}{\partial t} \rho= \left[ H, \rho \right]~.
    \end{equation}

    应当注意的是，此处推导是在薛定谔绘景中完成的，相互作用绘景中结果形式类似，而海森堡绘景中态不随时间变化，进而密度矩阵也不变。

    可以发现结果与海森堡运动方程的形式极为相似，但应注意到是其与海森堡运动方程相差一个负号。

    特别的，如果哈密顿量不含时，则可解得:
    $$\ket{\psi\left( t\right)} = \exp\left(-\frac{\mathrm{i}Ht}{\hbar}\right)\ket{\psi\left(0\right)}~.$$

    进而有：
    \begin{equation}\label{eq_denMat_6}
    \rho \left( t \right) = \exp\left(-\frac{\mathrm{i}Ht}{\hbar}\right) \rho \left(0\right) \exp\left(\frac{\mathrm{i}Ht}{\hbar}\right)~.
    \end{equation}
    
\item 期望值随时间变化的方程为：
    \begin{equation}
    \frac{\mathrm{d}}{\mathrm{d}t}\left\langle B \right\rangle = \left\langle \frac{\partial}{\partial t} B \right\rangle + \frac{1}{\mathrm{i}\hbar}\left\langle \left[ B, H \right]\right\rangle~.
    \end{equation}
    以下我们将要推导由密度矩阵计算得到的算符平均值随时间的变化的表达式与纯态的一样，都是海森堡运动方程的形式。
    
    \begin{equation}
    \begin{aligned}
    \frac{\mathrm{d}}{\mathrm{d}t}\left\langle B \right\rangle \left( t \right) &= \frac{\mathrm{d}}{\mathrm{d}t}\opn{tr}\left[\rho\left(t\right)B\right] \\
    &=\frac{\mathrm{d}}{\mathrm{d}t}\left[ \sum\limits_k \bra{u_k}\rho\left(t\right)B\ket{u_k}     \right] \\
    &= \sum\limits_k\bra{u_k}\left\{ \frac{\mathrm{d}}{\mathrm{d} t}\left[\rho \left(t\right)\right]B + \rho\left(t\right)\frac{\mathrm{d}}{\mathrm{d}t}\left( B\right) \right\}\ket{u_k}
    \end{aligned}~
    \end{equation}
    



\end{itemize}
\subsection{密度矩阵矩阵元}


回顾在基矢量$\left\{ \ket{u_n}\right\}$下，密度矩阵$\rho$的表达形式：
$$\rho = \sum\limits_k p_k\rho_k = \sum\limits_{m,n}\rho_{mn}\ket{u_m}\bra{u_n} ~,$$
上式中$\rho_k = \ket{\psi_k}\bra{\psi_k}$，$\rho_{m,n}$是密度矩阵的矩阵元。

\subsubsection{密度矩阵的对角元}

我们首先考虑对角元，即$\rho_{nn}$，显然有
$$\rho_{nn} = \sum\limits_{k} p_k \left[\rho_k\right]_{nn}~.$$
其中$\left[\rho_k\right]_{nn}$表示密度矩阵$\rho_k = \ket{\psi_k}\bra{\psi_k}$的第$n$个对角元。

假设：
$$\ket{\psi_k} = \sum\limits_n C_n^{k}\ket{u_n} = \sum\limits_n\ket{u_n}\braket{u_n}{\psi_k}~,$$
那么有：
$$\left[\rho_k\right]_{nn} = \left|\braket{u_n}{\psi_k}\right|^2 = \left| C_n^{k}\right|^2~.$$
则可以得到$\rho_{nn} = \sum\limits_k p_k \left|C_n^k\right|^2$，由此可以看到密度矩阵的对角元应当是一个非负实数。

现在考虑其物理意义，可以发现计算式中$\left| C_n^k \right|^2$表示的是量子态$\ket{\psi_k}$，在沿着基$\left\{\ket{u_n}\right\}$进行测量时，塌缩到$\ket{u_n}$的概率，经过经典概率$p_k$的叠加，$\rho_{nn}$表示的实际上是密度矩阵在沿着基$\left\{\ket{u_n}\right\}$测量时得到态$\ket{u_n}$的概率，因此我们称对角元$\rho_{nn}$为$\ket{u_n}$的\textbf{布局数}。

而且可以注意到，当且仅当所有$\psi_k$对应的$C_n^k$均为$0$时，$\rho_{nn} = 0$。

\subsubsection{密度矩阵的非对角元}

接下来我们讨论非对角元的情况，首先列出非对角元的计算式：
$$\rho_{pq} = \sum\limits_k p_k \braket{u_p}{\psi_k}\braket{\psi_k}{u_q} = \sum\limits_k p_k C_p^k \left(C_q^k\right)^*~.$$

注意到非对角元计算式中$C_p^k\left(C_q^k\right)^*$不再是模方，也就不一定为正实数，因此即使$C_p^k \left(C_q^k\right)^*$不全为$0$，$\rho_{pq}$也可能为$0$

考虑非对角项的物理意义，$C_p^k\left(C_q^k\right)^* = \braket{u_p}{\psi_k}\braket{\psi_k}{u_q}$当且仅当$\braket{u_p}{\psi_k}$和$\braket{u_q}{\psi_k}$均不为$0$的时候才非零，那么换句话说就是当且仅当$\ket{\psi_k}$中存在$\ket{u_p}$和$\ket{u_q}$的线性叠加时才非$0$。所以我们可以这样说：至少对于纯态，非对角元非零就意味着存在相干。反之也是一样，但对于混态则不同，我们举一个例子：

\begin{example}{}
考虑$\ket{+} = \frac{1}{\sqrt{2}}\left(\ket{\uparrow} + \ket{\downarrow}\right)$，$\ket{-} = \frac{1}{\sqrt{2}}\left(\ket{\uparrow} - \ket{\downarrow}\right)$。

可以看出$\ket{+}$和$\ket{-}$各自是存在相干的。同样我们写出其密度矩阵也可以看出其密度矩阵非对角元存在非$0$。
\begin{equation}
\rho_+ =  \frac{1}{2}\begin{pmatrix}
1&1 \\
1&1 \\
\end{pmatrix}~~~~,
\rho_- =  \frac{1}{2}\begin{pmatrix}
1&-1 \\
-1&1 \\
\end{pmatrix}~.
\end{equation}

但现在我们以各自$\frac{1}{2}$的概率混合起来，则有：
$$\rho = \frac{1}{2}\rho_+ + \frac{1}{2}\rho_- = \frac{1}{2}\begin{pmatrix}
1&0 \\
0&1 \\
\end{pmatrix}~.$$

可以看到其中非对角元的元素均为$0$。
\end{example}

对于这种情况，我们可以说两个态的相干性通过求取经典平均的这一过程抵消了。

但另一方面，如果非对角元非零，则一定意味着相干，因为非对角元非零代表着至少有一个$C_p^k\left(C_q^k\right)^*$非零，且并未因为经典平均抵消。因此我们称非对角元为\textbf{相干项}。

\subsubsection{矩阵元的演化}

前文中已经提到了不含时哈密顿量下密度矩阵对时间的演化\autoref{eq_denMat_6} ，我们由此讨论矩阵元的演化。选取哈密顿量的本征基$\left\{\ket{u_n}\right\}$作为密度矩阵的基：

\begin{equation}
\begin{aligned}
&H \ket{u_n} = E_n \ket{u_n}~, \\ 
&\rho\left( t \right)_{mn} = \bra{u_m} \rho\left( t \right) \ket{u_n}~.
\end{aligned}~
\end{equation}

则对于对角元：
\begin{equation}
\begin{aligned}
\rho\left( t \right)_{nn} &= \bra{u_n}\rho\left( t \right)\ket{u_n}\\
&= \bra{u_n}\exp\left(-\frac{\mathrm{i}}{\hbar}H t\right)\rho\left( 0 \right)\exp\left(\frac{\mathrm{i}}{\hbar}H t\right)\ket{u_n} \\
&=\bra{u_n}\exp\left(-\frac{\mathrm{i}}{\hbar}E_n t\right)  \rho\left( 0 \right)  \exp\left(\frac{\mathrm{i}}{\hbar}E_n t\right)  \ket{u_n} \\
&=\bra{u_n}\rho\left( 0 \right)\ket{u_n} \\
&=\rho\left( 0 \right)_{nn}~.
\end{aligned}~
\end{equation}

对于非对角元：

\begin{equation}
\begin{aligned}
\rho \left( t \right)_{pq} &= \bra{u_p}\rho\left(t\right)\ket{u_q} \\
&= \bra{u_p}\exp\left(-\frac{\mathrm{i}}{\hbar}H t\right)\rho\left(0\right)\exp\left(\frac{\mathrm{i}}{\hbar}H t\right)\ket{u_q} \\
&= \bra{u_p}\exp\left(-\frac{\mathrm{i}}{\hbar}E_p t\right)\rho\left( 0 \right)\exp\left(\frac{\mathrm{i}}{\hbar}E_q t\right)\ket{u_q} \\
&=\exp\left[-\frac{\mathrm{i}}{\hbar}\left(E_p-E_q\right) t\right]\bra{u_p}\rho\left( 0 \right)\ket{u_q} \\
&= \rho \left( 0 \right)_{pq}\exp\left[-\frac{\mathrm{i}}{\hbar}\left(E_p-E_q\right) t\right]~.
\end{aligned}~
\end{equation}

这说明了在能量表象下，\textbf{密度矩阵$\rho$的布局数不变，而相干项以体系的 Bohr 频率震荡}。






\subsection{统计系综与平衡态}
从\autoref{eq_denMat_5} 中可以看到，如果密度算符与哈密顿量 $H$ 对易，那么 $\rho(t)=\rho(0)$，密度算符不随时间发生变化，系综中每个状态发生的概率不变，根据\autoref{eq_denMat_3} ，各个物理量的系综平均值也是不变的。系统处于平衡态。

因此统计系综处于平衡态等价于 $[\rho,H]=0$。由于两个算符对易，它们实际上可以被同时对角化。存在一组基底 $\ket{1},\cdots,\ket{n}$，满足 $\rho \ket{i} = p_i \ket{i}$，且 $H\ket{i}=E_i \ket{i}$。也就是说密度矩阵在哈密顿量的一组正交的本征态基底下可对角化：
\begin{equation}
\rho = \sum_i p_i \ket{i}\bra{i},\quad H\ket{i}=E_i \ket{i}~.
\end{equation}


% Python 入门

到 2019 年， Python 已经成为最流行的语言， 无论是在科学计算还是在计算机领域都有大量的使用者． 本书中我们主要介绍 python 在科学计算中的应用．

如果不想安装软件可以直接使用用浏览器访问 \href{https://jupyter.org/}{Jupyter Notebook} 运行 Python 程序， 要在本地使用 Python 推荐安装 Anoconda． 以下我们用前者进行讲解． Jupyter Notebook 的优点是交互式编程， 即每输入一个命令都可以立即执行（快捷键 Shift + Enter）， 利于学习和实验．

\subsection{作为计算器}
请在 Jupyter Notebook 中尝试输入以下命令并执行（运行结果略）． Python 程序使用 \verb|#| 注释一行，  或者用两个 \verb|"""| 注释多行． 注释是为了辅助人阅读代码， 不会被机器执行．

四则运算
\begin{lstlisting}[language=python]
2 + 2
\end{lstlisting}
\begin{lstlisting}[language=python]
123 / 456
\end{lstlisting}
幂运算
\begin{lstlisting}[language=python]
3 ** 2
\end{lstlisting}
整数除法， 即相除再向下取整
\begin{lstlisting}[language=python]
4 // 3
\end{lstlisting}
求余
\begin{lstlisting}[language=python]
4 % 3 # 使得 a == a // b + a % b 恒成立
\end{lstlisting}
使用括号
\begin{lstlisting}[language=python]
(123 - 234*2)**2 / (34 + 54**4)
\end{lstlisting}
各种数学函数都在 math 模块中， 需要加载．
\begin{lstlisting}[language=python]
import math
\end{lstlisting}
使用模块中的函数， 要在前面加上模块名和一点． 例如开方 （square root）
\begin{lstlisting}[language=python]
math.sqrt(284)
\end{lstlisting}
自然指数函数
\begin{lstlisting}[language=python]
math.exp(5.1)
\end{lstlisting}
这样做虽然略显麻烦， 但可以区分不同模块中同名函数． 在确保没有冲突的情况下我们也可以用以下方法加载模块中的指定函数， 如
\begin{lstlisting}[language=python]
from math import sqrt, exp, sin, cos
\end{lstlisting}
现在使用这些函数就不需要 \verb|math.| 的前缀了
\begin{lstlisting}[language=python]
sin(1)
\end{lstlisting}
我们甚至可以用这种方式引入所有函数而无需前缀（但名称冲突的可能性更大， 不建议使用）
\begin{lstlisting}[language=python]
from math import *
\end{lstlisting}
从模块中不仅可以引入函数， 还有常数， 例如圆周率和自然对数底（注意 e 这种单字母名称很可能会产生冲突， 所以不建议取消 \verb|math.| 前缀）
\begin{lstlisting}[language=python]
sin(pi/2)
\end{lstlisting}
\begin{lstlisting}[language=python]
log(e)
\end{lstlisting}

math 模块中的其他常用函数如： 绝对值 （absolute value）
\begin{lstlisting}[language=python]
fabs(-32)
\end{lstlisting}
自然对数
\begin{lstlisting}[language=python]
log(0.5)
\end{lstlisting}
以 10 为底的对数
\begin{lstlisting}[language=python]
log10(1000)
\end{lstlisting}
弧度转为角度
\begin{lstlisting}[language=python]
degrees(pi/2)
\end{lstlisting}

\subsection{变量}
Python 中的\textbf{变量（variable）} 和数学上的不同， Python 的变量可以理解为一个储存数值的容器， 我们可以用等号把一个数值储存在一个变量中． 例如要计算一个长方体的面积， 我们直接把三个数字相乘， 也可以先把这三个数字赋值给三个\textbf{变量}然后相乘
\begin{lstlisting}[language=python]
a = 1
b = 2
c = 3
volumn = a*b*c
\end{lstlisting}
在 Jupyter Notebook 执行这四行发现并没有输出， 无论是一次性执行还是分开执行． 这是因为赋值命令默认不输出结果． 要强制输出结果可以用
\begin{lstlisting}[language=python]
print(volumn)
\end{lstlisting}
或者一次输出多个变量
\begin{lstlisting}[language=python]
print(a, b, c, volumn)
\end{lstlisting}
注意：在python2.x版本中，\textbf{print} 是一个关键字，输出内容不需要加括号，python 3.x中它是一个函数．例如
\begin{lstlisting}[language=python]
print volumn  #2.x
print(volumn) # 3.x
\end{lstlisting}
要强调的是， 这里的等号并不是数学上的等于， 而是\textbf{赋值}， 即把等号右边得到的数值储存在左边的变量中． 在第 4 行执行时， 计算机会先计算等号右边表达式的结果 6， 然后将 6 储存在变量 volumn 中． volumn 这个变量中并不会包含 “\verb|a*b*c|” 这个信息， 只储存 6 这个数值．

如果要让长方形的某个边长增加 1， 我们可以执行
\begin{lstlisting}[language=python]
a = a + 1
\end{lstlisting}
如果将等号理解为数学上的等于， 这个式子显然是错的． 但正确的理解是， 先把 \verb|a| 当前的值（1）加上 1 得到 2， 然后把 2 赋值给 \verb|a|． 由于我们没有给 \verb|volumn| 重新赋值， 它仍然是 6， 要更新 \verb|volumn|， 只需要重新执行
\begin{lstlisting}[language=python]
volumn = a*b*c
\end{lstlisting}
并用 \verb|print(volumn)| 显示新的值．

等效地， 我们也可以用自加运算， 将 \verb|a = a + 1| 记为
\begin{lstlisting}[language=python]
a += 1
\end{lstlisting}
其中 \verb|+=| 是一个整体的算符， 中间不能有空格． 类似的运算还有 \verb|-=|， \verb|*=|， \verb|/=| 等．

\subsection{函数}
Python 中的函数与数学中的函数不完全一样， 函数可以有若干个输入变量和输出变量（也可以没有）． 下面我们定义一个简单的函数来计算长方形的面积
\begin{lstlisting}[language=python]
def f(a, b, c):
    volumn = a*b*c
    return volumn
\end{lstlisting}
这段代码用到了两个 Python 的\textbf{关键字（keyword）} \verb|def| 和 \verb|return|． 关键字是指在程序中有特殊含义的， 不能作为变量名和函数名的名称． 其中 \verb|def| 用于定义函数， \verb|f| 是函数名， \verb|a|， \verb|b| 和 \verb|c| 分别是函数的\textbf{输入变量（argument）}． 冒号以后是\textbf{函数体}， 可以有若干行命令． 注意这些命令前面必须有\textbf{缩进（indentation）}．  在以上代码中， 函数体的第一行计算面积， 第二行将用关键字 \verb|return| 将计算的结果作为输出并退出函数．

现在我们可以使用这个函数， 使用方法和 \verb|sin|， \verb|sqrt| 等数学函数一样， 只是不同输入变量要用逗号隔开．
\begin{lstlisting}[language=python]
f(1.2, 3.4, 6)
\end{lstlisting}

\subsection{数组}
我们这里使用 \verb|numpy| 模块中的数组． \verb|numpy| 是数值计算中一个常用的模块， 主要用于处理各种数组（或矩阵）． \verb|numpy| 提供的是ndarray对象，即n维数组对象. 这里介绍另一种 import 的方式
\begin{lstlisting}[language=python]
import numpy as np
\end{lstlisting}
这相当于给 \verb|numpy.| 指定一个更简单的名字 \verb|np.|， 方便了使用． 你也可以把 \verb|np| 替换成其他名字． 上文使用 \verb|math| 模块时也可以使用
\begin{lstlisting}[language=python]
import numpy as m
\end{lstlisting}

要创建一个一维数组（或者叫做行矢量）， 如
\begin{lstlisting}[language=python]
a = np.array([1, 2, 3])
\end{lstlisting}
这个数组有三个元素， 每个元素相当于一个独立的变量． 要获取第 \verb|i| 个元素的值， 用 \verb|a[i]|， 如
\begin{lstlisting}[language=python]
a[0]
\end{lstlisting}
注意索引 \verb|i| 从 0 开始而不是 1． 所以第一个元素索引为 0， 第二个索引为 1 等等．

显示整个数组
\begin{lstlisting}[language=python]
print(a)
\end{lstlisting}
要获取数组的一部分
\begin{lstlisting}[language=python]
a[1:2]
\end{lstlisting}
注意：python对数组部分索引获取的时候，不会获取索引范围的最后一个索引值， 即上面这个语言只会得到a[1]的值2， 而没有a[2]的值．

要间隔一个步长获取数组的一部分

\begin{lstlisting}[language=python]
a = np.array([1,2,3,4,5,6,7,8])
a[1:6:2]
\end{lstlisting}
括号中的第三个参数表示步长，2表示隔一个元素取一个元素，上述代码取出a中第一个，第三个，第五个值， 返回结果为2,4,6.

创建一个二维数组，如
\begin{lstlisting}[language=python]
b = np.array([[1, 2, 3, 4],[4, 5, 6, 7], [7, 8, 9, 10]])
\end{lstlisting}
数组的大小可以通过其shape属性获得：
\begin{lstlisting}[language=python]
a.shape
b.shape
\end{lstlisting}
返回
\begin{lstlisting}[language=python]
(4,)
(3, 4)
\end{lstlisting}
注意到返回值都有一个小括号，说明返回值类型为一个元组类型． 数组a的shape只有一个元素，因此它是一维数组．而数组c的shape有两个元素，因此它是二维数组，其中第0轴的长度为3，第1轴的长度为4．


修改数组的shape属性，在保持数组元素个数不变的情况下，改变数组每个轴的长度．下面的例子将数组c的shape改为(4,3)，注意从(3,4)改为(4,3)并\textbf{不是对数组进行转置}，而只是改变每个轴的大小，数组元素在内存中的位置并没有改变：
\begin{lstlisting}
b.shape = 4,3
print(b)
\end{lstlisting}
返回
\begin{lstlisting}
array([[ 1, 2, 3],
[ 4, 4, 5],
[ 6, 7, 7],
[ 8, 9, 10]])
\end{lstlisting}
这种操作会永久的改变原数组的shape． 当某个轴的元素为-1时，将根据数组元素的个数自动计算此轴的长度，因此下面的程序将数组b的shape改为了(4,3)：
\begin{lstlisting}[language=python]
c.shape = 4，-1
\end{lstlisting}
另外，reshape方法，可以创建一个改变了尺寸的新数组，原数组的shape保持不变
\begin{lstlisting}[language=python]
d = b.reshape((4,3))
print(b)
print(d)
\end{lstlisting}
返回
\begin{lstlisting}[language=python]
array([[1, 2, 3, 4],
[4, 5, 6, 7],
[7, 8, 9, 10]])

array([[ 1, 2, 3],
[ 4, 4, 5],
[ 6, 7, 7],
[ 8, 9, 10]])
\end{lstlisting}
其实数组b和d其实共享数据存储内存区域，因此修改其中任意一个数组的元素也会同时修改另外一个数组
的内容，例如
\begin{lstlisting}[language=python]
b[0]=999
print(b)
print(d)
\end{lstlisting}
输出
\begin{lstlisting}[language=python]
array([[999, 2, 3, 4],
[4, 5, 6, 7],
[7, 8, 9, 10]])

array([[ 999, 2, 3],
[ 4, 4, 5],
[ 6, 7, 7],
[ 8, 9, 10]])
\end{lstlisting}


一些常用的创建数组的\verb|numpy|函数.

\begin{itemize}
\item \verb|arange|函数通过指定开始值、终值和步长来创建一维数组，注意数组不包括终值:
\begin{lstlisting}[language=python]
np.arange(0,10,1)
array([ 0,1, 2, 3, 4, 5, 6, 7, 8, 9])
\end{lstlisting}
\item \verb|linspace|函数通过指定开始值、终值和元素个数来创建一维数组，可以通过endpoint关键字指定是否包括终值，默认是包括终值:
 \begin{lstlisting}[language=python]
np.linspace(0,1,10)
array([0.        , 0.11111111, 0.22222222, 0.33333333, 0.44444444,
       0.55555556, 0.66666667, 0.77777778, 0.88888889, 1.        ])
 \end{lstlisting}
\item \verb|zeros| 创建全0数组
\begin{lstlisting}[language=python]
np.zeros(3)
array([0., 0., 0.])
np.zeros((3,5))
array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]])
\end{lstlisting} 
另外, \verb|ones|, \verb|eye|创建全1数组，对角元为1的数组，用法与\verb|zeros|类似．
\end{itemize}

矩阵的操作
\begin{lstlisting}[language=python]
A = [1, 2, 3]
B = [[2, 1, 4],[2, 2, 3],[1, 1, 3]]
C = [4, 5, 6]
\end{lstlisting}
\begin{enumerate}
\item 转置
\begin{lstlisting}[language=python]
np.transpose(B)
\end{lstlisting}
\item 拼接
\begin{lstlisting}[language=python]
D = np.concatenate((A,C)) # Concatenate vectors
print(D)
[1 2 3 4 5 6]
\end{lstlisting}
\item 左右或者上下翻转矩阵
\begin{lstlisting}[language=python]
D = np.flipud(A) 
print(D)
E = np.fliplr(B) 
print(E)
\end{lstlisting}
输出
\begin{lstlisting}[language=python]
[3 2 1]

array([[4, 1, 2],
       [3, 2, 2],
       [3, 1, 1]])
\end{lstlisting}
助记：up down  left  right [u  d l r].
\end{enumerate}


% 导数与差分
% 微积分|导数|差分

\pentry{泰勒展开\upref{Taylor}}

\subsection{一阶导数}
我们在导数的定义\upref{Der}中已经知道\footnote{以下假设 $f(x)$ 在某区间内处处可导．}
\begin{equation}\label{DerDif_eq1}
f'(x) = \lim_{h\to 0}\frac{f(x + h/2) - f(x - h/2)}{h}
\end{equation}
在一些应用（如数值计算）中， 我们只能把 $h$ 取一个很小的数值（如 $10^{-10}$）而并非无穷小， 这就需要我们估计用上式右边的\textbf{差分}来代替 $f'(x)$ 有多精确． 为了估算误差， 我们可以将 $f(x \pm h/2)$ 展开为关于 $h$ 的泰勒级数
\begin{equation}
f(x \pm h/2) = f(x) \pm f'(x)\frac h2 + \frac12 f''(x) \qty(\frac h2)^2 + \order{h^3}
\end{equation}
代入\autoref{DerDif_eq1} 得
\begin{equation}
\lim_{h\to 0} \frac{f'(x)h + \order{h^3}}{h} = f'(x) + \order{h^2}
\end{equation}
所以用差分代替一阶导数可以精确到 $h$ 的二阶无穷小 $\order{h^2}$．

\subsection{二阶导数}
能否用类似的方法来表示二阶导数呢？ 根据二阶导数的定义， 我们需要用双重极限来表示
\begin{equation}\ali{
f''(x) &= \lim_{l\to 0} \frac{f'(x+l/2) - f'(x - l/2)}{l}\\
&=  \lim_{l\to 0}\lim_{h\to 0} \frac{1}{lh} [f(x + l/2 + h/2)  - f(x + l/2 - h/2)\\
&\qquad\qquad - f(x - l/2 + h/2) + f(x - l/2 - h/2)]
}\end{equation}
但我们希望只用一个极限来表示二阶导数． 然而我们不确定 $h$ 是否需要是 $l$ 的高阶无穷小． 我们不妨来试试令 $l = h$， 即
\begin{equation}\label{DerDif_eq5}
f''(x) = \lim_{h\to 0} \frac{f(x + h) - 2f(x) +f(x-h)}{h^2}
\end{equation}
要验证该式成立与否， 将 $f(x \pm h)$ 关于 $h$ 做泰勒展开得
\begin{equation}
f(x \pm h) = f(x) \pm f'(x) h + \frac12 f''(x) h^2 \pm \frac16 f'''(x) h^3 + \order{h^4}
\end{equation}
代入\autoref{DerDif_eq5} 右边得
\begin{equation}
\lim_{h\to 0} \frac{f''(x)h^2 + \order{h^4}}{h^2} = f''(x) + \order{h^2}
\end{equation}
这就验证了\autoref{DerDif_eq5} 的正确性． 另外我们得知用差分来近似二阶导数 $f''(x)$ 同样是精确到二阶无穷小 $\order{h^2}$．

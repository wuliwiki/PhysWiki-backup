% 熵的微观定义与玻尔兹曼公式
% 玻尔兹曼公式|熵|统计力学
\pentry{热力学第二定律\upref{Td2Law}}

\subsection{玻尔兹曼熵公式} 
当我们讨论一个固定能量 $E$，体积 $V$，粒子数 $N$ 的一个\textbf{处于平衡态的孤立热力学系统} ，它的熵可以被系统的微观状态数来定义：
\begin{equation}
S(E,V,N) = k_B \ln \Omega(E,V,N)
\end{equation}
这被称为\textbf{玻尔兹曼公式}，被刻在了玻尔兹曼的墓碑上。其中 $\Omega$ 为总能量 $E$、体积 $V$、总粒子数 $N$ 的系统的微观状态数。在经典统计力学的理论体系中，$N$ 个粒子组成的系统的微观状态由 $6N$ 个自由度来描述（$3N$ 个空间自由度，$3N$ 个动量自由度），即相空间维度为 $6N$。
更严格地，它可以被表示为
\begin{equation}
\Omega(E,V,N)=\frac{\Omega_{\le}(E+\delta E,V,N)-\Omega_{\le}(E,V,N)}{\delta E}
\end{equation}
这里 $\Omega_{\le}(E,V,N)$ 被定义为相空间中能量小于等于 $E$ 的微观状态数。因此 $\Omega(E,V,N)$ 可以被理解为 $E$ 处的一个能壳的系统状态数除以能壳的厚度。微观状态数越大，系统的熵越大。

当我们讨论粒子之间不可分辨的\textbf{量子系统}，即粒子之间的交换对称性（全同粒子效应）。且此时我们通常需要考虑量子效应，不能简单地用相空间的坐标和动量来表示粒子或系统的状态。此时微观状态数则对应于系统的能级密度，即体积为 $V$，粒子数为 $N$ 的孤立系统在能量 $E$ 处的能级密度。因此对于有相互作用的复杂的量子系统，原则上我们也可以定义微观状态数并利用玻尔兹曼熵公式得到熵的表达式。
\subsection{熵与无序度}
玻尔兹曼熵的定义只依赖于三个参数 $E,V,N$，它代表特定能量、体积、粒子数的系统微观状态数。也就是说，在玻尔兹曼熵的定义中，所有可能的这些系统微观状态都被考虑了进去。但事实上我们可以对满足 $E,V,N$ 条件的这些系统微观状态进一步地划分。

例如对于近独立子系\upref{depsys}（粒子间近似无相互作用，可视为互相独立）而言，我们可以用不同能级单粒子态的占据数（也就是说 $N$ 个粒子在不同单粒子态上的分布）来对系统微观状态进行分类，计算新的微观状态数，以下是一种计算的例子：
\begin{example}{}
\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/6efe9e111eb22c3d.pdf}
\caption{给外地来的游客分配酒店房间} \label{fig_entro2_1}
\end{figure}
我们先来思考一个更直观的例子：如何给外地来的游客分配酒店房间？假设一共有$N$个游客前来度假（心照不宣的假设：每个人都是不一样的、且可区分的）；同时，酒店共有$l$层，第$l$层有$\omega_l$个房间，并且每个房间都可以容纳任意多的人。

我们先制定一个方案，订出各层的入住人数：第一层入住$a_1$人，第二层入住$a_2$人，...或写为 $\{a_1,a_2,...\}=\{a_l\}$。这个方案只订出了每层的人数，但没有订出具体是谁在哪间房间。

我们先从$N$位游客中选取$a_1$位游客住在第一层，有$C_N^{a_1}$种选法。于此同时，对于这$a_1$位游客，每位游客都可以随意入住本层的一间房间，由于本层有$\omega_1$间房可选，因此有${\omega_1}^{a_1}$种选法。现在，我们分配完了第一层，并产生了$$\Omega_1 = C_N^{a_1} {\omega_1}^{a_1}$$种更具体的入住方式。

别急，我们得继续分配第二层：由于已有$a_1$位游客入住了第一层，因此我们只能从剩余的$(N-a_1)$位游客中选取$a_2$位游客住在第二层，有$C_{N-a_1}^{a_2}$种选法。同时，对于这$a_2$位游客，每一位游客都可以随意选取本层的一间房间入住，因此有${\omega_2}^{a_2}$种入住方式...
$$\Omega_2 = C_{N-a_1}^{a_2} {\omega_2}^{a_2}$$

以此类推，总的入住方式是
$$
\begin{aligned}
\Omega &= C_N^{a_1} {\omega_1}^{a_1} C_{N-a_1}^{a_2} {\omega_2}^{a_2} C_{N-a_1-a_2}^{a_3} {\omega_3}^{a_3}...\\
&=C_N^{a_1} C_{N-a_1}^{a_2} C_{N-a_1-a_2}^{a_3} ... {\omega_1}^{a_1}{\omega_2}^{a_2}  {\omega_3}^{a_3}...\\
& = C_N^{a_1} C_{N-a_1}^{a_2} C_{N-a_1-a_2}^{a_3} ... \Pi_l{\omega_l}^{a_l}\\
\end{aligned}
$$
运用组合数的定义展开前半部分。
$$
\begin{aligned}
& C_N^{a_1} C_{N-a_1}^{a_2} C_{N-a_1-a_2}^{a_3} ...\\
&= \frac{N!}{a_1!(N-a_1)!} 
\frac{(N-a_1)!}{a_2!(N-a_1-a_2)!}
\frac{(N-a_1-a_2)!}{a_3!(N-a_1-a_2-a_3)!}
...\\
&=\frac{N!}{a_1!a_2!a_3!...} \\
&=\frac{N!}{\Pi_l a_l!} \\
\end{aligned}
$$
代回原式，得
$$
\Omega = \frac{N!}{\Pi_l a_l!}  \Pi_l{\omega_l}^{a_l}
$$
这就是给定每层人数$\{a_l\}$的情况下，具体的入住方式的个数。我们惊奇地发现，这个结论形式上与玻尔兹曼分布中的微观态个数完全相同！

在这个比喻中，
\begin{itemize}
\item 游客总数$N$代表粒子总数，
\item 酒店的楼层代表能级，
\item 每层的房间数$\omega_l$代表每个能级的简并态个数，
\item 每层的入住人数$a_l$代表该能级上的粒子个数，
\item 制定每层人数的方案$\{a_l\}$代表一种分布，
\item 每一种具体的入住方式代表这种分布下的一种微观态，
\item 入住方式的总数$\Omega$就是这种分布下的微观态总个数。
\end{itemize}
\end{example}
从这个例子中我们可以看出，有一些分布所对应的微观状态数少，另一些分布所对应的微观状态数多，
\subsection{平衡态系统与最概然分布}
\pentry{热力学第二定律\upref{Td2Law}}
热力学第二定律告诉我们\textbf{绝热或孤立系统的熵永不减少}，这也告诉了我们孤立系统处于平衡态的熵判据\footnote{参考热动平衡判据\upref{equcri} 词条。}，即孤立系统处于平衡态当且仅当它的熵处于极大值。

那么如果将此处的经典热力学体系中的熵（有时候也称它为宏观熵，因为熵的宏观定义\upref{Entrop}不涉及系统的微观性质）与玻尔兹曼公式给出的微观熵相联系起来，那么就可以得到平衡态系统所需满足的微观状态数的条件了。在下一节我们会证明，在热力学极限下，宏观熵等于微观熵，那么系统处于平衡态时我们可以认为系统的状态处于\textbf{最概然分布}，即微观状态数最大的状态。

因此，在热力学极限（$N\rightarrow \infty$）下，既然一个平衡态孤立系统的熵处于极大值，利用玻尔兹曼熵公式我们可以证明它所对应的\textbf{微观状态数一定是最大的}，且在热力学极限下，最概然分布的微观状态数一定是远大于其他系统状态的微观状态数的。也就是说，我们只需要分析系统的最概然分布，就可以得到平衡态的统计力学性质了。一个例子是词条玻尔兹曼分布（统计力学）\upref{MBsta}中\autoref{eq_MBsta_9}~\upref{MBsta}和\autoref{eq_MBsta_10}~\upref{MBsta}给出了从\textbf{最概然分布}出发得到了近独立经典系统、玻色系统和费米系统的麦克斯韦玻尔兹曼分布、玻色分布与费米分布公式。

\subsection{宏观熵与微观熵的等价性}
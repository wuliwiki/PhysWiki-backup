% 椭圆的四种定义
% 极坐标系|直角坐标系|圆锥曲线|椭圆

\pentry{圆锥曲线的极坐标方程\upref{Cone}}

我们已经知道用焦点和准线如何定义椭圆\upref{Cone}， 下面介绍另外三种． 其中 “圆锥截面定义” 揭示了 “圆锥曲线” 一词的由来．

\subsection{椭圆的直角坐标方程定义}
从椭圆的极坐标公式难以看出椭圆的对称性， 另一种定义椭圆的方法是直接在直角坐标系中给出椭圆的方程
\begin{equation}\label{Elips3_eq3}
\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1
\end{equation}

我们这里用焦点和准线的定义来推导出上式， 以证明它们等价． 我们不妨先以一个焦点为原点定义直角坐标系， 且令 $x$ 轴指向另一个焦点， 则有
\begin{equation}
r = \sqrt{x^2 + y^2} \qquad \cos\theta = \frac{x}{\sqrt{x^2 + y^2}}
\end{equation}
代入椭圆的极坐标方程\autoref{Cone_eq5}~\upref{Cone} 得
\begin{equation}
\sqrt{x^2 + y^2} = p + ex
\end{equation}
两边平方并整理得
\begin{equation}\label{Elips3_eq2}
(1 - e^2) \qty( x - \frac{ep}{1 - e^2} )^2 + y^2 = \frac{p^2}{1 - e^2}
\end{equation}
由此可见，如果我们把椭圆左移 $ep/(1 - e^2)$，椭圆将具有\autoref{Elips3_eq3} 的形式． 其中 $a$ 为\textbf{半长轴}， $b$ 为\textbf{半短轴}．这就是椭圆的第二种定义， 即把单位圆沿两个垂直方向分别均匀拉长 $a$ 和 $b$． 所以也可以表示为参数方程
\begin{equation}\label{Elips3_eq1}
\leftgroup{
&x(t) = a\cos t\\
&y(t) = b\sin t
} \qquad
(a > b > 0)
\end{equation}

下面来看系数的关系．首先定义椭圆的焦距为焦点到椭圆中心的距离（即以上左移的距离）为
\begin{equation}\label{Elips3_eq5}
c = \frac{ep}{1 - e^2}
\end{equation}
\autoref{Elips3_eq2} 和\autoref{Elips3_eq3} 对比系数得
\begin{equation}\label{Elips3_eq6}
a = \frac{p}{1 - e^2} \qquad b = \frac{p}{\sqrt {1 - e^2} }
\end{equation}
以上两式可以将椭圆的极坐标方程转为直角坐标方程． 另外易证
\begin{equation}\label{Elips3_eq7}
a^2 = b^2 + c^2
\end{equation}
若要从直角坐标方程变回极坐标方程， 将\autoref{Elips3_eq5} \autoref{Elips3_eq6} 逆转得
\begin{equation}\label{Elips3_eq8}
e = \frac{c}{a}\qquad
p = \frac{b^2}{a}
\end{equation}

\subsection{第三种定义}
椭圆的第三种定义是， 椭圆上任意一点到两焦点的距离之和等于 $2a$． 现在我们来证明前两种定义下的椭圆满足这个条件． 由直角坐标方程可知对称性，可在椭圆的两边做两条准线，令椭圆上任意一点到两焦点的距离分别为 $r_1$ 和 $r_2$，到两准线的距离分别为 $d_1$ 和 $d_2$，则有
\begin{equation}
e = \frac{r_1}{d_1} = \frac{r_2}{d_2} = \frac{r_1 + r_2}{d_1 + d_2}
\end{equation}
所以
\begin{equation}\label{Elips3_eq9}
r_1 + r_2 = e(d_1+d_2) = 2e(c + h) = 2\frac{c}{a} \qty( c + \frac{b^2}{c} ) = 2a
\end{equation}
证毕．

\subsection{圆锥截面定义}
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/Elips3_1.png}
\caption{圆锥的有限截面是一个椭圆}} \label{Elips3_fig1}
\end{figure}

在直角坐标系 $x$-$y$-$z$ 中， 为了方便我们使用顶角为 $\pi/2$ 的圆锥
\begin{equation}\label{Elips3_eq4}
z_1^2 = x_1^2 + y_1^2
\end{equation}
对其他顶角的圆锥， 我们只需要把 $z$ 轴拉伸一下即可．

我们可以再列出一个斜面方程得到方程组， 但这样解出来的椭圆将与 $x$-$y$ 平面不平行． 所以更好的办法是把圆锥旋转一下， 再用某个方程为 $z = z_0$ 的平面去截出椭圆． 关于 $y$ 轴做旋转变换\upref{Rot2DT}
\begin{equation}
\pmat{x_1\\z_1} = \pmat{\cos\theta & \sin\theta\\ \sin\theta & -\cos\theta}\pmat{x\\z}
\end{equation}
\begin{equation}
y_1 = y
\end{equation}
代入\autoref{Elips3_eq4} 得
\begin{equation}
(\sin\theta\cdot x - \cos\theta\cdot z)^2 = (\cos\theta\cdot x + \sin\theta\cdot z)^2 + y^2
\end{equation}
化成标准形式为
\begin{equation}
\frac{(x + \tan2\theta \cdot z)^2}{(z/\cos2\theta)^2} + \frac{y^2}{z^2/\cos2\theta} = 1
\end{equation}
离心率为 $\sqrt{2}\sin\theta$， 可见 $\theta \to \pi/4$ 的极限情况下， 离心率等于 $1$， 椭圆趋近于抛物线． 当 $\theta > \pi/4$ 时， 式中 $\cos2\theta < 0$， 上式变为双曲线方程．

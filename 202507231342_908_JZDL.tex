% 介值定理（综述）
% license CCBYSA3
% type Wiki

本文根据 CC-BY-SA 协议转载翻译自维基百科\href{https://en.wikipedia.org/wiki/Intermediate_value_theorem}{相关文章}。

\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/17b13a0f3803ea4f.png}
\caption{} \label{fig_JZDL_1}
\end{figure}
在数学分析中，中值定理指出：如果函数 $f$ 是一个连续函数，且其定义域包含区间 $[a, b]$，那么对于任意介于 $f(a)$ 与 $f(b)$ 之间的值，函数 $f$ 在该区间内至少有一个点取到这个值。

该定理有两个重要的推论：
\begin{enumerate}
\item 如果一个连续函数在某个区间内的两个端点处函数值符号相反，那么它在这个区间内至少有一个零点（即有解）——这被称为波尔查诺定理\(^\text{[1][2]}\)。
\item 一个连续函数在一个区间上的值域本身也是一个区间。
\end{enumerate}
\subsection{动机}
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/277ed962e4079ea4.png}
\caption{介值定理} \label{fig_JZDL_2}
\end{figure}
这揭示了实数上连续函数的一个直观性质：设 $f$ 是定义在区间 $[1, 2]$ 上的连续函数，且已知 $f(1) = 3$、$f(2) = 5$，那么函数图像 $y = f(x)$ 在 $x$ 从 1 变到 2 的过程中，必定会穿过水平直线 $y = 4$。这表达了一个概念：在闭区间上的连续函数的图像可以不抬笔地画出来。
\subsection{定理}
介值定理表述如下：

设实数集合 $\mathbb{R}$ 上的闭区间 $I = [a, b]$，函数 $f: I \to \mathbb{R}$ 连续，则有：

\begin{itemize}
\item 版本一：如果某个数 $u$ 介于 $f(a)$ 和 $f(b)$ 之间，即
$$
\min(f(a), f(b)) < u < \max(f(a), f(b)),~
$$
那么存在某个点 $c \in (a, b)$，使得$f(c) = u$.
\item 版本二：函数值的集合 $f(I)$ 也是一个闭区间，且包含区间
$$
[\min(f(a), f(b)), \max(f(a), f(b))].~
$$
\end{itemize}
备注：版本二说明函数值的集合中不存在间断。对于任意两个函数值 $c, d \in f(I)$，若 $c < d$，则所有处于区间 $[c, d]$ 中的数也都是函数值，即
$$
[c, d] \subseteq f(I).~
$$
在实数集合中，没有内部间隙的子集就是一个区间。版本一是版本二的一个特殊情况。
\subsection{与完备性的关系}
介值定理依赖于实数的完备性，并且与之等价。该定理不适用于有理数集 $\mathbb{Q}$，因为有理数之间存在“空隙”；这些空隙正是由无理数填补的。

例如，函数$f(x) = x^2$在有理数域 $x \in \mathbb{Q}$ 上满足$f(0) = 0, \quad f(2) = 4$但不存在一个有理数 $x$，使得$f(x) = 2$因为 $\sqrt{2}$ 是一个无理数。

尽管如此，在实闭域上，仍然存在一种适用于多项式的介值定理形式，可参见魏尔斯特拉斯零点定理。
\subsection{证明}
\subsubsection{证明版本 A}
该定理可以作为实数完备性的一个推论来证明，如下所示：\(^\text{[3]}\)

我们将证明第一种情况：$f(a) < u < f(b)$第二种情况的证明是类似的。

设
$$
S = \{x \in [a, b] \mid f(x) < u\}~
$$
由于 $f(a) < u$，所以 $a \in S$，因此 $S$ 非空。又因为 $S \subseteq [a, b]$，所以它有上界 $b$。根据实数的完备性，集合 $S$ 的上确界$c = \sup S$
存在。也就是说，$c$ 是大于或等于 $S$ 中所有元素的最小实数。

注意，由于 $f$ 在 $a$ 处连续，我们可以通过让 $x$ 足够接近 $a$，使得 $f(x)$ 与 $f(a)$ 的差小于任意指定的 $\varepsilon > 0$。既然 $f(a) < u$ 是一个严格不等式，我们可以取
$$
\varepsilon = u - f(a) > 0~
$$
根据连续性的定义，存在 $\delta > 0$，使得对所有 $x \in [a, b]$，只要
$$
|x - a| < \delta~
$$
就有
$$
|f(x) - f(a)| < u - f(a) \Rightarrow f(x) < u~
$$
考虑区间
$$
I_1 = [a, \min(a + \delta, b))~
$$
注意到 $I_1 \subseteq [a, b]$，并且对所有 $x \in I_1$，都有 $|x - a| < \delta$，因此 $f(x) < u$。这说明在 $a$ 附近存在比 $a$ 更大的属于 $S$ 的点，所以 $c \ne a$。

同理，由于函数 $f$ 在点 $b$ 处是连续的，我们可以通过令 $x$ 足够接近 $b$，使 $f(x)$ 与 $f(b)$ 的差小于任意给定的 $\varepsilon > 0$。由于 $u < f(b)$ 是一个严格不等式，当我们取 $\varepsilon$ 为 $u$ 与 $f(b)$ 之间的距离时，可以得出类似的推论：所有足够接近 $b$ 的 $x$，都有 $f(x) > u$，这说明存在小于 $b$ 的一些数是集合 $S$ 的上界。更详细的证明如下：

取 $\varepsilon = f(b) - u > 0$，那么存在 $\delta > 0$，使得对所有 $x \in [a, b]$，若 $|x - b| < \delta$，则
$$
|f(x) - f(b)| < f(b) - u \Rightarrow f(x) > u~
$$

考虑区间：
$$
I_2 = (\max(a, b - \delta), b]~
$$
注意到 $I_2 \subseteq [a, b]$，并且其中每个 $x \in I_2$ 都满足 $|x - b| < \delta$，所以对于所有 $x \in I_2$，都有 $f(x) > u$。因此 $c \neq b$。
由于 $c \neq a$ 且 $c \neq b$，我们有 $c \in (a, b)$。现在我们要证明：
$$
f(c) = u~
$$
固定任意 $\varepsilon > 0$。由于 $f$ 在 $c$ 处连续，存在 $\delta_1 > 0$，使得对所有 $x \in [a, b]$，若 $|x - c| < \delta_1$，则：
$$
|f(x) - f(c)| < \varepsilon~
$$
又因为 $c \in (a, b)$，而开区间 $(a, b)$ 是开集，存在 $\delta_2 > 0$，使得：
$$
(c - \delta_2, c + \delta_2) \subseteq (a, b)~
$$
令 $\delta = \min(\delta_1, \delta_2)$，那么对于所有 $x \in (c - \delta, c + \delta)$，有：
$$
f(x) - \varepsilon < f(c) < f(x) + \varepsilon~
$$
根据上确界的性质，存在 $a^* \in (c - \delta, c] \subseteq S$，因此：
$$
f(c) < f(a^*) + \varepsilon < u + \varepsilon~
$$
再取 $a^{**} \in (c, c + \delta)$，因为 $c = \sup S$，所以 $a^{**} \notin S$，这意味着：
$$
f(c) > f(a^{**}) - \varepsilon \geq u - \varepsilon~
$$
综上，两个不等式成立：
$$
u - \varepsilon < f(c) < u + \varepsilon~
$$
对于所有 $\varepsilon > 0$ 都成立。因此我们推得：$f(c) = u$这是唯一可能的取值，正如定理所述。
\subsubsection{证明 B 版本}
我们只证明 $f(a) < u < f(b)$ 的情形，另一种 $f(a) > u > f(b)$ 的情形类似\(^\text{[4]}\)。

定义函数 $g(x) = f(x) - u$，即 $f(x) = g(x) + u$。这样，原本的 $f(a) < u < f(b)$ 可以重写为 $g(a) < 0 < g(b)$，我们需要证明存在某个 $c \in [a, b]$，使得 $g(c) = 0$，这在直观上更容易理解。

进一步定义集合：

$$
S = \{x \in [a, b] : g(x) \leq 0\}~
$$

因为 $g(a) < 0$，所以 $a \in S$，即 $S$ 非空。此外，由于 $S \subseteq [a, b]$，它有上界，因此根据实数的完备性，最小上界$c = \sup(S)$存在。

接下来我们讨论 $g(c)$ 的三个可能取值：$g(c) < 0$、$g(c) > 0$ 和 $g(c) = 0$。

假设反证法一： 假设 $g(c) < 0$。根据连续性的定义，令 $\varepsilon = 0 - g(c) > 0$，存在 $\delta > 0$，使得：
$$
x \in (c - \delta, c + \delta) \Rightarrow |g(x) - g(c)| < -g(c) \Rightarrow g(x) < 0~
$$
取 $x = c + \delta/N$，其中 $N > \frac{\delta}{b - c} + 1$，由于 $1 < N$，有 $x < c + \delta$，从而：
$$
g(x) < 0,\quad c < x < b \Rightarrow x \in S~
$$
这说明 $x$ 是 $S$ 的一个上界，但 $x > c$，这与 $c$ 是最小上界矛盾。因此，$g(c) \geq 0$。

假设反证法二：假设 $g(c) > 0$。令 $\varepsilon = g(c) - 0 > 0$，存在 $\delta > 0$，使得：
$$
x \in (c - \delta, c + \delta) \Rightarrow |g(x) - g(c)| < g(c)~
$$
即：
$$
-g(c) < g(x) - g(c) < g(c) \Rightarrow g(x) > 0~
$$
若取 $x = c - \delta/2$，则有 $g(x) > 0$ 且 $a < x < c$，即 $x$ 是 $S$ 的一个上界，但 $x < c$，这又与 $c$ 是最小上界矛盾。因此，$g(c) > 0$ 不成立。
综上两种假设均被排除，唯一可能的情况是：
$$
g(c) = 0 \Rightarrow f(c) = u~
$$
备注：介值定理也可以使用非标准分析的方法来证明，非标准分析将涉及无穷小量的“直观”论证建立在严格的数学基础之上\(^\text{[5]}\)。
\subsection{历史}
该定理的某种形式早在公元前5世纪就已被提出，当时赫拉克利亚的布律松在研究化圆为方问题时使用了类似的思路。布律松认为，既然存在比一个给定正方形大的圆和比它小的圆，那么必然存在一个与该正方形面积相等的圆\(^\text{[6]}\)。这个定理首次被贝尔纳·玻尔查诺于1817年严格证明。玻尔查诺采用了如下形式的表述\(^\text{[7]}\)：

设函数 $f$、$\varphi$ 在区间 $[\alpha, \beta]$ 上连续，且满足：$f(\alpha) < \varphi(\alpha), \quad f(\beta) > \varphi(\beta)$那么存在某个 $x \in (\alpha, \beta)$，使得：$f(x) = \varphi(x)$将 $\varphi$ 取为适当的常值函数，可以看出上述表述与现代的介值定理是等价的。

奥古斯丁-路易·柯西于1821年给出了现代表述及其证明\(^\text{[8]}\)。两人都受到约瑟夫-路易·拉格朗日致力于形式化函数分析的思想启发。

认为连续函数具有介值性质这一思想更早可以追溯。西蒙·斯特文曾经对多项式函数（例如三次函数）证明了介值定理，他的方法是通过一个构造十进制解的算法：该算法将区间等分为10份，每次迭代产生一个新的小数位\(^\text{[9]}\)。

在“连续性”这一概念被正式定义之前，介值性质曾被直接作为“连续函数”的定义条件之一。例如，路易·阿尔博加斯特就将连续函数定义为：没有跳跃、满足介值性质，并且增量的大小与自变量的增量成比例\(^\text{[10]}\)。

更早期的作者普遍认为该结论是直观显然的，不需要证明。玻尔查诺和柯西的洞察在于：他们首次给出了通用的连续性定义（玻尔查诺基于实数的不等式，柯西基于无穷小），并据此提供了严格的证明。
\subsection{反命题不成立}
达布函数是指具有“介值性质”的实值函数，即满足介值定理结论的函数：对于定义域中任意两个值 $a$ 和 $b$，以及介于 $f(a)$ 与 $f(b)$ 之间的任意数 $y$，总存在某个 $c \in (a, b)$ 使得 $f(c) = y$。

介值定理断言：每个连续函数都是达布函数。但并非每个达布函数都是连续函数，也就是说，介值定理的逆命题是不成立的。

举个例子，定义函数：
$$
f : [0, \infty) \to [-1, 1], \quad f(x) = \begin{cases}
\sin(1/x), & x > 0 \\
0, & x = 0
\end{cases}~
$$
这个函数在 $x = 0$ 处不连续，因为 $\lim_{x \to 0} f(x)$ 并不存在；但它仍然具有介值性质。另一个更复杂的例子是康威的13进制函数。

事实上，达布定理指出：所有某个函数在某区间上的导函数，都具有介值性质——即便它们不一定连续。

从历史上看，这种介值性质曾被一些数学家提议作为实值函数连续性的定义标准之一\(^\text{[11]}\)；但这一定义最终未被采纳。
\subsection{推广形式}

#### 多维空间

\*\*庞加莱–米兰达定理（Poincaré–Miranda Theorem）\*\*是介值定理从一维区间向二维矩形（更一般地，**n维立方体**）的一个推广。

**Vrahatis** 提出了一种类似的推广方式，从三角形推广到更一般的 **n维单纯形（n-dimensional simplex）**。设 $D_n$ 是一个 n 维单纯形，拥有 $n+1$ 个顶点，记作 $v_0, v_1, \dots, v_n$。令 $F = (f_1, f_2, \dots, f_n)$ 是一个从 $D_n$ 到 $\mathbb{R}^n$ 的**连续函数**，并且在 $D_n$ 的边界上永远不取零值。假设 $F$ 满足以下条件：

* 对于所有 $i \in \{1, \dots, n\}$，函数 $f_i(v_i)$ 的符号与 $f_i(x)$ 在与顶点 $v_i$ 相对的那一面上的所有点 $x$ 的符号**相反**；
* 向量 $(f_1, \dots, f_n)$ 在顶点 $v_0$ 处的**符号向量**不同于它在与 $v_0$ 相对的那一面上所有点的符号向量。

那么，存在某个点 $z$ 位于 $D_n$ 的**内部**，使得：

$$
F(z) = (0, 0, \dots, 0)
$$

---

可以通过对 $f_i$ 做**标准化**，使得每个 $f_i(v_i) > 0$，从而使条件变得更简单：

* 对于所有 $i \in \{1, \dots, n\}$，有 $f_i(v_i) > 0$，并且 $f_i(x) < 0$ 对所有位于与 $v_i$ 相对那一面的点 $x$ 成立。特别地，有 $f_i(v_0) < 0$。
* 对所有在与 $v_0$ 相对的面上的点 $x$，至少存在一个 $i \in \{1, \dots, n\}$ 使得 $f_i(x) > 0$。

---

该定理可以通过 **Knaster–Kuratowski–Mazurkiewicz 引理** 来证明，常被用于**不动点**和**零点的数值近似计算**【13】。

---

如需补充图示、公式或中英对照形式，也可以告诉我。

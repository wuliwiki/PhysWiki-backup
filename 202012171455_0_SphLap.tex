% 球坐标系中的拉普拉斯方程
% 球坐标系|拉普拉斯方程|连带勒让德方程|球谐函数

\pentry{球坐标系中的拉普拉斯算符\upref{SphNab}}

拉普拉斯方程为
\begin{equation}
\laplacian f = 0
\end{equation}
球坐标系中， 可以将拉普拉斯算子分解为径向和角向两部分（\autoref{SphNab_eq3}~\upref{SphNab}）
\begin{equation}
\laplacian = \laplacian_r + \frac{\laplacian_{\Omega}}{r^2} = \frac{1}{r^2} \pdv{r} \qty(r^2 \pdv{u}{r}) + \frac{1}{r^2\sin\theta}\pdv{\theta} \qty(\sin \theta \pdv{u}{\theta}) + \frac{1}{r^2\sin^2 \theta} \pdv[2]{u}{\phi}
\end{equation}
则 可以记为
\begin{equation}
\qty(r^2\laplacian_r - \laplacian_\Omega) f = 0
\end{equation}
注意第一项只含有 $r$ 的偏导， 第二项只含有 $\theta,\phi$ 的偏导． 用分离变量法， 令 $f(\bvec r) = R(r) Y(\uvec r)$， 则分离后的\textbf{径向方程}和\textbf{角向方程}分别为
\begin{equation}
r^2\laplacian_r R(r) = l(l+1)R(r)
\end{equation}
\begin{equation}
\laplacian_{\Omega} Y(\uvec r) = -l(l+1) Y(\uvec r)
\end{equation}
角向方程还可以进一步分离变量， 令 $Y(\theta,\phi) = \Theta(\theta)\Phi(\phi)$
\begin{equation}\label{SphLap_eq3}
l(l+1) + \left. \frac{1}{\sin\theta}\pdv{\theta} \qty(\sin \theta \pdv{\Theta}{\theta}) \middle/ \Theta + \frac{1}{\sin^2 \theta} \qty(\pdv[2]{\Phi}{\phi}) \middle/ \Phi = 0 \right.
\end{equation}
两边同时乘以 $\sin^2\theta$， 得到前二项只含 $\theta$， 第三项只含 $\phi$． 一般令前两项之和为常数 $m^2$， 则第三项为 $-m^2$． 这样我们就成功分离出了三个常微分方程， 下面分别介绍．

径向方程是欧拉型方程% 链接未完成
\begin{equation}
r^2\dv[2]{f}{r} + 2r\dv{f}{r} - l(l+1)f = 0
\end{equation}
使用变量代换 $t = \ln r$ 解得
\begin{equation}
f(r) = C_1 r^l + \frac{C_2}{r^{l+1}}
\end{equation}

关于 $\theta$ 的方程是
\begin{equation}
\sin^2\theta \dv[2]{g}{\theta} + \sin\theta\cos\theta\dv{g}{\theta} + [l(l+1)\sin^2\theta - m^2] g = 0
\end{equation}
使用变量代换 $x = \cos\theta$ 得
\begin{equation}
(1-x^2)\dv[2]{g}{x} - 2x\dv{g}{x} + \qty[l(l+1) - \frac{m^2}{1-x^2}]g = 0
\end{equation}
或
\begin{equation}
\dv{x} \qty[(1-x^2)\dv{g}{x}] + \qty[l(l+1) - \frac{m^2}{1-x^2}]g = 0
\end{equation}
该式被称为\textbf{连带勒让德方程}\upref{AsLgdr}， 解为连带勒让德多项式 $P_l^m(x) = P_l^m(\cos\theta)$．

关于 $\phi$ 的方程是
\begin{equation}
\dv[2]{h}{\phi} = -m^2 h
\end{equation}
该方程的解为 $\E^{\I m\phi}$． 原则上 $m$ 可以取任意实数， 但由于球坐标中的\textbf{循环边界条件}要求 $h(\phi + 2\pi) = h(\phi)$， $m$ 只能取任意整数．

综上， 球坐标中拉普拉斯方程的通解为
\begin{equation}
u(r, \theta, \phi) = \sum_{l = 0}^\infty \sum_{m = -l}^l \qty(C_{l,m} r^l + \frac{C'_{l,m}}{r^{l+1}})P_l^m(\cos\theta)\E^{\I m\phi}
\end{equation}
我们一般把在单位球面上归一化的 $g(\theta)h(\phi)$ 称为\textbf{球谐函数}\upref{SphHar}， 记为 $Y_l^m(\theta,\phi)$ （满足角向方程\autoref{SphLap_eq3}）， 则通解也可记为\footnote{以后为了方便， 我们常在求和符号中省略 $l, m$ 的范围．}
\begin{equation}
u(r, \theta, \phi) = \sum_{l,m} \qty(A_{l,m} r^l + \frac{B_{l,m}}{r^{l+1}}) Y_l^m (\theta, \phi)
\end{equation}

% Quaternion and Rotation



\subsection{The History of Quaternions}

It is known that a complex numbers can be defined as odered pairs of real numbers, or the field extension of $\mathbb{R}$ by adding the new element $\I$. 

Complex numbers are broadly applied, because they have almost perfect algebraic and analytic properties, making many difficult calculations simple or even possible. John Derbyshire addressed in his book \textsl{Unknown Quantity: Real and Imaginary History of Algebra} that "If passing from the real numbers, which are merely onedimensional, to the complex numbers, which are two-dimensional, gives us such a huge increase in power and insight, why stop there? Might there not be other kinds of numbers waiting to be discovered-hyper-complex numbers, so to speak—whose natural representation is three-dimensional? And might those numbers not bring with them a vast new increase in our mathematical understanding?"\footnote{John Derbyshire, \textsl{Unknown Quantity: A Real and Imaginary History of Algebra}, 2006, Joseph Henry Press, Ch. 8, pp. 148. }

The Irish mathematician from the early 19th century, William Hamilton, was in search of three-dimensional numbers with a well-defined multiplication, hopefully corresponding to the three dimensional coordinates. However, he exerted years of efforts, and still couldn't find a multiplication on the ordered triple of real numbers that satisfies associativity and distributivity. The fact is, there is no such three dimensional algebra, but Hamilton didn't know at that time. 


The day was October 16, 1843, when Hamilton was walking to the Council of the Royal Irish Academy with his wife, "a spark flashed forth the herald of many long years to come of definitely directed thought and work", he realized what he should have been chasing after. He couldn't "resist the impulse—unphilosophical as it may have been—to cut with a knife on a stone of Brougham Bridge" the fundamental formula with the symbols $\I, \mathrm{J}, \mathrm{K}$:

\begin{equation}
\I^2=\mathrm{j}^2=\mathrm{k}^2=\I\mathrm{j}\mathrm{k}=-1
\end{equation}
which "contains the Solution of the Problem, but, of course, the inscription
has long since mouldered away."\footnote{Derbyshire, pp. 151. }

\subsection{The Definition of Quaternions}

The modern version of the definition takes each quaternion as a combinition of one real number and one three-dimensional real vector: $(a_0, \bvec{a})$. In such a context, $\I$, $\mathrm{j}$, $\mathrm{k}$ are interpreted as vectors that forms an orthonormal basis. To avoid potential confusions, we rephrase the three base vectors as $\uvec i, \uvec j$ 和 $\uvec k$, and define the operation of quaternions as follows: 



\begin{definition}{The Arithmetic of Quaternions}
Let $\mathbb{H}=\{(a_0, \bvec{a})|a_0\in\mathbb{R}, \bvec{a}\in\mathbb{R}^3\}$be the set of quaternions. For $\forall(a_0, \bvec{a}), (b_0, \bvec{b})\in\mathbb{H}$, the \textbf{addition} is defined as:
\begin{equation}
(a_0, \bvec{a})+ (b_0, \bvec{b})=(a_0+b_0, \bvec{a}+\bvec{b})
\end{equation}
and the \textbf{multiplication} is defined as (usually the sign is left out):
\begin{equation}\label{QuaRot_eq1}
(a_0, \bvec{a})\times (b_0, \bvec{b})=(a_0b_0-\bvec{a}\cdot\bvec{b}, a_0\bvec{b}+b_0\bvec{a}+\bvec{a}\times\bvec{b})
\end{equation}
\end{definition}


Note that though the addition of quaternions apparently commutes, the multiplication does not, because generally the cross product of vecters doesn't commute. Only when $\bvec{a}$ is parallel to $\bvec{b}$ (including the case where one of them is $\bvec 0$) can we say $\bvec{a}\times\bvec{b}= \bvec{0} =\bvec{b}\times\bvec{a}$. Nonetheless, it is safe to say that the multiplication satisfies the distributivity. 



For a quaternion $A=(a_0, \bvec{a})$, the real number $a_0$ is called the \textbf{real part} , and the vector $\bvec{a}$ is called the \textbf{vector part}. For convenience, sometimes we also write such a quaternion as $a_0+\bvec{a}$, comparable to the representation of a complex number $(a, b)=a+b\I$. When the real part is $0$, we cal also just write the quaternion as $\bvec{a}$; similarly, when the vector part is $\bvec{0}$, we can write the quaternion as $a_0$. In that notation, we can interpret $a_0+\bvec{a}$ as the addition of two quaternions. Similar to the case for complex numbers, we take the quaternions whose realparts are $0$ as real numbers. 


If the direction for the vector parts is stricted along a long passing the origin, then the set of quaternions is actually the set of all complex numbers. You may see why by comparing the multiplications of restricted quaternions and complex numbers--note that in this restriction, the quaternions commute. 

Instead of interpreting the quaternions as combinitions of a real number and a three-dimensional vector, we can also think of them as four-dimensional vectors. It is the same as the case when a complex number can be either the combinition of a real nunber and a one-dimensional vecter,or a two-dimensional vector. In fact, the set of quaternions form a four-dimensional \textbf{algebra}\upref{AlgFie}\footnote{In terms of algebra, the problem that Hamilton was dying to solve can be rephrased as "is there a three-dimensional algebra over the field \mathbb{R}". Now we know that the "algebra with multiplicity and the existence of multiplication inverses over the field \mathbb{R}" only occurs in one, two, four or eight dimensions, where quaternions already lose their commutivity and the octonions (eight dimensions) lose their associativity. Here the "multiplicity" refers to the property that $\abs{a}\abs{b}=\abs{ab}$. }.

Similar to complex numbers, we can define the conjugates and modulus of quaternions. 



\begin{definition}{Conjugate, Modulus Square and Modulus}
\begin{itemize}
\item Let $A=a_0+\bvec{a}$ be a quaternion, and define $\widetilde{A}=a_0-\bvec{a}$ namely the \textbf{（conjugate）} of $A$. 
\item Let $||A||=||\widetilde{A}||=A\widetilde{A}=\widetilde{A}A=a_0^2+ \abs{\bvec{a}}^2$ namely the \textbf{modulus square} of $A$. 
\item Let $|A|=\sqrt{||A||}$ namely the \textbf{modulus} of $A$. 
\end{itemize}
\end{definition}

\begin{exercise}{}\label{QuaRot_exe1}
\begin{itemize}
\item Prove the associativity of the multiplication of quaternions. 
\item Prove $||A||=||\widetilde{A}||=\widetilde{A}A=a_0^2 + \abs{\bvec{a}}^2$. 
\item If $\uvec e$ is a unit vector, prove that $\uvec{e}^2=-1,\ \uvec{e}^3=-\uvec{e}$
\end{itemize}
\end{exercise}

\subsection{The Exponential Representation of a Quaternion}

Let $\E$ is the base of the natural logarithm, then for any real number $x$, we have $\E^x = \sum^\infty\limits_{n=0} x^n / n!$. Now substitute $x$ with other objects that we can do multiplications, say matrices or complex numbers, we can extend the concept of exponential to more objects and construct the exponential of complex numbers or matrices. 

Since we can multiply quaternions, we can also define the exponential of quaternions: 

\begin{definition}{The Exponential Representation of a Quaternion}

Let $A=a_0+\bvec{a}$ be a quaternion. Using the multiplication of quaternions（\autoref{QuaRot_eq1}）, define: 
\begin{equation}
\E^A=\E^{a_0}\E^{\bvec{a}}=\E^{a_0}\sum^\infty\limits_{n=0}\frac{\bvec{a}^n}{n!}=\E^{a_0}\sum^\infty\limits_{n=0}\frac{(a \uvec a)^n}{n!}=\E^{a_0}[\cos{a}+\sin({a}\uvec{a})]
\end{equation}
where $a\uvec{a}$ and $\bvec{a}$ are unit vectors, $a$ being the modulus of the vector $\bvec{a}$. 
\end{definition}

\begin{exercise}{Analogies with Complex Numbers}

Analyze the exponential representations of complex numbers and quaternions, and explain why we can interpret complex numbers as quaternions restricted on a line passing the origin. 

\end{exercise}

Since the addition of the quaternions commute and the multiplication generally doesn't , the condition $\E^{A+B} = \E^A \E^B$ is not always satisfied. Therefore, the exponential representation of quaternions is not as broadly applied as that of the complex numbers. 

\subsection{Extending Quaternions}

The quaternions we just defined form a four-dimensional vector space with a base $\{1, \uvec i, \uvec j, \uvec k\}$. If we merely extend the choice of the field from $\mathbb{R}$ to $\mathbb{C}$, then we get the so-called \textbf{double quaternions} or \textbf{complex quaternions}. A double quaternion is also interpreted as the combinition of a complex number and a complex vector. 

For a double quaternion $A=a_0+a_1 \uvec i+a_2\uvec j+a_3\uvec k$, the concept of conjugate is subdivided into the follow categories: 

\begin{definition}{Conjugates of a double quaternion}
\begin{itemize}
\item Quaternion Conjugate: $\widetilde{A}=a_0-a_1\uvec i-a_2\uvec j-a_3\uvec k$
\item Anti-Conjugate: $A^C=a_0\Cj + a_1\Cj\uvec i+a_2\Cj\uvec j+a_3\Cj\uvec k$
\item Transpose: $A^T=a_0+a_1\uvec i-a_2\uvec j+a_3\uvec k$
\item Complex Conjugate: $A\Cj=a_0\Cj-a_1\Cj\uvec i+a_2\Cj\uvec j-a_3\Cj\uvec k$
\item Hermitian: $A^\dagger=a_0\Cj-a_1\Cj\uvec i-a_2\Cj\uvec j-a_3\Cj\uvec k$
\end{itemize}
\end{definition}

The modulus of a double quaternion is defined with the quaternion conjugate: $||A||=A\widetilde{A}=\widetilde{A}A=\sum^{3}_{n=0}a^2_n$. Differently from the case of quaternions, the modulus of a double quaternion can take the value of any complex number. 

\begin{exercise}{The relationship among the modulus and the conjugates of a complex quaternion}
Prove: $||A||=||\widetilde{A}||=||A^T||=||A^C||^*=||A^*||^*=||A^\dagger||^*$. 
\end{exercise}

\begin{exercise}{The multiplication of conjugates}
Let $A$ and $B$ be two complex quaternions, and prove:  
\begin{equation}
\leftgroup{
&A^CB^C=(AB)^C\\
&A^*B^*=(AB)^*\\
&\widetilde{A}\widetilde{B}=\widetilde{BA}\\
&A^TB^T=(BA)^T\\
&A^\dagger B^\dagger=(BA)^\dagger
}
\end{equation}

\end{exercise}

Unlike the "real" quaternions, there are non-zero complex quaternions whoses modulus is $0$. An example can be the $u$ and $v$ in \autoref{QuaRot_ex1} . 

Similarly, we can even let the coefficients of a quaternion be real quaternions, and that will be the \textbf{secondary quaternions}. However, since quaternions don't form a field, the properties of secondary quaternions are not as good as the complex coefficients, hence the application is limited and we will go too far into it. 

The complex quaternions are used in representing special relativity and classical field theories. They also directly correspond to the Pauli matrices. 


\subsection{The Matrix Representation of Quaternions}

If we rephrase the four base vectors of a quaternion $1, \uvec i, \uvec j$ 和 $\uvec k$ with the following matrices respectively: 

\begin{equation}
1=\begin{pmatrix}1&0\\0&1\end{pmatrix} 
\qquad
\uvec i=\begin{pmatrix}\I&0\\0&-\I\end{pmatrix} 
\qquad
\uvec j=\begin{pmatrix}0&1\\-1&0\end{pmatrix} 
\qquad
\uvec k=\begin{pmatrix}0&\I\\\I&0\end{pmatrix} 
\end{equation}
Then any quaternion or complex quaternion $A=a_0+\bvec{a}$ can be represented with the matrix: 
\begin{equation}
\begin{pmatrix}a_0+\I a_1&a_2+\I a_3\\-a_2+\I a_3&a_0-\I a_1 \end{pmatrix} 
\end{equation}

\begin{example}{Examples of Matrix Representations}\label{QuaRot_ex1}
\begin{equation}
1+\begin{pmatrix}1\\0\\\I\end{pmatrix} =1+1\uvec i+\I\uvec k =\begin{pmatrix}1+\I&-1\\-1&1-\I\end{pmatrix} 
\end{equation}
\begin{equation}
u=\frac{1}{2}(1-\I\uvec i)=\begin{pmatrix}1&0\\0&0\end{pmatrix} 
\end{equation}
\begin{equation}
v=-\frac{1}{2}(\uvec j+\I\uvec k)=\begin{pmatrix}0&0\\1&0\end{pmatrix} 
\end{equation}
\end{example}

By direct calculations, you can check that the multiplication and addition of quaternions are isomorphic to the multiplication and addition of matrices after we associate the quaternions with the matrices.  

In terms of the matrix representations, the transpose of $A$ is the transpose of the corresponding matrix; the complex conjugate is taking the conjugate of the matrix entries; the hermitian conjugate corresponds to the hermitian conjugate of the matrix (transpose and take the conjugate); the modulus square of a quaternion is the determinante of its matrix: $||A||=\opn{det}A$. Therefore, the (complex) quaternions whose modulus are not $0$ have inverses, which correspond to the reverse matrices. 


\subsection{Quaternion and the Representation of Rotation}

四元数可以用来简洁地表示三维空间中的旋转, 极大地减少了计算量. 

三维空间中的一个向量表示为标部为$0$的四元数: $v=\pmat{0, \bvec{v}}$. 如果我们绕着一个单位向量$\hat{\bvec{n}}$把$\bvec{v}$旋转一个角度$\theta$, 所得的结果应该是哪个向量呢？取四元数$q=\pmat{\cos{\frac{\theta}{2}}, \hat{\bvec{n}}\sin{\frac{\theta}{2}}}$, 那么旋转后的向量就可以表示为
\begin{equation}
qvq^{-1}
\end{equation}

比如说, 取$v=(0, 1, 0, 0)$, 它代表一个$x$轴上的单位向量. 如果想要把它绕着$z$轴上的单位向量转$\pi/2$, 那么结果向量的四元数表示应该是$(0, 0, 1, 0)$. 按照我们定义的规则, 旋转表示为四元数$q=(\sqrt{2}/2, 0, 0, \sqrt{2}/2)$, 按照四元数的乘法规则易得$qvq^{-1}=(0,0,1,0)$. 

\subsection{证明}

取四元数$q=\pmat{\cos{\frac{\theta}{2}}, \hat{\bvec{n}}\sin{\frac{\theta}{2}}}$和$v=(0, \bvec{v})$, 直接计算得: 

\begin{equation}
\begin{aligned}
qvq^{-1}&=\pmat{\cos{\frac{\theta}{2}}, \hat{\bvec{n}}\sin{\frac{\theta}{2}}}\cdot (0, \bvec{v})\cdot q^{-1}\\&
=(-\bvec{v}\cdot\hat{\bvec{n}}\sin{\frac{\theta}{2}}, \bvec{v}\cos{\frac{\theta}{2}}+\hat{\bvec{n}}\times\bvec{v}\sin{\frac{\theta}{2}})\cdot (\cos{\frac{\theta}{2}}, -\hat{\bvec{n}}\sin{\frac{\theta}{2}})\\&
=(0, \cos^2\frac{\theta}{2}\bvec{v}+\cos\frac{\theta}{2}\sin\frac{\theta}{2}\hat{\bvec{n}}\times\bvec{v}+(\hat{\bvec{n}}\cdot\bvec{v})\sin^2\frac{\theta}{2}\hat{\bvec{n}}\\&+\cos\frac{\theta}{2}\sin\frac{\theta}{2}\hat{\bvec{n}}\times\bvec{v}-\sin^2\frac{\theta}{2}\hat{\bvec{n}}\times(\hat{\bvec{n}}\times\bvec{v}))\\&
=(0, \cos^2\frac{\theta}{2}\bvec{v}-\sin^2\frac{\theta}{2}\hat{\bvec{n}}\times(\hat{\bvec{n}}\times\bvec{v})+\sin\theta\hat{\bvec{n}}\times\bvec{v}\\&+(\hat{\bvec{n}}\cdot\bvec{v})\sin^2\frac{\theta}{2}\hat{\bvec{n}})
\end{aligned}
\end{equation}

如果取$\bvec{v}\perp\hat{\bvec{n}}$, 考虑到此时$\hat{\bvec{n}}\times(\hat{\bvec{n}}\times\bvec{v}=-\bvec{v})$且$\hat{\bvec{n}}\cdot\bvec{v}=0$, 那么上式可以化简为
\begin{equation}
\begin{aligned}
qvq^{-1}&=(0, \cos\theta\bvec{v}+\sin\theta\hat{\bvec{n}}\times\bvec{v})
\end{aligned}
\end{equation}

这正是$\bvec{v}$绕$\hat{\bvec{n}}$旋转$\theta$的结果. 

如果取$\bvec{v}\parallel\hat{\bvec{n}}$, 考虑到此时$\hat{\bvec{n}}\times\bvec{v}=0$且$(\hat{\bvec{n}}\cdot\bvec{v})\bvec{v}=\bvec{v}$, 那么上式化为
\begin{equation}
\begin{aligned}
qvq^{-1}&=(0, \cos^2\frac{\theta}{2}\bvec{v}+\sin^2\frac{\theta}{2}\bvec{v})=(0, \bvec{v})=v
\end{aligned}
\end{equation}

这也是$\bvec{v}$绕$\hat{\bvec{n}}$旋转$\theta$的结果. 

综上所述, 取任意向量$\bvec{v}$, 把它分为垂直和平行于旋转轴的$\bvec{v}_\perp$和$\bvec{v}_\parallel$, 分别对应四元数$v_\perp$和$v_\parallel$, 那么$q v_\perp q^{-1}$和$q v_\parallel q^{-1}$分别对应这两个向量旋转后的结果. 故取$v=v_\perp+v_\parallel$为$\bvec{v}$对应的四元数后可由四元数乘法分配律得到, $qvq^{-1}$对应$\bvec{v}$旋转后的向量. 

一点补充: 考虑到四元数限定向量方向时退化为复数, 故$\bvec{v}\parallel\hat{\bvec{n}}$的情况其实可以直接套用复数的交换性来得到, 即$qvq^{-1}=qq^{-1}v=v$. 


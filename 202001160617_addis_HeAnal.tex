% 氦原子波函数数值分析
% 氦原子|薛定谔方程|波函数|动量谱|光电子|电离|FEDVR|数值解

\pentry{氦原子数值解 TDSE\upref{HeTDSE}， 库仑波函数\upref{CulmWf}}

\subsection{能量}
用虚时间法得到基态了以后， 我们可以用平均能量来计算基态能量
\begin{equation}
E = \mel{\Psi}{H_0}{\Psi}
\end{equation}

\subsection{动量谱（6 维）}
这里考虑的是双电离， 因为我们将要把两个电子都投影到连续态， 如果任何一个电子处于基态， 那么投影将为 0． 氢原子的散射态是库仑波函数\upref{CulmWf}， 而氦原子的（双电子）散射态没有解析解， 于是就假设时间足够大时， 两电子间没有相互作用， 就可以直接把两个库仑波函数做张量积再对称/反对称化即可． 而这样一来， 散射态和束缚态之间显然就不正交了， 所以分析时需要将所有束缚态去掉\footnote{理论上束缚态不去掉也没关系， 因为单电子的库仑球波函数和束缚态本来就是正交的． 这么做可能是考虑到数值误差？}． 爱华的方法是直接减去基态的投影， 然而这样一来激发态的分量就仍然存在了． 我认为如果电离波包和未电离的波包已经分离的话， 可以像做氢原子那样直接把一定半径内的波函数直接挖掉．

库仑波函数（见\autoref{CulmWf_eq9}\upref{CulmWf}， 我们只需要平面波出射）为（$\eta = Z/k$， $Z = -2$）
\begin{equation}
\psi_{\bvec k}(\bvec r) = \sqrt{\frac{2}{\pi}}\sum_{l, m} \frac{\I^l}{r k} \E^{-\I \sigma_l(\eta)} F_l (\eta, kr) Y_{l, m}^* (\uvec k) Y_{l, m}(\uvec r)
\end{equation}
对称化后的散射态为\footnote{注意对称化的时候选择交换 $\bvec r$ 还是交换 $\bvec k$ 会导致结果看起来不同（实际上是等效的）， 为了稍后积分方便， 我们选择交换 $\bvec k$}
\begin{equation}\ali{
& \qquad \psi_{\bvec k_1, \bvec k_2}(\bvec r_1, \bvec r_2) = \frac{1}{\sqrt 2} [\psi_{\bvec k_1} (\bvec r_1) \psi_{\bvec k_2} (\bvec r_2) + \psi_{\bvec k_2} (\bvec r_1) \psi_{\bvec k_1} (\bvec r_2)]\\
&= \frac{\sqrt 2}{\pi} \sum_{l_1, m_1} \sum_{l_2, m_2} \frac{\I^{l_1 + l_2}}{r_1 r_2 k_1 k_2} \times\\
&\qquad [(\E^{-\I [\sigma_{l_1}(\eta_1) + \sigma_{l_2} (\eta_2)]} F_{l_1} (\eta_1, k_1 r_1) F_{l_2}(\eta_2, k_2 r_2) Y_{l_1, m_1}^* (\uvec k_1) Y_{l_2, m_2}^* (\uvec k_2)) +\\
& \qquad (\E^{-\I [\sigma_{l_1}(\eta_2) + \sigma_{l_2} (\eta_1)]} F_{l_1} (\eta_2, k_2 r_1) F_{l_2}(\eta_1, k_1 r_2) Y_{l_1, m_1}^* (\uvec k_2) Y_{l_2, m_2}^* (\uvec k_1))]\times\\
& \qquad Y_{l_1, m_1} (\uvec r_1) Y_{l_2, m_2} (\uvec r_2)
}\end{equation}

TDSE 的波函数（假设已经满足交换对称）为
\begin{equation}\ali{
&\Psi(\bvec r_1, \bvec r_2) = \sum_{L, M, l_1, l_2}  \frac{1}{r_1 r_2} \psi_{l_1, l_2}^{L, M}(r_1, r_2)\mathcal{Y}_{l_1, l_2}^{L, M}(\uvec r_1, \uvec r_2)\\
& \quad = \sum_{L, M, l_1, l_2} \frac{1}{r_1 r_2} \psi_{l_1, l_2}^{L, M}(r_1, r_2) \sum_{m_1, m_2} \bmat{l_1 & l_2 & L\\ m_1 & m_2 & M} Y_{l_1, m_1} (\uvec r_1) Y_{l_2, m_2} (\uvec r_2)
}\end{equation}
投影得（过程略， 注意两个 $Y_{l_1, m_1} (\uvec r_1) Y_{l_2, m_2} (\uvec r_2)$ 项积分会产生 4 个 $\delta$ 函数）\footnote{下面花了不少功夫证明方括号中两项相等． 事实上对任何对称的 $\Psi(\bvec r_1, \bvec r_2)$ 都容易证明 $\braket{\phi_1(\bvec r_1)\phi_2(\bvec r_2)}{\Psi(\bvec r_1, \bvec r_2)} = \braket{\phi_2(\bvec r_1)\phi_1(\bvec r_2)}{\Psi(\bvec r_1, \bvec r_2)}$． 另外如果 $\Psi$ 是反对称， 两项就是相反数．}
% 未完成： 未验证， 且与爱华的代码不同
\begin{equation}\label{HeAnal_eq4}
\ali{
\braket{\psi_{\bvec k_1, \bvec k_2}}{\Psi} &= \frac{\sqrt 2}{\pi k_1 k_2} \sum_{L, M, l_1, l_2} \I^{l_1 + l_2} \times \\
&\qty[\ali{
&\E^{\I [\sigma_{l_1}(\eta_1) + \sigma_{l_2} (\eta_2)]} I_{l_1, l_2}^{L, M}(k_1, k_2) \mathcal{Y}_{l_1, l_2}^{L, M}(\uvec k_1, \uvec k_2) + \\
&\E^{\I [\sigma_{l_1}(\eta_2) + \sigma_{l_2} (\eta_1)]} I_{l_1, l_2}^{L, M}(k_2, k_1) \mathcal{Y}_{l_1, l_2}^{L, M}(\uvec k_2, \uvec k_1)}]
}\end{equation}
其中（定义 $\eta_i = Z/k_i$）
\begin{equation}
I_{l_i, l_j}^{L, M}(k_m, k_n) = \int_0^\infty \int_0^\infty F_{l_i} (\eta_m, k_m r_1) F_{l_j}(\eta_n, k_n r_2)  \psi_{l_i, l_j}^{L, M}(r_1, r_2) \dd{r_1} \dd{r_2}
\end{equation}

把\autoref{HeAnal_eq4} 中的求和拆成两项， 第二项的求和中 $l_1, l_2$ 交换得
\begin{equation}\label{HeAnal_eq1}
\ali{
\braket{\psi_{\bvec k_1, \bvec k_2}}{\Psi} &= \frac{\sqrt 2}{\pi k_1 k_2} \sum_{L, M, l_1, l_2} \I^{l_1 + l_2} \E^{\I [\sigma_{l_1}(\eta_1) + \sigma_{l_2} (\eta_2)]} \times \\
&\qty[
I_{l_1, l_2}^{L, M}(k_1, k_2) \mathcal{Y}_{l_1, l_2}^{L, M}(\uvec k_1, \uvec k_2) + 
 I_{l_2, l_1}^{L, M}(k_2, k_1) \mathcal{Y}_{l_2, l_1}^{L, M}(\uvec k_2, \uvec k_1)]
}\end{equation}
当 $\Psi$ 满足粒子交换对称时， 使用\autoref{HeTDSE_eq1}\upref{HeTDSE} 可以证明
\begin{equation}
I_{l_1, l_2}^{L, M}(k_1, k_2) = (-1)^{l_1 + l_2 - L} I_{l_2, l_1}^{L, M}(k_2, k_1)
\end{equation}
另外由\autoref{GenYlm_eq5}\upref{GenYlm} 得\autoref{HeAnal_eq1} 方括号中的两项相等
\begin{equation}\label{HeAnal_eq2}
\braket{\psi_{\bvec k_1, \bvec k_2}}{\Psi} = \frac{2\sqrt 2}{\pi k_1 k_2} \sum_{L, M, l_1, l_2} \I^{l_1 + l_2} \E^{\I [\sigma_{l_1}(\eta_1) + \sigma_{l_2} (\eta_2)]}  I_{l_1, l_2}^{L, M}(k_1, k_2) \mathcal{Y}_{l_1, l_2}^{L, M}(\uvec k_1, \uvec k_2)
\end{equation}

投影的平方就是概率分布
\begin{equation}\label{HeAnal_eq3}
P(\bvec k_1, \bvec k_2) = \abs{\braket{\psi_{\bvec k_1, \bvec k_2}}{\Psi}}^2
\end{equation}

\subsection{能量分布}
先继续考虑双电离， \autoref{HeAnal_eq3} 中的概率归一化为
\begin{equation}
\int P(\bvec k_1, \bvec k_2) \dd{\Omega_{k1}} \dd{\Omega_{k2}} k_1^2 \dd{k_1} k_2^2 \dd{k_2}
\end{equation}
所以动量绝对值的分布函数为
\begin{equation}\label{HeAnal_eq5}
P(k_1, k_2) = k_1^2 k_2^2 \int P(\bvec k_1, \bvec k_2) \dd{\Omega_{k1}} \dd{\Omega_{k2}}
\end{equation}
能量分布函数为
\begin{equation}
P(E_1, E_2) = \frac{1}{k_1 k_2} P(k_1, k_2)
\end{equation}
所以只需要将\autoref{HeAnal_eq3} 代入\autoref{HeAnal_eq5} 得\footnote{为了能使 $\int P(k_1, k_2) \dd{k_1}\dd{k_2}$， 我们还是不对 $\psi_{\bvec k_1, \bvec k_2}$ 进行对称化， $P(k_1, k_2)$ 就是上面定义的 $1/2$．}
\begin{equation}
P(k_1, k_2) = \frac{4}{\pi^2} \sum_{L, M, l_1, l_2} \abs{I_{l_1, l_2}^{L, M} (k_1, k_2)}^2
\end{equation}
其实该式的推导大可直接用球面波而不是投影到平面波再做角向积分， 过程类比\upref{Hanaly}．

\subsection{径向概率分布}
类比氢原子的情况（\autoref{HWF_eq4}\upref{HWF}）
\begin{equation}
\ali{
& \quad \iint P(r_1, r_2) \dd{r_1} \dd{r_2}\\
&= \iint \iint \abs{\frac{1}{r_1 r_2} \sum_\lambda \psi_\lambda(r_1, r_2) \mathcal{Y}_\lambda (\uvec r_1, \uvec r_2)}^2 \dd{\Omega_1}\dd{\Omega_2} r_1^2 r_2^2 \dd{r_1}\dd{r_2}\\
&= \iint \sum_\lambda\abs{\psi_\lambda(r_1, r_2)}^2 \dd{r_1} \dd{r_2} = 1
}\end{equation}
所以
\begin{equation}
P(r_1, r_2) = \sum_\lambda\abs{\psi_\lambda(r_1, r_2)}^2
\end{equation}
这就是 $(r_1, r_2)$ 子空间中的总模长， 等于子空间中每个基底的系数的模方和．

\subsection{JAD（joint angular distribution）}
这里的 JAD 并不是总的方向分布， 而是某种能量分割的方向分布， 即 $k_2 - k_1 = \Delta k$， 所以积分中要有一个 delta 函数．
\begin{equation}
P_{JAD}(\uvec k_1, \uvec k_2) = \int_0^\infty \int_0^\infty P(\bvec k_1, \bvec k_2) k_1^2 k_2^2 \delta(k_1 - k_2 + \Delta k) \dd{k_1} \dd{k_2}
\end{equation}
一般在同一平面上取 $\uvec k_1$ 和 $\uvec k_2$ （$\phi_1 = \phi_2$ 为常数， 例如 0）， 这样就可以画一个横纵坐标分别为 $\theta_1$ 和 $\theta_2$ 的二维分布图 $P_{JAD}(\theta_1, \theta_2)$．

\subsection{单光子吸收}

类比氢原子吸收一个光子（一阶微扰）后有 $\Delta l = \pm 1$ （可以想象成光子带有角动量量子数 1）， 氦原子从基态吸收一个光子后总角动量也会增加 1． 所以要考虑单电子吸收， 我们可以只观察 $L = 1$ 的所有分波， 甚至在传播时可以用所谓的 “weak field TDSE” \footnote{参考 Colgan 2001, J Phys. B: 34 (2001) L457-L466}

\begin{equation}
\I \pdv{\Psi^{^1P}}{t} = H_0 \Psi^{^1P} + H_E \Psi^{^1S} \E^{-\I E_0 t}
\end{equation}
其中 $H_0$ 是无场的哈密顿， $H_E = E(t) (z_1 + z_2)$ 是电场的哈密顿．
\begin{equation}
\Psi^{^1P}(\bvec r_1, \bvec r_2, t) = \sum_{l_1, l_2} \frac{1}{r_1 r_2} \psi_{l_1, l_2}^{1, 0} (r_1, r_2, t) \mathcal Y_{l_1, l_2}^{1, 0} (\uvec r_1, \uvec r_2)
\end{equation}

吸收一个光子的概率就是对 $L = 1$ 所有分波进行模方积分求和． 然而如果做 Streaking 的话， 通常会吸收多个红外光子， 所以还是需要许多分波．

\subsection{角向基底变换}
除了使用广义球谐函数作为角向基底外， 另一个自然的选择就是两个球谐函数的乘积． 如果令总波函数为
\begin{equation}\label{HeAnal_eq6}
\Psi(\bvec r_1, \bvec r_2) = \frac{1}{r_1 r_2} \sum_{l_1, m_1, l_2, m_2} \psi_{l_1, l_2}^{m_1, m_2}(r_1, r_2) Y_{l_1, m_1}(\uvec r_1) Y_{l_2, m_2} (\uvec r_2)
\end{equation}
那么由\autoref{HeTDSE_eq2}\upref{HeTDSE} 和\autoref{GenYlm_eq1}\upref{GenYlm} 得
\begin{equation}\label{HeAnal_eq7}
\psi_{l_1, l_2}^{m_1, m_2}(r_1, r_2) = \sum_{L,M} \bmat{l_1 & l_2 & L\\ m_1 & m_2 & M} \psi_{l_1, l_2}^{L,M}(r_1, r_2)
\end{equation}
若我们有一个 $l_1, l_2, L, M$ 的列表和一个 $l_1, l_2, m_1, m_2$ 的列表， 该变换就可以用矩阵表示．

\subsection{单电子概率分布}
（挺想画出来看看是啥样的）

先不考虑粒子交换对称\footnote{如果考虑的话， 投影乘以 $\sqrt{2}$ 或者概率乘以 2 即可}， 要求第一个电子出现在位置 $\bvec r_1$ 的概率， 就把总波函数投影到 $\bvec r_1$ 子空间中， 再求该子空间中（关于 $\bvec r_2$ 的）波函数的概率即可．
\begin{equation}
P(\bvec r_1) = \int \abs{\Psi(\bvec r_1, \bvec r_2)}^2 \dd[3]{r_2}
\end{equation}
若使用\autoref{HeAnal_eq6} 形式的波函数\footnote{在程序中不一定需要先这么做， 只需要将\autoref{HeAnal_eq7} 带入以下各式， 在将 $L, M, l_1, l_2$ 的求和提到最外面即可}， 这个积分的形式就变得相当简单， 先令 $\bvec r_1$ 为常数， 计算关于 $r_2$ 的径向波函数
\begin{equation}
\ali{
\psi_{l_2, m_2}(r_2) &= \frac{1}{r_1} \sum_{l_1, m_1} \psi_{l_1, l_2}^{m_1, m_2}(r_1, r_2) Y_{l_1, m_1}(\uvec r_1)\\
&= \frac{1}{r_1} \sum_{L,M,l_1} \bmat{l_1 & l_2 & L\\ M - m_2 & m_2 & M} \psi_{l_1, l_2}^{L,M}(r_1, r_2) Y_{l_1, m_1}(\uvec r_1)
}\end{equation}
这样\autoref{HeAnal_eq6} 就变为
\begin{equation}
\Psi(\bvec r_2) = \frac{1}{r_2} \sum_{l_2, m_2} \psi_{l_2, m_2}(r_2) Y_{l_2, m_2} (\uvec r_2)
\end{equation}
单电子概率为
\begin{equation}
P(\bvec r_1) = \sum_{l_2, m_2} \int \abs{\psi_{l_2, m_2}(r_2)}^2 \dd{r} = \frac{1}{r_1^2} \sum_{l_2, m_2} \int \abs{\sum_{l_1, m_2} \psi_{l_1, l_2}^{m_1, m_2}(r_1, r_2) Y_{l_1,m_1}(\uvec r_1)}^2 \dd{r_2}
\end{equation}

\subsection{Shakeup 电离 1}
Shakeup 就是说总波函数中一个电子处于某个束缚态， 另一个电子处于散射态的部分． 如果不需要区分 $m_1$， 只求概率分布 $P(n_1, l_1, k_2)$， 公式将会比较简单． 子空间的基底为（$n_1, l_1, k_2$ 为常数）
\begin{equation}
\ket{n_1, l_1, k_2, l_2, L, M} = R_{n_1,l_1}(r_1) \frac{1}{r_2}\sqrt{\frac{2}{\pi}} F_{l_2}(k_2, r_2) \mathcal{Y}_{l_1, l_2}^{L, M}(\uvec r_1, \uvec r_2)
\end{equation}
投影为
\begin{equation}
\braket{n_1, l_1, k_2, l_2, L, M}{\Psi} = \sqrt{\frac{2}{\pi}} \iint r_1 R_{n_1,l_1}(r_1) F_{l_2}(k_2, r_2) \psi_{l_1, l_2}^{L, M}(r_1, r_2) \dd{r_1} \dd{r_2}
\end{equation}
概率分布为
\begin{equation}
\begin{aligned}
P(n_1, l_1, k_2) &= \sum_{l_2, L, M} \abs{\braket{n_1, l_1, k_2, l_2, L, M}{\Psi}}^2
\end{aligned}
\end{equation}

为了调试程序， 一个更简单的分布是 $P(n_1, l_1, m_1, r_2)$ 或者 $P(n_1, l_1, r_2)$， 后者基底为
\begin{equation}
\ket{n_1, l_1, r_2', l_2, L, M} = R_{n_1,l_1}(r_1) \frac{1}{r_2}\delta(r_2 - r_2') \mathcal{Y}_{l_1, l_2}^{L, M}(\uvec r_1, \uvec r_2)
\end{equation}
投影为
\begin{equation}
\braket{n_1, l_1, r_2', l_2, L, M}{\Psi} = \int r_1 R_{n_1,l_1}(r_1) \psi_{l_1, l_2}^{L, M}(r_1, r_2') \dd{r_1}
\end{equation}
概率分布为
\begin{equation}
\begin{aligned}
P(n_1, l_1, r_2') &= \sum_{l_2, L, M} \abs{\braket{n_1, l_1, r_2', l_2, L, M}{\Psi}}^2
\end{aligned}
\end{equation}

\subsection{Shakeup 电离 2}

 令归一化的基态为
\begin{equation}
\phi_{n_1, l_1, m_1}(\bvec r_1) = R_{n_1,l_1}(r_1)Y_{l_1,m_1}(\uvec r_1)
\end{equation}
归一化的散射态为
\begin{equation}
C_{l_2, m_2}(k_2, \bvec r_2) = \frac{1}{r_2}\sqrt{\frac{2}{\pi}} F_{l_2}(k_2, r_2) Y_{l_2, m_2} (\uvec r_2)
\end{equation}
以下的计算和单电子概率分布很类似， 我们同样不需要太在意粒子交换对称的问题， 把内积乘以 $\sqrt{2}$， 概率乘以 2 即可． 同样先把总波函数转换为\autoref{HeAnal_eq6} 的形式， 投影得到
\begin{equation}
\ali{
&\bra{\phi_{n_1, l_1, m_1}}\braket{C_{l_2, m_2}(k_2)}{\Psi} = \sqrt{\frac{2}{\pi}} \iint r_1 R_{n_1,l_1}(r_1) F_{l_2}(k_2, r_2) \psi_{l_1, l_2}^{m_1, m_2}(r_1, r_2) \dd{r_1} \dd{r_2}\\
& = \sqrt{\frac{2}{\pi}} \sum_{L,M} \bmat{l_1 & l_2 & L\\ m_1 & m_2 & M} \iint r_1 R_{n_1,l_1}(r_1) F_{l_2}(k_2, r_2) \psi_{l_1, l_2}^{L,M}(r_1, r_2) \dd{r_1} \dd{r_2}
}\end{equation}
\begin{equation}
P(n_1, l_1, m_1, k_2) = \sum_{l_2, m_2}\abs{\bra{\phi_{n_1, l_1, m_1}}\braket{C_{l_2, m_2}(k_2)}{\Psi}}^2
\end{equation}
当 $M \equiv 0$ 时这里对 $m_2$ 求和其实只有一项就是 $m_2 = - m_1$， 也是一个常数．

可以验证（？）% 未完成： 在程序中验证
\begin{equation}
P(n_1, l_1, k_2) = \sum_{m_1} P(n_1, l_1, m_1, k_2)
\end{equation}

然而这个公式调试起来不好办， 最好的办法其实是先计算 $\psi_{l_1, l_2}^{m_1, m_2}$． 这就需要也搞一个 $(l_1, m_1, l_2, m_2)$ 的列表， 计算酋变换的矩阵． 而由于 $l_1, m_1, m_2$ 都是常数， 只需要每个 $l_2$ 一个分波即可．



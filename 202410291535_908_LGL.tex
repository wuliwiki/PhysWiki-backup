% 拉格朗日力学 （综述）
% license CCBYSA3
% type Wiki

本文根据 CC-BY-SA 协议转载翻译自维基百科\href{https://en.wikipedia.org/wiki/Lagrangian_mechanics}{相关文章}）

在物理学中，拉格朗日力学是一种基于平稳作用原理（也称为最小作用原理）的经典力学表述。它由意大利-法国数学家和天文学家约瑟夫-路易·拉格朗日在1760年向都灵科学学院的演讲中提出，并在1788年他的巨著《解析力学》中达到巅峰。

拉格朗日力学将一个力学系统描述为由构型空间 \( M \) 和其中的一个光滑函数 \( L \)（称为拉格朗日量）组成的对 \( (M, L) \)。对于许多系统，\( L = T - V \)，其中 \( T \) 和 \( V \) 分别为系统的动能和势能。

平稳作用原理要求由 \( L \) 推导出的系统的作用泛函在系统的时间演化过程中保持在一个平稳点（最大值、最小值或鞍点）。这一约束条件使得可以利用拉格朗日方程计算系统的运动方程。
\subsection{简介}
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/dd4713438c2a5e46.png}
\caption{“约瑟夫-路易·拉格朗日 (1736–1813)”} \label{fig_LGL_1}
\end{figure}
一个珠子被限制在无摩擦的细线上运动。细线对珠子施加一个反作用力 \( C \)，以保持其在细线上。此时的非约束力 \( N \) 是重力。注意，珠子在细线上的初始位置可能会导致不同的运动。

简单摆。由于杆是刚性的，摆锤的位置受到方程 \( f(x, y) = 0 \) 的约束，约束力 \( C \) 是杆中的拉力。同样，此时的非约束力 \( N \) 也是重力。

牛顿定律和力的概念通常是讲授机械系统的起点【5】。这种方法适用于许多问题，但对于一些问题，计算变得极其复杂【6】。例如，在计算一个带珍珠的圆环在水平面上滚动的运动时，时间变化的约束力（例如圆环的角速度、珍珠相对于圆环的运动）使得利用牛顿方程难以确定圆环的运动【7】。拉格朗日力学采用能量而非力作为基本成分【5】，从而得到更抽象的方程，能够处理更复杂的问题【6】。

特别是，拉格朗日的方法是为每个物体的位移和速度建立独立的广义坐标，从而写出一个拉格朗日量（系统的总动能减去势能）的通式，并对所有可能的粒子运动路径进行求和，得到‘作用’的公式，通过极小化作用得到一组广义方程。这一求和的量在粒子实际采取的路径上被最小化。这一选择消除了将约束力引入最终广义方程组的必要性。这样，方程减少了，因为不需要直接计算给定时刻约束对粒子的影响【7】。
\begin{figure}[ht]
\centering
\includegraphics[width=7cm]{./figures/6b06deede1a9c42f.png}
\caption{珠子被限制在无摩擦的细线上运动。细线对珠子施加一个反作用力 \( C \) 以使其保持在细线上。在这种情况下，非约束力 \( N \) 是重力。注意，珠子在细线上的初始位置可能会导致不同的运动。} \label{fig_LGL_2}
\end{figure}
对于各种物理系统，如果一个物体的大小和形状可以忽略不计，将其视为质点是一种有用的简化。对于由质量为 \( m_1, m_2, \dots, m_N \) 的 \( N \) 个质点组成的系统，每个质点都有一个位置向量，分别记为 \( r_1, r_2, \dots, r_N \)。笛卡尔坐标系通常足够，因此 \( r_1 = (x_1, y_1, z_1), r_2 = (x_2, y_2, z_2) \) 等。在三维空间中，每个位置向量需要三个坐标来唯一确定一个点的位置，因此需要 \( 3N \) 个坐标来唯一确定系统的构型。这些坐标是粒子在空间中的具体位置；空间中的一个通用点写作 \( r = (x, y, z) \)。每个粒子的速度是其沿运动路径的移动速度，为其位置的时间导数，因此
\[
\mathbf{v}_1 = \frac{d\mathbf{r}_1}{dt}, \quad \mathbf{v}_2 = \frac{d\mathbf{r}_2}{dt}, \dots, \quad \mathbf{v}_N = \frac{d\mathbf{r}_N}{dt}.~
\]
在牛顿力学中，运动方程由牛顿定律给出。第二定律“合力等于质量乘加速度”适用于每个粒子，
\[
\sum \mathbf{F} = m \frac{d^2 \mathbf{r}}{dt^2},~
\]
对于一个三维的 \( N \) 粒子系统，这样的方程组成了关于粒子位置的 \( 3N \) 个二阶常微分方程，需要求解。
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/aa82cf47a827db48.png}
\caption{简单摆。由于杆是刚性的，摆锤的位置受到方程 \( f(x, y) = 0 \) 的约束，约束力 \( C \) 是杆中的拉力。同样，在这种情况下，非约束力 \( N \) 是重力。} \label{fig_LGL_3}
\end{figure}
\subsubsection{拉格朗日量}
拉格朗日力学不使用力，而是利用系统中的能量。拉格朗日力学的核心量是拉格朗日量，它是一个总结整个系统动力学的函数。总体而言，拉格朗日量的单位是能量，但对于所有物理系统没有统一的表达式。任何能够生成符合物理定律的正确运动方程的函数都可以作为拉格朗日量。然而，可以构建适用于广泛应用的通用表达式。对于没有电磁场的非相对论质点系统，其拉格朗日量为【8】
\[
L = T - V,~
\]
其中
\[
T = \frac{1}{2} \sum_{k=1}^{N} m_k v_k^2~
\]
是系统的总动能，等于 \( N \) 个质点动能之和。每个标记为 \( k \) 的质点具有质量 \( m_k \)，且 \( v_k^2 = v_k \cdot v_k \) 是其速度的平方，即速度与自身的点积【9】。

动能 \( T \) 是系统运动的能量，仅依赖于速度 \( v_k \)，而不依赖于位置 \( r_k \) 或时间 \( t \)，因此 \( T = T(v_1, v_2, \dots) \)。

\( V \) 是系统的势能，反映了粒子之间相互作用的能量，即每个粒子由于其他粒子以及任何外部影响而具有的能量。对于保守力（例如牛顿引力），它仅是粒子位置向量的函数，因此 \( V = V(r_1, r_2, \dots) \)。对于那些可以从适当的势中导出的非保守力（例如电磁势），势能也会涉及速度，即 \( V = V(r_1, r_2, \dots, v_1, v_2, \dots) \)。如果存在随时间变化的外场或外部驱动力，势能也会随时间变化，因此最普遍地表示为 \( V = V(r_1, r_2, \dots, v_1, v_2, \dots, t) \)。

如前所述，这种形式的 \( L \) 适用于许多重要的系统类型，但并不适用于所有情况。对于相对论拉格朗日力学，必须用一个与狭义相对论（在洛伦兹变换下为标量）或广义相对论（4-标量）一致的函数来替代【10】。如果存在磁场，则需要重新表述势能的表达式【需要引用】。对于耗散力（例如摩擦），通常需要引入一个称为“瑞利耗散函数”的函数来描述能量损失【11】。

一个或多个粒子可能会受到一个或多个完整约束的限制；这种约束由形式 \( f(r, t) = 0 \) 的方程描述。如果系统中有 \( C \) 个约束，那么每个约束都有一个方程 \( f_1(r, t) = 0, f_2(r, t) = 0, \dots, f_C(r, t) = 0 \)，这些方程可以应用于任何粒子。如果粒子 \( k \) 受到约束 \( i \) 的限制，则 \( f_i(r_k, t) = 0 \)。在任何时刻，受约束粒子的坐标是相互关联的，而不是独立的。约束方程决定了粒子可以沿着哪些路径运动，但并不规定它们的确切位置或速度。非完整约束依赖于粒子的速度、加速度或位置的更高阶导数。拉格朗日力学仅适用于所有约束都是完整的系统。三个非完整约束的例子为【12】。

当约束方程是不可积的、约束具有不等式、或存在诸如摩擦之类复杂的非保守力时，需要特殊处理非完整约束，可能需要回归到牛顿力学或使用其他方法【13】。

如果由于时间变化的约束或外部影响使得 \( T \) 或 \( V \) 或两者都显式地依赖于时间，则拉格朗日量 \( L(r_1, r_2, \dots, v_1, v_2, \dots, t) \) 显式地依赖于时间。如果势能和动能都不依赖于时间，那么拉格朗日量 \( L(r_1, r_2, \dots, v_1, v_2, \dots) \) 显式地与时间无关。在这两种情况下，拉格朗日量始终通过广义坐标隐含地依赖于时间。

根据这些定义，拉格朗日第一类方程为：

\textbf{拉格朗日方程（第一类）}
\[
\frac{\partial L}{\partial \mathbf{r}_{k}} - \frac{\mathrm{d}}{\mathrm{d}t} \frac{\partial L}{\partial \dot{\mathbf{r}}_{k}} + \sum_{i=1}^{C} \lambda_{i} \frac{\partial f_{i}}{\partial \mathbf{r}_{k}} = 0,~
\]
其中 \( k = 1, 2, \ldots, N \) 表示粒子，\(\lambda_{i}\) 是每个约束方程 \( f_{i} \) 的拉格朗日乘子，且
\[
\frac{\partial }{\partial \mathbf{r}_{k}} \equiv \left(\frac{\partial }{\partial x_{k}}, \frac{\partial }{\partial y_{k}}, \frac{\partial }{\partial z_{k}}\right), \quad \frac{\partial }{\partial \dot{\mathbf{r}}_{k}} \equiv \left(\frac{\partial }{\partial \dot{x}_{k}}, \frac{\partial }{\partial \dot{y}_{k}}, \frac{\partial }{\partial \dot{z}_{k}}\right)~
\]
是对指定变量的偏导数的简写（而不是对整个向量的导数）。每个点上方的符号表示时间导数。与牛顿定律相比，这种方法确实增加了需要解决的方程数量，从 \( 3N \) 增加到 \( 3N + C \)，因为在位置坐标和乘子中有 \( 3N \) 个耦合的二阶微分方程，以及 \( C \) 个约束方程。然而，当与粒子的位置信息一起求解时，乘子可以提供关于约束力的信息。坐标不需要通过求解约束方程来消去。

在拉格朗日函数中，位置坐标和速度分量都是独立变量，拉格朗日函数的导数是根据通常的微分规则分别对这些变量进行求导的（例如，对于粒子2的z方向速度分量，定义为 \(v_{z,2} = \frac{dz_2}{dt}\)，其偏导数 \(\frac{\partial L}{\partial v_{z,2}}\) 就是所需的；不需要使用复杂的链式法则或全导数来将速度分量与相应的坐标 \(z_2\) 关联）。

在每个约束方程中，一个坐标是多余的，因为它是由其他坐标确定的。因此，独立坐标的数量为 \(n = 3N - C\)。我们可以将每个位置向量转换为一组公共的 \(n\) 个广义坐标，方便地写成 \(n\)-元组 \(q = (q_1, q_2, ... q_n)\)，通过将每个位置向量，进而每个位置坐标，表示为广义坐标和时间的函数：
\[
\mathbf{r}_{k} = \mathbf{r}_{k}(\mathbf{q}, t) = {\big (}x_{k}(\mathbf{q}, t), y_{k}(\mathbf{q}, t), z_{k}(\mathbf{q}, t), t{\big )}.~
\]
根据这些定义，欧拉–拉格朗日方程，或称为第二类拉格朗日方程[15][16][17]：

\textbf{拉格朗日方程（第二类）}
\[
\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial \dot{q}_j}\right) = \frac{\partial L}{\partial q_j}~
\]
是变分法的数学结果，也可以应用于力学。将拉格朗日函数 \(L(q, \frac{dq}{dt}, t)\) 代入其中，可以得到系统的运动方程。与牛顿力学相比，方程的数量从 \(3N\) 减少到 \(n = 3N - C\) 个耦合的二阶微分方程，采用广义坐标。这些方程完全不包括约束力，仅需考虑非约束力。

虽然运动方程包含偏导数，但这些偏导数的结果仍然是粒子位置坐标的常微分方程。表示为 \(\frac{d}{dt}\) 的全时间导数通常涉及隐式微分。这两个方程在拉格朗日函数中是线性的，但在坐标中通常是非线性耦合方程。
\subsection{从牛顿力学到拉格朗日力学}  
\subsubsection{牛顿定律}
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/2ea329296b50037e.png}
\caption{艾萨克·牛顿（1642–1727）} \label{fig_LGL_4}
\end{figure}
为了简单起见，牛顿定律可以在不失一般性的情况下针对一个粒子进行说明（对于一个由 \(N\) 个粒子组成的系统，这些方程同样适用于系统中的每个粒子）。对于质量为 \(m\) 的粒子，其运动方程是1687年牛顿的第二定律，用现代向量符号表示为
\[
\mathbf{F} = m \mathbf{a},~
\]
其中 \(a\) 是加速度，\(F\) 是作用在其上的合力。当质量变化时，该方程需要推广，以考虑动量的时间导数。在三维空间中，这是一个由三个耦合的二阶常微分方程组成的系统，因为这个向量方程中有三个分量。其解为粒子在时间 \(t\) 的位置向量 \(r\)，受初始条件 \(r\) 和 \(v\) 在 \(t = 0\) 时的约束。

牛顿定律在笛卡尔坐标系中容易使用，但笛卡尔坐标并不总是方便，对于其他坐标系，运动方程可能变得复杂。在一组曲线坐标 \(\xi = (\xi_1, \xi_2, \xi_3)\) 中，以张量指标符号表示的定律是“拉格朗日形式”：
\[
F^{a} = m\left(\frac{\mathrm{d}^{2}\xi^{a}}{\mathrm{d}t^{2}} + \Gamma^{a}{}_{bc} \frac{\mathrm{d}\xi^{b}}{\mathrm{d}t} \frac{\mathrm{d}\xi^{c}}{\mathrm{d}t}\right) = g^{ak}\left(\frac{\mathrm{d}}{\mathrm{d}t} \frac{\partial T}{\partial \dot{\xi}^{k}} - \frac{\partial T}{\partial \xi^{k}}\right), \quad \dot{\xi}^{a} \equiv \frac{\mathrm{d}\xi^{a}}{\mathrm{d}t},~
\]
其中 \(F^{a}\) 是作用在粒子上的合力的第 \(a\) 个协变分量，\(\Gamma^{abc}\) 是第二类克里斯托费尔符号，
\[
T = \frac{1}{2}mg_{bc} \frac{\mathrm{d}\xi^{b}}{\mathrm{d}t} \frac{\mathrm{d}\xi^{c}}{\mathrm{d}t}~
\]
是粒子的动能，\(g_{bc}\) 是曲线坐标系的度量张量的协变分量。所有指标 \(a, b, c\) 都取值 1, 2, 3。曲线坐标与广义坐标并不相同。

将牛顿定律表达成这种形式似乎有些复杂，但这有其优势。通过评估动能的导数，可以避免以克里斯托费尔符号表示的加速度分量。如果作用在粒子上的合力为零，即 \(F = 0\)，那么粒子不会加速，而是以恒定速度沿直线运动。从数学上讲，微分方程的解是测地线，即空间中两个点之间的极值长度曲线（这些曲线可能是最短路径，但不一定）。在平坦的三维真实空间中，测地线只是直线。因此，对于自由粒子，牛顿的第二定律与测地线方程一致，表明自由粒子遵循测地线，即它能够沿其移动的极值轨迹。如果粒子受到 \(F \neq 0\) 的力作用，粒子会因作用在其上的力而加速，并偏离它如果是自由粒子时所遵循的测地线。将这里给出的平坦三维空间中的量适当扩展到四维曲率时空，上述形式的牛顿定律也适用于爱因斯坦的广义相对论，在这种情况下，自由粒子在曲率时空中遵循的测地线不再是普通意义上的“直线”。

然而，我们仍需要知道作用在粒子上的总合力 \(F\)，这反过来需要非约束力的合力 \(N\) 加上约束力的合力 \(C\)，
\[
\mathbf{F} = \mathbf{C} + \mathbf{N}.~
\]
约束力可能很复杂，因为它们通常依赖于时间。此外，如果存在约束，曲线坐标并不是独立的，而是通过一个或多个约束方程相互关联。

可以通过将约束力从运动方程中消除，使得只剩下非约束力，或者通过在运动方程中包含约束方程来包含约束力。
\subsubsection{达朗贝尔原理}
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/2ae163ebf41389ea.png}
\caption{让·达朗贝尔（1717—1783）} \label{fig_LGL_5}
\end{figure}
分析力学中的一个基本结果是达朗贝尔原理，该原理由雅克·伯努利于1708年提出，用于理解静态平衡，并由达朗贝尔于1743年发展以解决动力学问题。该原理断言，对于 \(N\) 个粒子，虚功，即沿虚位移 \(\delta \mathbf{r}_k\) 的功，为零：
\[
\sum_{k=1}^{N}(\mathbf{N}_{k}+\mathbf{C}_{k}-m_{k}\mathbf{a}_{k}) \cdot \delta \mathbf{r}_{k} = 0.~
\]
\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/4c098c351c13f52a.png}
\caption{约束力 \(C\) 和位于曲线上的质量为 \(m\) 的粒子的虚位移 \(\delta \mathbf{r}\)。合成的非约束力为 \(N\)。} \label{fig_LGL_6}
\end{figure}
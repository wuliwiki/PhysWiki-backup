% 手算开根号

\subsection{试根法}

\begin{example}{}
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/Hsqrt_1.pdf}
\caption{手动开根号的例子， 计算 $\sqrt{21}$} \label{Hsqrt_fig1}
\end{figure}
作为一个例子， 我们来计算 $\sqrt{21}$． 
\end{example}


若我们要算 $s^2$ 的开根号， 并假设 $s$ 的 $n$ 位有效数字近似为 $s_n$， 例如 $s = \sqrt{2} = 1.414213562\dots$， 则 $s_1 = 1$， $s_2=1.4$， $s_3=1.41$，……
\begin{equation}
s^2 = s_1^2 + (s_2+s_1)(s_2-s_1) + (s_3+s_2)(s_3-s_2) + \dots
\end{equation}
现在， 第 $i$ 位有效数字（小数点位置不变）为 $d_i = s_i-s_{i-1}$， 且 $d_1 = s_1$， 易得
\begin{equation}
s^2 = d_1^2 + (2s_1 + d_2)d_2 + (2s_2 + d_3)d_3 + \dots
\end{equation}
现在， 若已知 $s^2$， 我们就可以先试出最大的 $d_1$， 满足 $d_1^2\leqslant s^2$． 然后再试出最大的 $d_2$， 满足 $(2s_1 + d_2)d_2 \leqslant s^2 - d_1^2$， 以此类推就可以求出任意位的小数．


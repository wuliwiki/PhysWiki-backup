% 球贝塞尔函数
% 球贝塞尔方程|球贝塞尔函数|修正球贝塞尔函数

\pentry{贝塞尔函数\upref{Bessel}}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Bessel_function}{相关页面}．}\textbf{球贝塞尔方程（spherical Bessel's equation）}为
\begin{equation}
x^2 \dv[2]{y}{x} + 2x \dv{y}{x} + [x^2 - n(n + 1)]y = 0
\end{equation}
\begin{figure}[ht]
\centering
\includegraphics[width=14.25cm]{./figures/SphBsl_1.pdf}
\caption{球贝塞尔函数和球汉克尔函数（来自 Wikipedia）} \label{SphBsl_fig1}
\end{figure}
两个线性无关的解分别为第一类球贝塞尔函数 $j_n(x)$ 和第二类球贝塞尔函数 $y_n(x)$， 见\autoref{SphBsl_fig1}． 它们可以通过贝塞尔函数\upref{Bessel} $J$， $Y$ 来定义
\begin{equation}
j_n(x) = \sqrt{\frac{\pi}{2x}} J_{n+1/2}(x)
\qquad
y_n(x) = \sqrt{\frac{\pi}{2x}} Y_{n+1/2}(x)
\end{equation}
同样也可以定义两类\textbf{球汉克尔函数（spherical Hankel's function）}
\begin{equation}
h_n^{(1)}(x) = \sqrt {\frac{\pi }{2x}} H_{n+1/2}^{(1)}(x) = j_n(x) + \I y_n(x)
\end{equation}
\begin{equation}
h_n^{(2)}(x) = \sqrt{\frac{\pi }{2x}} H_{n+1/2}^{(2)}(x) = j_n(x) - \I y_n(x)
\end{equation}
另一种等效的定义方式使用 \textbf{Rayleigh's 方程}
\begin{equation}
j_n(x) = (-x)^n \qty(\frac{1}{x} \dv{x})^n \frac{\sin x}{x}
\end{equation}
\begin{equation}
y_n(x) = -(-x)^n \qty(\frac{1}{x} \dv{x})^n \frac{\cos x}{x}
\end{equation}
$n$ 为整数的球贝塞尔函数都可以用正弦余弦函数表示， 例如
\begin{align}
&j_0(x) = \frac{\sin x}{x}\\
&j_1(x) = \frac{\sin x}{x^2} - \frac{\cos x}{x}\\
&j_2(x) = \qty(\frac{3}{x^2} - 1) \frac{\sin x}{x} - \frac{3\cos x}{x^2}\\
&j_3(x) = \qty(\frac{15}{x^3} - \frac{6}{x})\frac{\sin x}{x} - \qty(\frac{15}{x^2}-1)\frac{\cos x}{x}
\end{align}
\begin{align}
&y_0(x) = -\frac{\cos x}{x}\\
&y_1(x) = -\frac{\cos x}{x^2} - \frac{\sin x}{x}\\
&y_2(x) = \qty(-\frac{3}{x^2}+1)\frac{\cos x}{x} - \frac{3\sin x}{x^2}\\
&y_3(x) = \qty(-\frac{15}{x^3}+\frac{6}{x}) \frac{\cos x}{x} - \qty(\frac{15}{x^2} - 1)\frac{\sin x}{x}
\end{align}
更多项可以用 Mathematica 命令如\footnote{笔者也不明白为什么要这么做．}
\begin{lstlisting}[language=Mathematica]
l = 4; Series[SphericalBesselJ[l, x], {x, \[Infinity], 1000}] // 
  Normal // Simplify
\end{lstlisting}

\subsection{性质}
一阶导数（ $f$ 是 $j, y, h^{(1)}, h^{(2)}$ 中的任意一种）
\begin{equation}
f'_n(z) = f_{n-1}(z) - \frac{n+1}{z} f_n(z)
\end{equation}
渐进形式
当 $x \gg 1$ 时， 球贝塞尔函数的渐进表达式为
\begin{equation}\label{SphBsl_eq2}
j_l(x) \to \sin(x - l\pi /2)/x
\qquad
y_l(x) \to  - \cos(x - l\pi /2)/x
\end{equation}
\begin{equation}
h_l^{(1)}(x) \to ( -\I)^{l+1} \E^{\I x}/x
\qquad
h_l^{(2)}(x) \to \I^{l + 1} \E^{-\I x}/x
\end{equation}
由渐进形式可得径向归一化积分为（以 $j_l$ 为例， 推导见\autoref{Delta_eq9}~\upref{Delta}）
\begin{equation}
\begin{aligned}
\int_0^\infty k'j_l(k'r) \cdot kj_l(kr) r^2 \dd{r} &= \int_0^\infty \sin(k'r - l\pi/2)\sin(kr - l\pi/2) \dd{r}\\
& = \frac{\pi}{2}[\delta(k'-k) - \delta(k'+k)]
\end{aligned}
\end{equation}

\subsection{修正球贝塞尔函数}

\textbf{修正球贝塞尔方程}为
\begin{equation}
x^2 \dv[2]{y}{x} + 2x\dv{y}{x} - [x^2 + n(n + 1)]y = 0
\end{equation}
两个线性无关解称为\textbf{第一类修正球贝塞尔函数（modified spherical Bessel function of the first kind）}和\textbf{第二类修正球贝塞尔函数}
\begin{equation}
i_n(x) = \sqrt{\frac{\pi }{2x}} I_{n+1/2}(x) = \I^{-n} j_n(\I x)
\end{equation}
\begin{equation}\label{SphBsl_eq1}
k_n(x) = \sqrt{\frac{2}{\pi x}} K_{n+1/2}(x) = \frac{\pi }{2} \I^{n + 2} h_n^{(1)}(\I x)
\end{equation}
渐进形式为
\begin{equation}
i_n(x) \to \frac{\E^x}{2x}
\qquad
k_n(x) \to \frac{\pi}{2} \frac{\E^{-x}}{x}
\end{equation}

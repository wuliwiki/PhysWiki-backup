% 全同粒子
% 量子力学|交换算符|对易|哈密顿|玻色子|费米子
\pentry{多体量子力学简介% 未完成： 应该引用什么词条呢？ 这应该是二级词条， 是否引用一级词条？
， 正交子空间\upref{OrthSp}， 厄米矩阵的本征问题\upref{HerEig}}

在量子力学中， 我们假设许多基本粒子是不可区分的， 例如电子，质子，中子等， 我们把不可区分的粒子称为是\textbf{全同粒子（identical particles）}． 例如我们在两个位置同时测量到两个电子， 我们只能知道两处各有一个电子， 而不知道哪个电子在哪里． 对于宏观物体， 我们可以通过做标记或者追踪轨迹的方式轻易把不同它们区分开． 但量子力学中的粒子既不能做标记也没有轨迹的概念， 所以我们唯一可以区分的粒子的方法就是利用它们的物理属性， 如质量，电荷量，自旋等物理性质．

如果把双粒子波函数（方便起见先不考虑自旋），我们如何用它们的波函数体现 “不可区分” 这一性质呢？ 先写出位置表象下的双电子波函数为 $\psi(\bvec r_1, \bvec r_2)$， 那么在任意两点同时发现两个电子的概率为
$$
f(\bvec r_1, \bvec r_2) = \abs{\psi(\bvec r_1, \bvec r_2)}^2
$$
由于两电子不可区分， 概率分布必须满足 $f(\bvec r_1, \bvec r_2) = f(\bvec r_1, \bvec r_2)$． 于是波函数必须满足以下两个条件之一
\begin{equation}
\psi(\bvec r_1, \bvec r_2) = \pm \psi(\bvec r_2, \bvec r_1)
\end{equation}
如果取正号， 我们把这样的波函数称为\textbf{对称的（symmetric）}， 取负号时则称为\textbf{反对称的（antisymmetric）}．

以后会看到， 具有交换对称或反对称的波函数在根据薛定谔方程演化的过程中一直会保持对称性． 波函数的两种交换对称性会带来实验上可观测的结果， 大量实验表明， 我们可以把所有全通粒子划分为两类， \textbf{玻色子（Boson）} 的波函数总是对称的， \textbf{费米子（Fermion）}的波函数总是不对称的．

\subsection{考虑自旋}
\pentry{角动量加法（量子力学）\upref{AMAdd}}

如果只考虑双粒子的自旋态空间， 全同粒子同样要求在该空间的状态满足交换对称． 以最常见的电子态为例， 单电子自旋态是一个二维空间， 两个基底通常取 $\uparrow$ 和 $\downarrow$， 分别代表 $\ket{s=1/2,m_s=\pm 1/2}$． 而双粒子的自旋态是该空间和自己的张量积， 是 4 维的， 基底可以取 $\uparrow\uparrow, \uparrow\downarrow, \downarrow\uparrow, \downarrow\downarrow$ 四个． 但第二和第三个既不满足交换对称也不是反对称的． 所以我们可以将四个基底改为
\begin{equation}
\uparrow\uparrow \qquad \frac{1}{\sqrt 2}(\uparrow\downarrow \pm \downarrow\uparrow) \qquad \downarrow\downarrow
\end{equation}
其中三个基底是对称的， 叫做三重态（triplet）， 一个是反对称的， 叫做 singlet． 显然，三个对称基底的任意线性组合都是对称的自旋态（3 维子空间）， 但反对称的态只有一个．

当我们考虑两个粒子的总状态时， 我们可以把总空间视为双粒子波函数空间和双粒子自旋态空间的张量积空间． 量子力学假设玻色子和费米子分别在总空间中具有交换对称或反对称的．

例如两电子的自旋处于 singlet 态， 由于电子是费米子， 那么波函数就必须是对称的． 反之如果两电子处于三重态， 那么波函数必须是反对称的．

\subsection{粒子交换算符}

对双粒子系统， 不考虑自旋， 定义\textbf{粒子交换算符（particle exchange operator）}为（先不考虑自旋）
\begin{equation}\label{IdPar_eq3}
P_{1,2}\psi(\bvec r_1, \bvec r_2) = \psi(\bvec r_2, \bvec r_1)
\end{equation}
可以证明这是一个厄米算符， 即
\begin{equation}
\braket{\phi}{P_{1,2}\psi} = \braket{P_{1,2}\phi}{\psi}
\end{equation}
不难证明该算符有且只有 $1$ 和 $-1$ 两个本征值， 根据厄米算符本征方程的性质\upref{HerEig}， 对应的本征矢空间是两个\textbf{互补的正交子空间}\upref{OrthSp}， 量空间分别由对称波函数和反对称波函数（以下分别记为 $\psi_+$ 和 $\psi_-$）的集合构成， 即满足
\begin{equation}
\psi_\pm(\bvec r_2, \bvec r_1) = \pm\psi_\pm(\bvec r_1, \bvec r_2)
\end{equation}
这两个子空间外的波函数既非对称也非反对称．

若粒子算符作用在某自旋态 $\ket{m_{s1}}\ket{m_{s2}}$ 上， 那么只需要把第一个态和第二个态互换， 即 $\ket{m_{s2}}\ket{m_{s1}}$．

那么一般来说我们如何定义双粒子态空间中的交换算符呢？ 我们只需要找到一组单粒子的基底 $\qty{\ket{i}}$， 张量积中的基底取 $\qty{\ket{i}\ket{j}}$ 将双粒子态根据该基底展开， 再将每个基底替换为 $\qty{\ket{j}\ket{i}}$ 即可．
\begin{equation}\label{IdPar_eq4}
P \sum_{i,j} C_{i,j} \ket{i}\ket{j} = \sum_{i,j} C_{i,j} \ket{j}\ket{i} = \sum_{i,j} C_{j,i} \ket{i}\ket{j}
\end{equation}
例如在\autoref{IdPar_eq3} 中， 单粒子的位置本征态基地记为 $\ket{\bvec r}$， 张量积空间的基底记为 $\ket{\bvec r_1}\ket{\bvec r_2}$， 那么\autoref{IdPar_eq4} 中求和变为积分

\subsection{与哈密顿算符对易}

\pentry{守恒量（量子力学）\upref{QMcons}}
对于全同粒子， 交换算符与哈密顿算符对易\footnote{对非全同粒子则不成立， 例如两个质量不同的粒子的动能算符与交换算符不对易}． 这保证了 $P$ 是一个守恒量． 也就是全同粒子的波函数在按照薛定谔方程演化过程中将一直保持对称性或反对称性．

\subsection{对称化和反对称化}
如果给定一个多粒子波函数不是所有粒子交换算符的本征值．

% \subsection{对称和反对称子空间的维度}

% 单粒子的自旋态的一组基底是 $\qty{\ket{s, m_s}}$， 其中 $-s \le m_s \le s$， 即空间的维数为 $2s+1$． 那么可区分的双粒子所在的自旋态就是该空间和自己的张量积空间， 如果它们自旋相同， 令 $s = s_1 = s_2$， 则维数为 $(2s+1)^2$， 基底可以记为（省略 $s$ 方便书写） $\ket{m_{s1}}\ket{m_{s2}}$．

% 如果只考虑自旋态的交换对称

%代表  $\uparrow\uparrow$ 代表两个电子都处于上旋本征态 $\ket{s=1/2,m_s=1/2}$， 显然是对称的， 而 $\uparrow\downarrow$ 代表一个上旋一个下旋， 粒子交换后变为 $\downarrow\uparrow$ 既不对称也不是反对称．

% 如果考虑自旋， 单个粒子的状态所在的空间是波函数和自旋态所在的希尔伯特空间的张量积空间\upref{Tensor}， 也是希尔伯特空间． 而多个粒子状态所在的空间又是单粒子态空间的张量积． 例如双粒子的状态就是四个空间的张量积， 为了方便， 我们往往会先对两个波函数空间做张量积， 得到双粒子波函数

\subsection{本征态与测量}
两个全同粒子的本征态（或者其他任何态）也必须是必须是对称或反对称的， 例如位置本征态
$$\frac{1}{\sqrt 2}[\delta_{\bvec r_a}(\bvec r_1) \delta_{\bvec r_b}(\bvec r_2)\pm \delta_{\bvec r_b}(\bvec r_1) \delta_{\bvec r_a}(\bvec r_1)]$$
只能告诉我们一个粒子在 $\bvec r_a$ 处另一个粒子在 $\bvec r_b$ 处， 仍然不能区分它们．

于是根据测量理论， 我们仍然要将总波函数投影到本征态上去． 例如位置的概率分布为
\begin{equation}\label{IdPar_eq1}
\begin{aligned}
f(\bvec r_1, \bvec r_2) &= \abs{\frac{1}{\sqrt{2}}\int [\delta_{\bvec r_1}(\bvec r'_1) \delta_{\bvec r_2}(\bvec r'_2) \pm \delta_{\bvec r_2}(\bvec r'_1) \delta_{\bvec r_1}(\bvec r'_2)] \psi_\pm(\bvec r'_1,\bvec r'_2) \dd[3]{r'_1}\dd[3]{r'_2}}^2\\
&= \abs{\frac{1}{\sqrt{2}} \psi_\pm(\bvec r_1, \bvec r_2) \pm  \frac{1}{\sqrt{2}} \psi_\pm(\bvec r_2, \bvec r_1)}^2\\
&= \abs{\frac{1}{\sqrt{2}} \psi_\pm(\bvec r_1, \bvec r_2) +  \frac{1}{\sqrt{2}} \psi_\pm(\bvec r_1, \bvec r_2)}^2\\
&= 2\abs{\psi_\pm(\bvec r_1, \bvec r_2)}^2
\end{aligned}
\end{equation}
注意该式中 $f(\bvec r_1, \bvec r_2)$ 不区分 $\bvec r_1, \bvec r_2$ 的顺序． 也就是说 $f(\bvec r_1, \bvec r_2)$ 告诉我们一个粒子在 $\bvec r_1$， 另一个在 $\bvec r_2$ 的概率密度．

对应地， 在做归一化时， 一种方法是先对所有变量在全部范围积分再除以 $2$， 因为每一个 $f(\bvec r_1, \bvec r_2)$ 都重复计算了 $f(\bvec r_2, \bvec r_1)$， 归一化条件
\begin{equation}\label{IdPar_eq2}
\frac{1}{2}\int f(\bvec r_1, \bvec r_2) \dd[3]{r_1}\dd[3]{r_2} = \int \abs{\psi_\pm(\bvec r_1, \bvec r_2)}^2 \dd[3]{r_1}\dd[3]{r_2} = 1
\end{equation}

另一种方法是不除二， 而是选取上式积分范围的一半使得对任何 $f(\bvec r_1, \bvec r_2)$， $f(\bvec r_2, \bvec r_1)$ 不会被重复计算， 在一维运动情况下， 我们可以只对 $r_1, r_2$ 平面满足 $r_1 < r_2$ 的一半积分． 在多维运动时， 我们只需要选取任意一个坐标， 例如令 $y_1 < y_2$ 即可将整个积分范围划分为满足要求的两半\footnote{也可以使用任何可以区分粒子交换的条件， 例如 $x_1^2 + y_1^2 + z_1^2 < x_2^2 + y_2^2 + z_2^2$， 将角标 $1$ 和 $2$ 互换后， 两条不等式只能满足一条．}．

\begin{example}{单粒子位置分布}\label{IdPar_ex1}
若两个全同粒子的波函数为 $\psi(\bvec r_1,\bvec r_2)$， 求单个粒子的位置分布 $P(\bvec r)$． 注意我们并不能求 $P(\bvec r_1)$ 或者 $P(\bvec r_2)$．

我们只需要将\autoref{IdPar_eq1} 对其中一个 $\bvec r$ 全空间积分即可
\begin{equation}
P(\bvec r) = \int P(\bvec r, \bvec r') \dd[3]{r'} = 2\int \abs{\psi_\pm(\bvec r, \bvec r')}^2 \dd[3]{r'} 
\end{equation}
根据\autoref{IdPar_eq2}， $\int P(\bvec r) \dd[3]{r} = 2$ 而不是 $1$， 这并没有问题， 因为空间中共有两个粒子．
\end{example}

\subsubsection{一般投影}
类比\autoref{IdPar_eq1} 可以发现， 将任何对称或反对称的波函数投影到形式为
\begin{equation}
[\phi_1(\bvec r_1)\phi_2(\bvec r_2) \pm \phi_2(\bvec r_1)\phi_1(\bvec r_2)]/\sqrt{2}
\end{equation}
且具有相同交换对称性的波函数上， 都会得到相同的两项\footnote{如果投影到对称性相反的波函数上， 结果为零}． 所以为了方便计算， 我们可以只投影到第一项 $\phi_1(\bvec r_1)\phi_2(\bvec r_2)$ 上， 再乘以 $\sqrt{2}$ 即可．

% 未完成：以下转自 docx，有待整理
\subsection{算符}
现在来看上述的对称或反对称空间允许什么样的算符， 即什么算符在这两个子空间是闭合的． 闭合是指算符作用完后仍然落在同一空间， 即
\begin{equation}
P_{1,2}\Omega\ket{\Psi} = \pm \Omega \ket{\Psi}
\end{equation}
即所有满足 $P_{1,2}\Omega = \pm \Omega$ 的算符．

首先， 同一个单粒子算符对所有粒子作用之和满足该条件， 例如总动能 $T = T_1 + T_2$． 满足 $P_{1,2}T = T$． 又例如外势能（非相互作用势能） $V = V(\bvec r_1) + V(\bvec r_2)$． 不允许单独出现单粒子算符， 例如 $V(\bvec r_1)$．

同理， 不允许出现不同的算符分别作用于两粒子 $U_1 + V_2$．

从物理意义上来说， 就是不允许出现任何可以区分两个全同粒子的算符． 因为全同粒子绝对不可区分，所以任何作用（算符）不可能对两个全同粒子具有不同的形式．

另一类允许的算符是多粒子算符， 例如两粒子间的相互作用 $V(\bvec r_1, \bvec r_2) = V(\abs{\bvec r_2 - \bvec r_1})$．

\subsection{可分离哈密顿}
在对称或反对称子空间中， 如果总哈密顿量可以写成各个粒子的哈密顿量之和 $H = \sum H_i$， (注意 $H_i$ 对每个粒子的形式必须一样)， 则可先计算单个粒子的本征方程 $H_i \ket{\psi_{in}} = E_{in}\ket{\psi_{in}}$ (对任何 $i$ 形式都一样)， 总能量为 $E_{n_1,n_2,\dots} = \sum_i E_{n_i}$ ， 总波函数为Slater行列式（费米子）以及对称化算符（玻色子）， 双粒子系统中即 $(\ket{\psi_i}\ket{\psi_j} \pm \ket{\psi_j}\ket{\psi_i})/\sqrt{2}$．

双粒子系统的证明： $\ket{\psi_i}$ 是单粒子薛定谔方程的波函数， 可区分双粒子的完备基底为 $\ket{\psi_j}\ket{\psi_i}$ ， 但这些基底中只有 $\ket{\psi_k}\ket{\psi_k}$ 落在玻色子子空间， 剩下的基底都不是 $P_{1,2}$ 的本征值． 为了构建对称和反对称子空间， 先把所有 $i \ne j$ 的基底分为成对的 $\ket{\psi_i}\ket{\psi_j}$ $\ket{\psi_j}\ket{\psi_i}$， 把每一对分别相加和相减再归一化得到许多对新的基底 $(\ket{\psi_i}\ket{\psi_j} \pm \ket{\psi_j}\ket{\psi_i})/\sqrt{2}$ (显然这么做不失完备性)， 不难看出， 所有含加号的基底张成完备的双波色子空间， 所有含减号的基底张成完备的双费米子空间． 这说明在双粒子系统中， 全空间等于对称子空间和反对称子空间的直和 （即两个子空间的基底一起张成全空间）． 然而对多粒子系统， 这并不成立， 但用Slater行列式和 “正Slater行列式” 得到的两组基底仍然是完备的． 继续双粒子的情况， 现在证明上面得到的两个子空间的基底已经是总哈密顿量的本征矢了
\begin{equation}
\begin{aligned}
(H_1 + H_2) (\ket{\psi_i}\ket{\psi_j} \pm \ket{\psi_j}\ket{\psi_i}) &= E_i \ket{\psi_i}\ket{\psi_j} \pm E_j \ket{\psi_j}\ket{\psi_i} + E_j \ket{\psi_i}\ket{\psi_j} \pm E_i \ket{\psi_j}\ket{\psi_i}\\
&= (E_i + E_j) (\ket{\psi_i}\ket{\psi_j} \pm \ket{\psi_j}\ket{\psi_i})
\end{aligned}
\end{equation}

证毕．
多维的情况可以用对称和反对称算符的运算证明，（详见 Bransden）．

\subsection{可分离态的时间演变}
从物理意义上来看， 可分离变量意味着粒子间没有相互作用， 例如 $V(\abs{\bvec r_i, \bvec r_j})$ 项． 那么没有相互作用的两个粒子是否需要对称化或反对称化呢？ 如果需要， 那么原则上我们将要把全宇宙所有的全同粒子（反）对称化！ 这是一定要的， 因为量子力学对全同粒子的基本假设就是态矢只能落在对称空间或反对称空间， 这两个空间之外的所有态矢不可能存在， 它们违反了全同粒子假设！ 另外， $\bvec r_1, \bvec r_2$ ， 这些角标只是符号工具， 二次量子化中将彻底抛弃角标．

根据所有全同粒子对称化的原理， 看两个粒子的波函数 $(\ket{\psi_1}\ket{\psi_2} \pm \ket{\psi_2}\ket{\psi_1})/\sqrt{2}$， 如果 $(\ket{\psi_i}$ 与 $\ket{\psi_j}$ 相距很远， 波函数完全没有重合， 时刻 $t_1$ 在 $\ket{\psi_1}$ 的附近测到一个粒子， 然后时刻 $t_2$ 在 $\ket{\psi_2}$ 范围测到一个粒子， 能不能说这是刚才的粒子呢？ 不能！ 只能说全宇宙有 $N$ 个这种粒子， $t_1$ 的时候其中一个在 $\ket{\psi_1}$ 附近， $t_2$ 的时候其中一个在 $\psi_2$ 附近．

% 球极平面投影
% license CCBYSA3
% type Wiki

（本文根据 CC-BY-SA 协议转载自原搜狗科学百科对英文维基百科的翻译）

在几何中，球极平面投影是一种将圆球面投影到平面上的特殊映射(函数)。该映射的定义域为除投影点外的整个球面。在定义域内，该映射具有光滑性、双射性和共形性。共形性意味着其为保持曲线相交角度不变的映射。但是，该映射既不保距离也不保面积：也就是说，其既不能维持映射后图形的距离不变，也不能维持映射后图形的面积不变。

直观地说，球极平面投影是一种用平面来描绘球面的方法，但该方法在图案品质方面，也包含一些不可避免的妥协。因为球面和平面出现于数学及其应用的诸多领域，所以球极平面投影也同样很常见。在各个领域，例如复分析、制图学、地质学、摄影等，球极平面投影都有广泛的应用。在实践中，球极平面投影通常是通过计算机或手工在一种称为立体球面投影网的特殊的方格纸上绘制完成，该立体球面投影网简称立体网，或乌尔夫网。

\subsection{历史}
\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/cdf5afd3b6eb90c9.png}
\caption{鲁本斯(Rubens)为弗朗索瓦·达吉隆(François d'Aguilon)的著作《光学六册：适用于哲学家和数学家》所作的插图。该图展现了一般透视投影的原理，球极平面投影是其中一种特殊情况。} \label{fig_QJPMTY_2}
\end{figure}
球极平面投影为希帕克斯(Hipparchus)、托勒密(Ptolemy)，甚至可能更早期的古埃及人所知。其最初被称为“平面天体投影”。[1] 托勒密的著作《平球论》（Planisphaerium）是现存最古老的描述球极平面投影的文献，其最重要的用途之一就是描绘天体图。[1] “平面天体投影”这个术语仍然用于指代这样的图表。

在16世纪和17世纪，球极平面投影的赤道面通常被用于东半球和西半球地图上。通常认为，1507年瓜尔特里厄斯·路德(Gualterius Lud)绘制的地图[2] 使用的就是球极平面投影，包括后来的让·罗兹(Jean Roze)(1542年)、鲁莫尔德·墨卡托(Rumold Mercator)(1595年)，以及其他许多人绘制的地图。[3] 而在星图上，这个赤道面也已经被像托勒密这样的古代天文学家利用了。[4]

弗朗索瓦·德阿吉隆(François d'Aguilon)在他1613年的著作《光学六册：适用于哲学家和数学家》（Opticorum libri sex philosophis juxta ac mathematicis utiles）中给球极平面投影取了现在的名字。[5]

1695年，在兴趣的驱使下，埃德蒙多·哈雷(Edmond Halley)发表了第一篇关于星图共形性的数学证明。[6] 在证明中，他使用了由他的朋友艾萨克·牛顿(Isaac Newton)在当时刚刚建立起来的微积分工具。

\subsection{定义}
\subsubsection{2.1 第一类计算公式}
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/82c46f88c891178f.png}
\caption{单位球面上从北极点向z = 0 平面的球极平面投影的截面示意图} \label{fig_QJPMTY_1}
\end{figure}
三维空间 $\mathbb{R}^3$ 中的单位球面是一组点 $(x, y, z)$ 的集合，且满足 $x^2 + y^2 + z^2 = 1$。如果令点 $N = (0, 0, 1)$ 为该球面上的“北极点”，令球面的其余部分为 $M$，则 $z = 0$ 平面穿过该球面所包裹的球体的中心，“赤道”就是球面与 $z = 0$ 平面的交线。

对于 $M$ 上的任意一点 $P$，有且仅有一条直线穿过 $N$ 和 $P$ 点，且这条线与 $z = 0$ 平面相交于 $P'$ 点。定义 $P$ 点在 $z = 0$ 平面上的球极平面投影为 $P'$ 点。

在笛卡尔坐标系中，球面上的坐标 \((x, y, z)\) 与对应的平面上的坐标 \((X, Y)\) 满足以下投影及其逆投影关系式：
$$(X, Y) = \left( \frac{x}{1 - z}, \frac{y}{1 - z} \right),~$$
$$(x, y, z) = \left( \frac{2X}{1 + X^2 + Y^2}, \frac{2Y}{1 + X^2 + Y^2}, \frac{-1 + X^2 + Y^2}{1 + X^2 + Y^2} \right).~$$
在球面坐标系中，球面上的坐标 \((\varphi, \theta)\)（用 \(\varphi\) 表示天顶角， \(0 \leq \varphi \leq \pi\)；用 \(\theta\) 表示方位角， \(0 \leq \theta \leq 2\pi\)）与对应的平面上的极坐标 \((R, \Theta)\) 满足以下投影及其逆投影关系式：
$$(R, \Theta) = \left( \frac{\sin \varphi}{1 - \cos \varphi}, \theta \right) = \left( \cot \frac{\varphi}{2}, \theta \right),~$$
$$(\varphi, \theta) = \left( 2 \arctan \frac{1}{R}, \Theta \right).~$$
这里，定义当 \(R = 0\) 时 \(\varphi = \pi\)。此外，可以用与上述公式等价的方式将这些公式改写为多种不同的形式。在圆柱坐标中，球面上的坐标 \((r, \theta, z)\) 与对应的平面上的极坐标 \((R, \Theta)\) 满足以下投影及其逆投影关系式：
$$(R, \Theta) = \left( \frac{r}{1 - z}, \theta \right),~$$
$$(r, \theta, z) = \left( \frac{2R}{1 + R^2}, \Theta, \frac{R^2 - 1}{R^2 + 1} \right).~$$
\subsubsection{2.2 其他约定形式}
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/e15da8788802fff9.png}
\caption{单位球面上从北极点向z = −1 平面的球极平面投影的截面示意图} \label{fig_QJPMTY_3}
\end{figure}
一些作者[7] 将球极平面投影定义为从单位球面上的北极点 (0, 0, 1) 向z = −1 平面的投影，该平面与单位球面的南极点(0, 0, −1) 相切。这种极点切面所得到的$X$ 和$Y$ 的坐标值恰好是上一节描述的赤道平面投影坐标值的两倍。例如，该投影将赤道映射为以原点为中心，半径为2的圆。可以看出，赤道平面投影在赤道上不会产生无穷小的面积变形，而极点切面投影在南极不会产生无穷小的面积变形。

还有其他一些作者[8] 使用半径为12 的球面和z = − 12 平面来定义球极平面投影。在这种情况下，计算公式为：
$$(x, y, z) \rightarrow (\xi, \eta) = \left( \frac{x}{\frac{1}{2} - z}, \frac{y}{\frac{1}{2} - z} \right),~$$
$$(\xi, \eta) \rightarrow (x, y, z) = \left( \frac{\xi}{1 + \xi^2 + \eta^2}, \frac{\eta}{1 + \xi^2 + \eta^2}, \frac{-1 + \xi^2 + \eta^2}{2 + 2\xi^2 + 2\eta^2} \right).~$$
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/48e37b5bfaa0f634.png}
\caption{从球面上一点Q 向平面E 的球极平面投影的截面示意图} \label{fig_QJPMTY_4}
\end{figure}
一般来说，可以用从球面上的任意一点$Q$ 向任意平面$E$的投影来定义球极平面投影，只需要满足：
\begin{itemize}
\item 平面$E$垂直于穿过$Q$点的直径；
\item 平面$E$中不包含$Q$点。
\end{itemize}
那么在这种情况下，对于球面上除$Q$ 点以外的任意一点$P$，穿过$P$点和$Q$ 的直线将与平面$E$相交于P′点，而P′点就定义为$P$点在平面$E$上的球极平面投影。[9]
\subsubsection{2.3 一般化}
更一般地，球极平面投影可以应用于 $(n + 1)$ 维欧几里得空间 \(E^{n+1}\) 中的 \(n\) 维球体 \(S^n\) 上。假设 \(Q\) 是 \(n\) 维球体 \(S^n\) 上的一点，且 \(E\) 为 \(E^{n+1}\) 空间中的一个超平面，那么球面上一点 \(P \in S^n - \{Q\}\) 的球极平面投影 \(P'\) 就是直线 \(QP\) 与超平面 \(E\) 的交点。如果从点 \(Q = (1, 0, 0, \ldots, 0)\) 进行投影，那么在笛卡尔坐标系中，球面上点的坐标 \((x_i; i = 0, 1, 2, \ldots, n)\) 与对应的平面上的点的坐标 \((X_i; i = 1, 2, \ldots, n)\) 之间的投影关系由下式给出：
$$X_i = \frac{x_i}{1 - x_0} \quad (i = 1, 2, \ldots, n)~$$
如果定义：
$$S^2 = \sum_{j=1}^n x_j^2~$$
则逆投影关系可由下式给出：
$$x_0 = \frac{S^2 - 1}{S^2 + 1}; \quad x_i = \frac{2X_i}{S^2 + 1} \quad (i = 1, 2, \ldots, n)~$$
更一般地，假设 \(S\) 是射影空间 \(P^{n+1}\) 中的一个（非奇异）二次超曲面。换句话说，\(S\) 是非奇异二次型 \(f(x_0,  \ldots, x_{n+1})\) 在齐次坐标 \(x_i\) 中的零轨迹。固定 \(S\) 上的任何一点 \(Q\) 以及 \(P^{n+1}\) 中一个不包含 \(Q\) 点的超平面 \(E\)。那么 \(S - \{Q\}\) 上任意一点 \(P\) 的球极平面投影就是 \(QP\) 与 \(E\) 的唯一交点。和前面一样，球极平面投影在“小”集合之外是共形且可逆的。球极平面投影将二次超曲面表示为有理超曲面。这种结构在代数几何和共形几何中发挥了重要作用。
\begin{figure}[ht]
\centering
\includegraphics[width=14.25cm]{./figures/651e7d362fdc1275.png}
\caption{立体投影和一些方位投影的比较，以相同比例的90° N为中心，按地球半径投影高度排序。(click for detail)} \label{fig_QJPMTY_5}
\end{figure}

\subsection{性质}
前面部分定义的第一个球极平面投影方法是将单位球面的“南极点”(0, 0, −1)映射到平面上的(0, 0)点，将赤道映射到平面上单位圆，南半球面映射到单位圆内区域，北半球面映射到单位圆外区域。

该投影方法在投影点$N = (0, 0, 1)$ 处无定义。该点的小邻域被映射到远离(0, 0)点的平面子集内。$P$点离(0, 0, 1)点越近，其在平面上的投影点就离(0, 0)点越远。由于这个原因，通常会把(0, 0, 1)点映射到平面上的“无穷远”处，通过添加无穷远点实现完整的球面到平面的映射。这个概念在射影几何和复分析中很有用。仅在拓扑层面上，它说明了球面如何与平面的单点紧化同胚。

笛卡尔坐标中，对于球面上一个点 $P(x, y, z)$ 与对应的平面上的点 P′(X, Y) ，要么两者都是有理点，要么都不是:
\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/6155326af1ce57ed.png}
\caption{平面上的笛卡尔坐标网格在球面上出现了扭曲。虽然各个曲线之间依然保持垂直，但是各个网格方块的面积随着向北极点的靠近而收缩。} \label{fig_QJPMTY_6}
\end{figure}
$$P \in \mathbb{Q}^3 \Longleftrightarrow P' \in \mathbb{Q}^2~$$
球极平面投影是共形的（保角），这意味着其能保持在映射前后曲线的相交角度不变（见图）。另一方面，球极平面投影不维持面积不变；一般来说，球面上的一个区域的面积不等于它投影到平面上之后的面积。坐标 (X, Y) 处的面积微元可以根据下式计算得到：
$$\mathrm{d}A = \frac{4}{(1 + X^2 + Y^2)^2} \mathrm{d}X \, \mathrm{d}Y~$$
沿着单位圆 \(X^2 + Y^2 = 1\)，在该单位圆上没有区域膨胀，比例因子为1。接近 (0,0) 点的区域面积膨胀系数为4，而接近无限远处的面积膨胀系数为无穷小。
\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/5b066300f54300b7.png}
\caption{平面上的极坐标网格在球面上出现了扭曲。虽然各个曲线之间依然保持垂直，但是各个网格扇区的面积随着向北极点的靠近而收缩。} \label{fig_QJPMTY_7}
\end{figure}
在坐标 (X, Y) 处给出的度量可以根据下式计算得到：
$$\frac{4}{(1 + X^2 + Y^2)^2} (\mathrm{d}X^2 + \mathrm{d}Y^2),~$$
该公式最早出现于波恩哈德·黎曼(Bernhard Riemann)教授在几何基础的教授资格论文中，于1854年在哥廷根提交，标题为《论作为几何基础的假设》（Über die Hypothesen welche der Geometrie zu Grunde liegen）。

从球面到平面的映射不能既保角又保面积。如果要实现既保角又保面积，那么它将是一个局部等距图，并将保高斯曲率。而球面和平面有着不同的高斯曲率，所以球面到平面的映射不可能既保角又保面积。

球面上不通过投影点的圆被投影为平面上的圆。球面上通过投影点的圆被投影为平面上的直线。这些直线有时被认为是通过无穷远点的圆，或半径为无穷大的圆。

平面上的所有直线，通过球极平面投影的逆变换为球面上的圆后，都相交于投影点。平面内不相交的平行线则变换为在投影点处相切的圆。而平面内的相交线变换为球面上相交于两个点的圆，其中一个交点为投影点。(类似的结论也适用于实射影平面，但与那里的相交关系有所不同。)
\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/239a7875926e6c0d.png}
\caption{用不同的颜色表示球面上不同的恒向线} \label{fig_QJPMTY_8}
\end{figure}
球面上的恒向线映射到平面上所得到的曲线具有以下形式：
$$R = e^{\frac{\theta}{a}},~$$
其中参数

a 代表了恒向线的“紧密度”。因此，球面上恒向线对应于平面上的对数螺线。这些螺旋与平面上的径向线等角相交，就像恒向线与球面上的经线等角相交一样。

球极平面投影以一种简单的对应方式与平面反演相关联。令球面上有 \(P\) 点和 \(Q\) 点，其在平面上的投影分别为 \(P'\) 点和 \(Q'\) 点。那么当且仅当 \(P\) 点和 \(Q\) 点关于赤道平面对称时，有 \(P'\) 点和 \(Q'\) 点互为赤道圆像中的逆像，
\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/3893286f48f2be79.png}
\caption{} \label{fig_QJPMTY_9}
\end{figure}
换句话说，如果：
\begin{itemize}
\item \(P\) 是球面上除“北极点 \(N\)”及其对跖点“南极点 \(S\)”外的一个点，
\item \(P'\)  是以\(N\) 为投影点时，\(P\) 点球极平面投影，
\item \(P''\) 是以\(S\) 为投影点时，\(P\) 点球极平面投影，
\end{itemize}
那么称 \(P'\) 点和 \(P''\) 点关于单位圆相互逆像。
$$\triangle NOP' \sim \triangle P''OS \Longrightarrow OP' : ON = OS : OP'' \Longrightarrow OP' \cdot OP'' = r^2~$$

\subsection{乌尔夫网}
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/0647b5f83d7a4a22.png}
\caption{乌尔夫网或立体网，用于手工绘制球极平面投影图} \label{fig_QJPMTY_10}
\end{figure}
球极平面投影图可以由计算机根据上面给出的显式公式进行绘制。然而，当手工绘制时，这些公式是不实用的。作为替代，通常是使用专门为这项任务设计的方格纸。这种特殊的方格纸被称为立体网或乌尔夫网，以俄罗斯矿物学家乔治(尤里·维克托罗维奇)伍尔夫(George (Yuri Viktorovich) Wulff)的名字命名。[11]

这里显示的乌尔夫网是以赤道上的点为中心的半球(如行星的东半球或西半球)纬线和经线网格的球极平面投影。
\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/adcda92167cd8118.png}
\caption{通过中心C 及投影平面 的球极平面投影生成一个乌尔夫网红色圆圈内的圆形网)} \label{fig_QJPMTY_11}
\end{figure}
在图中，通过比较网格中心附近的网格扇区和最右边或最左边的网格扇区，可以看出球极平面投影的面积扭曲特性。这两个扇区在球面上有着相同的面积。但在平面上，后者的面积几乎是前者的四倍。如果网格变得更细，这个比例将收敛于4。

在乌尔夫网，纬线和经线的图像以直角相交。这种正交性是立体投影的保角特性的结果。(然而，保角特性比该特性更强。并非所有保持纬线和经线正交性的投影都是保角的。)
\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/3b2a1f0f4aa94a35.png}
\caption{在乌尔夫网上绘制点的步骤说明} \label{fig_QJPMTY_12}
\end{figure}
举一个使用乌尔夫网的例子，想象两个薄纸上的乌尔夫网副本，一个在另一个上面，对齐并保证它们的共同中心始终重合。令$P$点的球面坐标为(140，60)，笛卡尔坐标为(0.321, 0.557, −0.766)。这一点位于从x-轴正方向逆时针方向旋转60° (或从y-轴正方向顺时针旋转30° )并相对于$z = 0$平面向下旋转50°所得到的直线上。一旦知道这些角度，就有四个步骤来绘图P 点:
\begin{enumerate}
\item 使用图中所示间隔为10°的网格线，从点(1, 0)沿逆时针方向找到60°线对应的网格边缘点(或从点(1, 0)沿顺时针方向找到30°线对应的网格边缘点)。
\item 旋转上层的乌尔夫网，直到该点与下层乌尔夫网的(1, 0)点重合。
\item 利用下层乌尔夫网的网格线，在上层乌尔夫网上标记出从该点向中心香菊50°的点。
\item 反向旋转上层乌尔夫网，使其与下层乌尔夫网对齐。那么步骤3中标记的点就是我们想要得到的投影。
\end{enumerate}
要绘制角度不是类似于60°和50°的整数的其他点，必须在最近的网格线之间进行可视化的插值。间距小于10°的网将有助于这些点的寻找。2°的间距是很常见的。

要根据球面上两点的球极平面投影图找到球面上两点之间的中心角，需将该图覆盖在乌尔夫网上，并围绕中心旋转该图，直到这两点位于子午线上或附近。然后通过计算子午线上的网格线来测量它们之间的角度。
\begin{itemize}
\item $P_1$和$P_2$ 两个点位于一个固定于乌尔夫网格原点的透明薄片上。

\item 透明薄片旋转使得$P_1$和$P_2$和两个点位于同一条经线上，并由此得到两点之间的中心角.
\end{itemize}

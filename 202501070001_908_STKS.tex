% 斯托克斯定理（综述）
% license CCBYSA3
% type Wiki

本文根据 CC-BY-SA 协议转载翻译自维基百科\href{https://en.wikipedia.org/wiki/Stokes\%27_theorem}{相关文章}。

斯托克斯定理（Stokes' theorem），[1] 也称为开尔文–斯托克斯定理（Kelvin–Stokes theorem），以开尔文勋爵和乔治·斯托克斯命名，[2][3] 或称为旋度的基本定理（the fundamental theorem for curls）或简单地称为旋度定理（the curl theorem），[4] 是矢量微积分中在三维欧几里得空间（\(\mathbb{R}^3\)）中的一个定理。对于给定的一个向量场，该定理将向量场旋度在某个曲面上的积分与向量场在该曲面边界上的线积分联系起来。斯托克斯定理的经典形式可以用一句话表述为：

一个向量场沿闭合曲线的线积分等于该曲线所包围的曲面上的旋度的曲面积分。

斯托克斯定理是广义斯托克斯定理的一个特例。[5][6] 特别是，在三维空间（\(\mathbb{R}^3\)）中的一个向量场可以视为一个1-形式（1-form），在这种情况下，其旋度是其外微分（exterior derivative），即一个2-形式（2-form）。
\subsection{定理}
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/a5471e9bcb930a4e.png}
\caption{斯托克斯定理的示意图，包括曲面 \(\Sigma\)、其边界 \(\partial\Sigma\) 和法向量 \(n\)。边界曲线 \(\partial\Sigma\) 的正向循环方向与曲面 \(\Sigma\) 的正向通量方向 \(n\) 通过右手定则相联系（即，右手的手指沿 \(\partial\Sigma\) 的循环方向，拇指指向 \(n\) 的方向）。} \label{fig_STKS_1}
\end{figure}
设 \(\Sigma\) 是三维欧几里得空间 (\(\mathbb{R}^3\)) 中的一个光滑有向曲面，其边界为 \(\partial \Sigma \equiv \Gamma\)。如果在包含 \(\Sigma\) 的区域内定义了一个向量场 
\[
\mathbf{F}(x, y, z) = (F_x(x, y, z), F_y(x, y, z), F_z(x, y, z)),~
\]
并且该向量场的一阶偏导数是连续的，那么：
\[
\iint_{\Sigma} (\nabla \times \mathbf{F}) \cdot \mathrm{d} \mathbf{\Sigma} = \oint_{\partial \Sigma} \mathbf{F} \cdot \mathrm{d} \mathbf{\Gamma}.~
\]
更明确地，这个等式可以表示为：
\[
\iint_{\Sigma} \left( 
\left( \frac{\partial F_z}{\partial y} - \frac{\partial F_y}{\partial z} \right) \mathrm{d}y \mathrm{d}z 
+ \left( \frac{\partial F_x}{\partial z} - \frac{\partial F_z}{\partial x} \right) \mathrm{d}z \mathrm{d}x 
+ \left( \frac{\partial F_y}{\partial x} - \frac{\partial F_x}{\partial y} \right) \mathrm{d}x \mathrm{d}y 
\right)
=
\oint_{\partial \Sigma} \left( 
F_x \, \mathrm{d}x + F_y \, \mathrm{d}y + F_z \, \mathrm{d}z 
\right).~
\]
例如，像科赫雪花（Koch snowflake）这样的曲面，是众所周知的无法展现出黎曼可积的边界，而在勒贝格理论中，非Lipschitz曲面无法定义曲面积的概念。一种（高级）方法是采用弱形式化，并应用几何测度论的工具；有关这种方法，请参阅共面积公式（coarea formula）。在本文中，我们采用更基础的定义，这基于这样的事实：对于\(\mathbb{R}^2\)中全维度子集，可以明确识别其边界。

一个更详细的描述将在后续讨论中给出。设 \(\gamma : [a, b] \to \mathbb{R}^2\) 是一个分段光滑的约旦平面曲线。约旦曲线定理表明，\(\gamma\) 将 \(\mathbb{R}^2\) 分成两个部分，一个是紧致的，另一个是非紧致的。设 \(D\) 表示紧致部分，则 \(D\) 的边界为 \(\gamma\)。现在，我们需要将这种边界的概念通过一个连续映射转移到三维欧几里得空间 (\(\mathbb{R}^3\)) 的曲面上。而这种映射已经存在：\(\Sigma\) 的参数化。

假设 \(\psi : D \to \mathbb{R}^3\) 是在 \(D\) 的邻域中分段光滑的，且 \(\Sigma = \psi(D)\)。如果 \(\Gamma\) 是由以下方式定义的空间曲线：\(\Gamma(t) = \psi(\gamma(t))\)那么我们称 \(\Gamma\) 为 \(\Sigma\) 的边界，记作 \(\partial \Sigma\)。

根据上述记号，如果 \(\mathbf{F}\) 是三维欧几里得空间 (\(\mathbb{R}^3\)) 中的任意光滑向量场，那么[7][8]：
\[
\oint_{\partial \Sigma} \mathbf{F} \cdot \mathrm{d} \mathbf{\Gamma} = \iint_{\Sigma} (\nabla \times \mathbf{F}) \cdot \mathrm{d} \mathbf{\Sigma}.~
\]
其中，符号“\(\cdot\)”表示 \(\mathbb{R}^3\) 中的点积。
\subsubsection{更一般定理的特殊情况}
斯托克斯定理可以看作以下恒等式的一个特殊情况：[9]
\[
\oint_{\partial \Sigma} (\mathbf{F} \cdot \mathrm{d} \mathbf{\Gamma}) \, \mathbf{g} = \iint_{\Sigma} \left[ \mathrm{d} \mathbf{\Sigma} \cdot \left( \nabla \times \mathbf{F} - \mathbf{F} \times \nabla \right) \right] \mathbf{g},~
\]
其中，\(\mathbf{g}\) 是三维欧几里得空间 (\(\mathbb{R}^3\)) 中的任意光滑向量场或标量场。当 \(\mathbf{g}\) 是一个均匀的标量场时，标准的斯托克斯定理就得到了恢复。
\subsection{证明}
该定理的证明分为四个步骤。我们假设格林定理成立，因此所关注的是如何将三维的复杂问题（斯托克斯定理）简化为二维的基本问题（格林定理）。[10] 在证明该定理时，数学家通常将其作为一个更一般结果的特殊情况进行推导，该一般结果使用微分形式表述，并通过更复杂的数学工具证明。虽然这些技术非常强大，但它们需要较高的背景知识，因此以下的证明避开了这些复杂方法，不要求超出基础向量微积分和线性代数的知识。[8] 

在本节最后，还给出了斯托克斯定理的一个简短的替代证明，作为广义斯托克斯定理的推论。
\subsubsection{初等证明}
\textbf{第一步：积分的参数化}

如“§ 定理”部分中所述，通过对曲面使用自然参数化，我们将问题的维度降低。设 \(\psi\) 和 \(\gamma\) 如前所述，并注意到通过变量替换：
\[
\oint_{\partial \Sigma} \mathbf{F}(\mathbf{x}) \cdot \mathrm{d} \mathbf{\Gamma} 
= \oint_{\gamma} \mathbf{F}(\psi(\gamma)) \cdot \mathrm{d} \psi(\gamma) 
= \oint_{\gamma} \mathbf{F}(\psi(\mathbf{y})) \cdot J_{\mathbf{y}}(\psi) \, \mathrm{d} \gamma,~
\]
其中 \(J_{\mathbf{y}}(\psi)\) 表示 \(\psi\) 在 \(\mathbf{y} = \gamma(t)\) 处的雅可比矩阵。

现在，设 \(\{ \mathbf{e}_u, \mathbf{e}_v \}\) 是 \(\mathbb{R}^2\) 坐标方向上的一个正交归一基。[注3]

注意到 \(J_{\mathbf{y}}(\psi)\) 的列恰好是 \(\psi\) 在 \(\mathbf{y}\) 处的偏导数，可以将上述方程在坐标形式下展开为：

\[
\oint_{\partial \Sigma} \mathbf{F}(\mathbf{x}) \cdot \mathrm{d} \mathbf{\Gamma} 
= \oint_{\gamma} \mathbf{F}(\psi(\mathbf{y})) J_{\mathbf{y}}(\psi) \mathbf{e}_u (\mathbf{e}_u \cdot \mathrm{d} \mathbf{y}) 
+ \mathbf{F}(\psi(\mathbf{y})) J_{\mathbf{y}}(\psi) \mathbf{e}_v (\mathbf{e}_v \cdot \mathrm{d} \mathbf{y}),~
\]
\[
=\oint_{\gamma} \left( 
\left( \mathbf{F}(\psi(\mathbf{y})) \cdot \frac{\partial \psi}{\partial u}(\mathbf{y}) \right) \mathbf{e}_u 
+ \left( \mathbf{F}(\psi(\mathbf{y})) \cdot \frac{\partial \psi}{\partial v}(\mathbf{y}) \right) \mathbf{e}_v 
\right) \cdot \mathrm{d} \mathbf{y}.~
\]
\textbf{初等证明的第二步（定义拉回）}

前一步建议我们定义以下函数：

\[
\mathbf{P}(u, v) = \left( \mathbf{F}(\psi(u, v)) \cdot \frac{\partial {\psi}}{\partial u}(u, v) \right) \mathbf{e}_u + \left( \mathbf{F}(\psi(u, v)) \cdot \frac{\partial \psi}{\partial v}(u, v) \right) \mathbf{e}_v~
\]
现在，如果标量函数 \(P_u\) 和 \(P_v\) 定义如下：
\[
P_u(u, v) = \left( \mathbf{F}(\psi(u, v)) \cdot \frac{\partial \psi}{\partial u}(u, v) \right),~
\]
\[
P_v(u, v) = \left( \mathbf{F}(\psi(u, v)) \cdot \frac{\partial \psi}{\partial v}(u, v) \right),~
\]
那么：
\[
\mathbf{P}(u, v) = P_u(u, v) \mathbf{e}_u + P_v(u, v) \mathbf{e}_v.~
\]
这是沿着参数化映射 \(\psi\) 对 \(\mathbf{F}\) 的拉回（pullback）。根据上述关系，它满足以下等式：
\[
\oint_{\partial \Sigma} \mathbf{F}(\mathbf{x}) \cdot \mathrm{d} \mathbf{l} 
= \oint_{\gamma} \mathbf{P}(\mathbf{y}) \cdot \mathrm{d} \mathbf{l} 
= \oint_{\gamma} \left( P_u(u, v) \mathbf{e}_u + P_v(u, v) \mathbf{e}_v \right) \cdot \mathrm{d} \mathbf{l}.~
\]
我们已经成功地将斯托克斯定理的一边简化为一个二维公式；接下来我们处理定理的另一边。

\textbf{初等证明的第三步（第二个方程）}

首先，利用乘积法则计算出出现在格林定理中的偏导数：
\[
\frac{\partial P_u}{\partial v} = \frac{\partial (\mathbf{F} \circ \psi)}{\partial v} \cdot \frac{\partial \psi}{\partial u} + (\mathbf{F} \circ \psi) \cdot \frac{\partial^2 \psi}{\partial v \partial u},~
\]
\[
\frac{\partial P_v}{\partial u} = \frac{\partial (\mathbf{F} \circ \psi)}{\partial u} \cdot \frac{\partial \psi}{\partial v} + (\mathbf{F} \circ \psi) \cdot \frac{\partial^2 \psi}{\partial u \partial v}.~
\]
巧妙地，第二项在差分中消失了，这是因为混合偏导数相等。因此：[注4]
\[
\frac{\partial P_v}{\partial u} - \frac{\partial P_u}{\partial v} 
= \frac{\partial (\mathbf{F} \circ \psi)}{\partial u} \cdot \frac{\partial \psi}{\partial v} 
- \frac{\partial (\mathbf{F} \circ \psi)}{\partial v} \cdot \frac{\partial \psi}{\partial u}~
\]
\[
= \frac{\partial \psi}{\partial v} \cdot (J_{\psi(u, v)} \mathbf{F}) \frac{\partial \psi}{\partial u} 
- \frac{\partial \psi}{\partial u} \cdot (J_{\psi(u, v)} \mathbf{F}) \frac{\partial \psi}{\partial v} 
\quad \text{（链式法则）}~
\]
\[
= \frac{\partial \psi}{\partial v} \cdot \left( J_{\psi(u, v)} \mathbf{F} - (J_{\psi(u, v)} \mathbf{F})^{\mathsf{T}} \right) \frac{\partial \psi}{\partial u}.~
\]
但是现在考虑这个二次形式中的矩阵，即：\(J_{\\psi(u, v)} \mathbf{F} - (J_{\psi(u, v)} \mathbf{F})^{\mathsf{T}}\).我们声称，这个矩阵实际上描述了一个叉乘（cross product）。这里，上标 \({}^{\mathsf{T}}\) 表示矩阵的转置。

更具体地，设\(A = (A_{ij})_{ij}\)是一个任意的 \(3 \times 3\) 矩阵，并设
\[
\mathbf{a} = 
\begin{bmatrix} 
a_1 \\ 
a_2 \\ 
a_3 
\end{bmatrix} = 
\begin{bmatrix} 
A_{32} - A_{23} \\ 
A_{13} - A_{31} \\ 
A_{21} - A_{12} 
\end{bmatrix}.~
\]
注意到映射 \(x \mapsto \mathbf{a} \times x\) 是线性的，因此可以通过其在基向量上的作用来唯一确定。通过直接计算可以得到：
\[
(A - A^{\mathsf{T}}) \mathbf{e}_1 = 
\begin{bmatrix} 
0 \\ 
a_3 \\ 
-a_2 
\end{bmatrix} = \mathbf{a} \times \mathbf{e}_1,~
\]
\[
(A - A^{\mathsf{T}}) \mathbf{e}_2 = 
\begin{bmatrix} 
-a_3 \\ 
0 \\ 
a_1 
\end{bmatrix} = \mathbf{a} \times \mathbf{e}_2,~
\]
\[
(A - A^{\mathsf{T}}) \mathbf{e}_3 = 
\begin{bmatrix} 
a_2 \\ 
-a_1 \\ 
0 
\end{bmatrix} = \mathbf{a} \times \mathbf{e}_3.~
\]
这里，\(\{\mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3\}\) 表示 \(\mathbb{R}^3\) 中坐标方向上的一个正交归一基。[注5]
% Ubuntu 22.04 安装 NVIDIA 显卡驱动笔记
% license Usr
% type Note

如果你装机放了一张 Nvidia 显卡， 那么 Ubuntu 在安装时会自动提供一个 Nouveau 开源驱动。 但为了进行 GPU 编程或者提高显卡性能，需要安装官方显卡。 笔者使用 Ubuntu 22.04 进行测试。

首先到 Nvidia 官网下载 Linux 驱动。 安装以后提示需要先禁止 nouveau 驱动才可以安装。 安装包可以自动写入一个 \verb`/etc/modprobe.d/nvidia-installer-disable-nouveau.conf` 文件来试图禁止。
\begin{lstlisting}[language=none,caption=nvidia-installer-disable-nouveau.conf]
# generated by nvidia-installer
blacklist nouveau
options nouveau modeset=0
\end{lstlisting}

注意写入该文件后， 如果显卡安装失败， 那么重启以后就可能导致屏幕没有任何反应。 但只要想办法把该文件删掉再次重启即可（例如用一个启动 U 盘）。

另外 Nvidia 驱动安装包的日志会写进 \verb`/var/log/nvidia-installer.log`。

安装包会提示这个
\begin{lstlisting}[language=none]
An alternate method of installing the NVIDIA driver was detected.
(This is usually a package provided by your distributor.) A      
  driver installed via that method may integrate better with your
  system than a driver installed by nvidia-installer.

  Please review the message provided by the maintainer of this alternate
  installation method and decide how to proceed:

Continue installation                        Abort installation 
\end{lstlisting}

ERROR: An error occurred while performing the step: "Building kernel modules". See /var/log/nvidia-installer.log for details.      
        
                                                                  OK 

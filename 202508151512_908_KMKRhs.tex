% 卡迈克尔函数（综述）
% license CCBYSA3
% type Wiki

本文根据 CC-BY-SA 协议转载翻译自维基百科\href{https://en.wikipedia.org/wiki/Carmichael_function}{相关文章}。

在数论（数学的一个分支）中，正整数 $n$ 的卡迈克尔函数$\lambda(n)$ 定义为满足下列条件的最小正整数 $m$：
$$
a^{m} \equiv 1 \pmod{n}~
$$
其中 $a$ 为任意与 $n$ 互素的整数。从代数的角度来看，$\lambda(n)$ 是模 $n$ 的整数乘法群的指数。由于这是一个有限阿贝尔群，必然存在一个元素，其阶等于该指数 $\lambda(n)$。这样的元素被称为模 $n$ 的本原 $\lambda$-根（primitive $\lambda$-root modulo $n$）。
\begin{figure}[ht]
\centering
\includegraphics[width=14.25cm]{./figures/133eee57c8a8a0bb.png}
\caption{卡迈克尔 λ 函数：$1 \le n \le 1000$ 时的 $\lambda(n)$（与欧拉 φ 函数对比）} \label{fig_KMKRhs_1}
\end{figure}
卡迈克尔函数以美国数学家罗伯特·卡迈克尔的名字命名，他于 1910 年首次给出了这一函数的定义\(^\text{[1]}\)。它也被称为卡迈克尔 $\lambda$ 函数、约化欧拉函数以及最小通用指数函数。

模 $n$ 的整数乘法群的阶是 $\varphi(n)$，其中 $\varphi$ 是**欧拉函数**。由于有限群中任一元素的阶都会整除群的阶，所以 $\lambda(n)$ 一定整除 $\varphi(n)$。

下表比较了 $\lambda(n)$（OEIS 数列 A002322）与 $\varphi(n)$ 的前 36 个值（当二者不同的时候，$\varphi(n)$ 用粗体表示；使它们不同的那些 $n$ 的值列在 OEIS 数列 A033949 中）。
\begin{figure}[ht]
\centering
\includegraphics[width=14.25cm]{./figures/309a6eadd8675298.png}
\caption{} \label{fig_KMKRhs_2}
\end{figure}
\subsection{数值例子}
\begin{itemize}
\item $ n = 5$小于且与 5 互素的数集合是 $\{1, 2, 3, 4\}$。因此，欧拉函数的值为 $\varphi(5) = 4$，而卡迈克尔函数 $\lambda(5)$ 的值必须是 4 的约数。约数 1 不满足卡迈克尔函数的定义，因为除了$a \equiv 1 \pmod{5}$之外，$a^1 \not\equiv 1 \pmod{5}$。约数 2 也不行，因为$2^2 \equiv 3^2 \equiv 4 \not\equiv 1 \pmod{5}$。因此，$\lambda(5) = 4$。实际上：$1^4 \equiv 2^4 \equiv 3^4 \equiv 4^4 \equiv 1 \pmod{5}$。其中 2 和 3 是模 5 的本原 $\lambda$-根，同时它们也是模 5 的本原根。
\item $ n = 8$小于且与 8 互素的数集合是 $\{1, 3, 5, 7\}$。因此 $\varphi(8) = 4$，而 $\lambda(8)$ 必须是 4 的约数。事实上，$\lambda(8) = 2$，因为：$
1^2 \equiv 3^2 \equiv 5^2 \equiv 7^2 \equiv 1 \pmod{8}$。模 8 的本原 $\lambda$-根是 3、5 和 7，但模 8 没有本原根。
\end{itemize}
\subsection{λ(n) 的递推公式}
质数幂的卡迈克尔$\lambda$函数可以用欧拉函数表示。任何不是 1 且不是质数幂的整数，都可以唯一地分解为不同质数幂的乘积，此时该数的$\lambda$值等于这些质数幂的 $\lambda$值的最小公倍数。具体来说，$\lambda(n)$ 由以下递推式给出：
$$
\lambda(n) =
\begin{cases}
\varphi(n), & \text{如果 } n \text{ 是 1、2、4，或奇质数幂}, \\[6pt]
\dfrac{1}{2} \varphi(n), & \text{如果 } n = 2^{r},\ r \geq 3, \\[8pt]
\operatorname{lcm}\bigl(\lambda(n_{1}),\lambda(n_{2}),\dots,\lambda(n_{k})\bigr), & \text{如果 } n = n_{1} n_{2} \dots n_{k}, \ \text{且 } n_{1},n_{2},\dots,n_{k} \text{ 是不同质数的幂}.
\end{cases}~
$$
其中，质数幂 $p^r$（$p$ 为质数且 $r \geq 1$）的欧拉函数为：
$$
\varphi(p^{r}) = p^{r-1}(p - 1)~
$$
\subsection{卡迈克尔定理}
卡迈克尔证明了两个定理，它们共同确立了这样一个事实：如果将 $\lambda(n)$ 按照上一节的递推公式来定义，那么它就满足引言中所述的性质——即它是满足以下条件的最小正整数 $m$：$a^{m} \equiv 1 \pmod{n}$对于所有与 $n$ 互素的整数 $a$，上述同余式都成立。

\textbf{定理 1} —— 如果 $a$ 与 $n$ 互素，则：$a^{\lambda(n)} \equiv 1 \pmod{n}$。\(^\text{[2]}\) 

这意味着：模 $n$ 的整数乘法群中每个元素的阶都整除 $\lambda(n)$。卡迈克尔将这样一种元素 $a$ 称为模 $n$ 的本原 $\lambda$-根（primitive $\lambda$-root modulo $n$）：它的最小正整数指数，使得$a^{\lambda(n)} \equiv 1 \pmod{n}$\(^\text{[3]}\)（不要与模 $n$ 的本原根混淆，卡迈克尔有时会称其为模 $n$ 的本原 $\varphi$-根）。

\textbf{定理 2} —— 对于任意正整数 $n$，都存在一个模 $n$ 的本原 $\lambda$-根。此外，如果 $g$ 是这样一个根，那么所有与 $g$ 的幂同余的本原 $\lambda$-根的个数为：$\varphi\bigl(\lambda(n)\bigr)$。\(^\text{[4]}\) 

如果 $g$ 是定理所保证存在的模 $n$ 的本原 $\lambda$-根之一，那么同余式$g^{m} \equiv 1 \pmod{n}$在正整数范围内没有小于 $\lambda(n)$ 的解。这说明不存在正整数 $m < \lambda(n)$，能使得对于所有与 $n$ 互素的 $a$，都满足$a^{m} \equiv 1 \pmod{n}$。

定理 2 的第二条结论并不意味着模 $n$ 的所有本原 $\lambda$-根都与某一个本原根 $g$ 的幂同余\(^\text{[5]}\)。例如，当 $n = 15$ 时，$\lambda(n) = 4$，而 $\varphi(n) = 8$，$\varphi(\lambda(n)) = 2$。模 15 的本原 $\lambda$-根共有 4 个，分别是 2、7、8 和 13，因为：$1 \equiv 2^{4} \equiv 8^{4} \equiv 7^{4} \equiv 13^{4} \pmod{15}$。其中 2 和 8 互为幂同余，7 和 13 互为幂同余，但 7 和 13 都不与 2 或 8 的幂同余，反之亦然。模 15 的乘法群中的另外四个元素——1、4（满足$4 \equiv 2^{2} \equiv 8^{2} \equiv 7^{2} \equiv 13^{2} \pmod{15}$）、11 和 14——都不是模 15 的本原 $\lambda$-根。

再看一个对比性的例子：当 $n = 9$ 时，$\lambda(n) = \varphi(n) = 6$，且 $\varphi(\lambda(n)) = 2$。模 9 的本原 $\lambda$-根有两个，分别是 2 和 5，并且它们互为对方的五次幂同余。它们同时也是模 9 的本原 $\varphi$-根。

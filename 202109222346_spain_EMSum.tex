% Euler-Maclaurin求和公式

\subsubsection{Euler求和公式}
\begin{theorem}{}
    设函数 $f:X\to Y$ 在区间$[0,+\infty)$上连续可微,则有如下Euler求和公式成立	
        \begin{equation}\label{EMSum_eq1} 
            \sum_{k=1}^{n}f(k)=\int_{0}^{n}f(x)\,\dd x
            +\frac{f(n)-f(0)}{2}+\int_{0}^{n}\psi(x)f'(x)\dd x
        \end{equation}
    其中 $\psi(x)=x-\lfloor x \rfloor-1/2=\{x\}-1/2$
\end{theorem}
证明如下：将区间$[0,n]$划分为长度为$1$的小区间$[k-1,k](k=1,2,\cdots,n)$,则
​\[
    \int_{k-1}^{k}\psi(x)f'(x)\,\dd x
    =\frac{f(k)+f(k-1)}{2}-\int_{k-1}^{k}f(x)\,\dd x
\]
​对$k$从1到$n$求和,于是
​\[
    \int_{0}^{n}\psi(x)f'(x)\,\dd x
    =\sum_{k=1}^{n}f(k)-\frac{f(n)-f(0)}{2}-\int_{0}^{n}f(x)\,\dd x
\]
这样就证明了Euler求和公式．注意到\autoref{EMSum_eq1} 右端积分比较复杂，一般情况下，
仅仅估计其上界便可得到较为不错的结果．\\
设函数 $f\in{C^1[0,+\infty)}$ ,再设函数
$\varphi(x)=\displaystyle{\int_{0}^{x}\psi(t)\,\dd t}$,
易知该函数是一个以1为周期的函数,且
 $-1/8\leqslant\varphi(x)\leqslant 0$ ,因此
\begin{equation}
    \left|\int_{0}^{n}\psi(x)f'(x)\,\dd x\right|
    =\left|\int_{0}^{n}\varphi(x)D^2(f)\mathrm{d}x\right|
    \leqslant\frac{|f'(n)-f'(0)|}{8}
\end{equation}
在实际情况中，更为常见的是函数 $f$ 在$[1,+\infty)$ 上可微，因此在该情况下补充定义$ f\equiv 0,x\in[0,1-\delta]$.在 \autoref{EMSum_eq1} 式中令$n=1$,从而
\[
    \int_{0}^{1-\delta}\psi(x)f'(x)\mathrm{d}x
    =\frac{f(1-\delta)+f(0)}{2}-\int_{0}^{1-\delta}f(x)\,\dd x=0
\]
由于令$\delta\to0+0$时，极限存在且为$0$,从而对于在区间$[1,+\infty)$连续可微函数$f$就有
	\begin{equation}
		\sum_{k=1}^{n}f(k)
        =\int_{1}^{n}f(x)\,\dd x+\frac{f(n)+f(1)}{2}+\int_{1}^{n}\psi(x)f'(x)\,\dd x
	\end{equation}
	在式中,若积分$\displaystyle{\int_{1}^{\infty}\psi(x)D(f)\mathrm{d}x}$收敛,则
	\begin{equation}
		\sum_{k=1}^{n}f(k)=\int_{1}^{n}f(x)\mathrm{d}x+\frac{f(n)}{2}-\int_{n}^{\infty}\psi(x)D(f)\mathrm{d}x
		+\int_{1}^{\infty}\psi(x)D(f)\mathrm{d}x+\frac{f(1)}{2}
	\end{equation}
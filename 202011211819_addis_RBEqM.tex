% 刚体的运动方程
% 刚体|运动方程|惯性张量|旋转矩阵|角动量|力矩

\pentry{刚体的平面运动方程\upref{RBEM}， 惯性张量\upref{ITensr}}

一般情况下下刚体的运动方程要比平面运动复杂许多， 但我们仍然可以将运动分解为质心的运动以及刚体绕质心的旋转， 前者由合力决定， 所以仍然有（\autoref{RBEM_eq1}~\upref{RBEM}）
\begin{equation}\label{RBEqM_eq8}
M\bvec a_c = \sum_i \bvec F_i
\end{equation}
所以相对于平面运动， 该问题的困难在于绕质心转动的计算． 虽然角动量定理仍然满足， 但转动惯量将有可能随时间变化． 这是因为刚体的瞬时转轴相对刚体的位置可能会随时间变化， 而不同的转轴对应的角动量一般不同．

% 未完成： 陀螺问题： 之前的假设是转动惯量很大， 但事实上陀螺是除了进动还会张动的．
下面我们会看到， 刚体绕固定点转动的角动量定理可以记为
\begin{equation}
\bvec\tau = \mat I \bvec\alpha + \bvec\omega \cross \bvec L
\end{equation}
对比平面运动的\autoref{RBEM_eq2}~\upref{RBEM}， 转动惯量变为了惯性张量， 且多了一项角速度叉乘角动量． 当二者共线时， 叉乘为零， 就回到了平面运动的式子．

\subsection{转动方程}
我们仍然可以用角动量定理来推导刚体的转动方程， 但这里的角动量要用惯性张量来表示（\autoref{ITensr_eq3}~\upref{ITensr} 和\autoref{ITensr_eq4}~\upref{ITensr}）
\begin{equation}
\bvec L = \mat I \bvec \omega = \mat R \mat I_0 \mat R\Tr \bvec \omega
\end{equation}
其中 $\mat I_0$ 不随时间变化， $\bvec L$， $\bvec \omega$ 和 $\bvec R$ 都是时间的函数． 代入角动量定理得（\autoref{AMLaw_eq1}~\upref{AMLaw}）
\begin{equation}\label{RBEqM_eq3}
\bvec \tau = \dv{\bvec L}{t} = \dv{\mat I}{t} \bvec\omega + \mat I \dv{\bvec\omega}{t}
= \dv{t} (\bvec R\mat I_0 \mat R\Tr) \bvec \omega + \mat R \mat I_0 \mat R\Tr \dv{\bvec \omega}{t}
\end{equation}
其中 $\dv*{\bvec\omega}{t}$ 是角加速度， 记为 $\bvec\alpha$， 角速度和角加速度的关系可以类比速度和加速度\upref{VnA}． 另外注意这里对矩阵求导就是对每个元分别求导．

我们把力矩 $\bvec \tau$ 看作是一个关于时间的已知函数， 把旋转矩阵 $\mat R$ 和角速度 $\bvec \omega$ 看做关于时间的未知函数（即微分方程的解）． $\mat R$ 和 $\bvec \omega$ 完整描述了刚体绕固定点转动的\textbf{状态}， 就像位置和动量可以完整描述了一个质点运动的状态．

另外， $\bvec \omega$ 和 $\bvec R$ 之间的关系就速度和位移的关系， 假设体坐标系中固定在刚体上的任意一点坐标为 $\bvec r$ （不随时间变化）， 变换到实验室坐标系中为 $\mat R \bvec r$． 对时间求导得该点在实验室坐标系的速度为
\begin{equation}\label{RBEqM_eq1}
\bvec v = \dv{\mat R}{t} \bvec r
\end{equation}
而角速度和速度之间有 $\bvec v = \bvec \omega \cross (\mat R \bvec r)$（\autoref{CMVD_eq5}~\upref{CMVD}）． 我们可以把叉乘用矩阵乘法表示为 % 未完成： 再叉乘词条里面提及这点
\begin{equation}\label{RBEqM_eq2}
\bvec v = \mat\Omega \mat R \bvec r
\end{equation}
其中
\begin{equation}
\mat\Omega = \pmat{0 & -\omega_z & \omega_y \\ \omega_z & 0 & -\omega_x\\ -\omega_y & \omega_x & 0}
\end{equation}
是一个反对称矩阵， 即
\begin{equation}\label{RBEqM_eq7}
\mat \Omega\Tr = -\mat \Omega
\end{equation}
由于 $\bvec r$ 是任意的， 对比\autoref{RBEqM_eq1} 和\autoref{RBEqM_eq2} 得
\begin{equation}\label{RBEqM_eq4}
\dv{\mat R}{t} = \mat\Omega \mat R
\end{equation}

现在我们可以化简\autoref{RBEqM_eq3} 第一项， 根据链式法则\upref{ChainR}和\autoref{RBEqM_eq4}， \autoref{RBEqM_eq7}
\begin{equation}
\begin{aligned}
\dv{\mat I}{t}\bvec\omega &= \dv{t}(\mat R \mat I_0 \mat R\Tr)\bvec\omega\\
&= \dv{\mat R}{t} \mat I_0 \mat R\Tr \bvec\omega + \mat R \mat I_0 \qty(\dv{\mat R}{t})\Tr \bvec\omega\\
&= \mat \Omega \mat R \mat I_0 \mat R\Tr \bvec\omega + \mat R \mat I_0 \mat R\Tr \mat \Omega\Tr \bvec\omega\\
&= \mat \Omega \mat R \mat I_0 \mat R\Tr \bvec\omega - \mat R \mat I_0 \mat R\Tr \mat \Omega \bvec\omega\\
&= \mat \Omega \mat R \mat I_0 \mat R\Tr \bvec\omega\\
&= \bvec \omega \cross \bvec L
\end{aligned}
\end{equation}
其中使用了 $\mat \Omega \bvec\omega = \bvec\omega \cross \bvec\omega = \bvec 0$． 所以\autoref{RBEqM_eq3} 变为
\begin{equation}
\begin{aligned}
\bvec\tau &= \bvec\omega \cross \bvec L + \mat I \bvec\alpha\\
&= \mat \Omega \mat R \mat I_0 \mat R\Tr \bvec\omega + \mat R \mat I_0 \mat R\Tr \dv{\bvec\omega}{t}
\end{aligned}
\end{equation}

整理得（注意 $\mat R \mat I_0 \mat R\Tr$ 得逆矩阵是 $\mat R \mat I_0^{-1} \mat R\Tr$， $\mat I_0^{-1}$ 是 $\mat I_0$ 的逆矩阵）% 链接未完成
\begin{equation}\label{RBEqM_eq6}
\dv{\bvec \omega}{t} = \mat R \mat I_0^{-1} \mat R\Tr \qty(\bvec \tau  - \mat \Omega \mat R \mat I_0 \mat R\Tr \bvec\omega)
\end{equation}
\autoref{RBEqM_eq4} 和\autoref{RBEqM_eq6} 就是完整的运动方程． 这是一个一阶常微分方程组\upref{ODEsys}， 写成标量的形式共有 12 条， 未知数分别为 $\omega_x, \omega_y, \omega_z$， $R_{i,j}$ 共 12 个．

事实上旋转矩阵 $\mat R$ 其实只有三个独立的自由度， 如果我们能用三个变量表示 $\mat R$， 就可以得到只含 6 个未知数的 6 个方程． 一种方法是使用欧拉角， 但列出来后式子会比较复杂． 另一种方法是用 4 元数， 即用 4 个变量表示 $\mat R$， 可以得到形式相对简单的方程， 见 “刚体运动方程（四元数）\upref{RBEMQt}”．

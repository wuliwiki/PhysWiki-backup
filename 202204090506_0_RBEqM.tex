% 刚体的运动方程
% 刚体|运动方程|惯性张量|旋转矩阵|角动量|力矩

\pentry{刚体的平面运动方程\upref{RBEM}， 叉乘的矩阵形式\upref{CrosMt}， 惯性张量\upref{ITensr}， 刚体的瞬时转轴、角速度的矢量相加\upref{InsAx}， 旋转矩阵的导数\upref{RotDer}}

一般情况下下刚体的运动方程要比平面运动复杂许多， 但我们仍然可以将运动分解为质心的运动以及刚体绕质心的旋转， 前者由合力决定， 所以仍然有（\autoref{RBEM_eq1}~\upref{RBEM}）
\begin{equation}\label{RBEqM_eq8}
M\bvec a_c = \sum_i \bvec F_i
\end{equation}
所以相对于平面运动， 该问题的困难在于绕质心转动的计算． 虽然角动量定理（\autoref{AMLaw_eq1}~\upref{AMLaw}）仍然成立， 但惯性张量随时间的变化会使问题复杂得多． 下面我们会看到， 刚体绕固定点转动的角动量定理可以记为
\begin{equation}\label{RBEqM_eq1}
\bvec\tau = \dv{\bvec L}{t} = \mat I \dot{\bvec\omega} + \bvec\omega \cross \bvec L
\end{equation}
其中 $\dot{\bvec\omega} = \dv*{\bvec\omega}{t}$ 是矢量\textbf{角加速度}． 角速度和角加速度的关系可以类比速度和加速度\upref{VnA}． 对比平面运动的\autoref{RBEM_eq2}~\upref{RBEM}， 转动惯量变为了惯性张量， 且多了一项角速度叉乘角动量． 当二者共线时， 叉乘为零， 就回到了平面运动的式子．

\subsection{转动方程}
我们接下来假设刚体被限制绕坐标原点转动， 原点未必是刚体的质心． 当参考系为非惯性系时， 需要考虑惯性力带来的力矩． 
\begin{equation}\label{RBEqM_eq6}
\dot{\bvec \omega} = \mat R \mat I_0^{-1} \mat R\Tr \qty[\bvec \tau  - \bvec\omega\cross(\mat R \mat I_0 \mat R\Tr \bvec\omega)]
\end{equation}
\begin{equation}\label{RBEqM_eq4}
\dot{\mat R} = \mat\Omega \mat R
\end{equation}
其中 $\dot{\mat R}$ 表示对每个矩阵元分别求时间导数
\begin{equation}\label{RBEqM_eq5}
\mat\Omega = \pmat{0 & -\omega_z & \omega_y \\ \omega_z & 0 & -\omega_x\\ -\omega_y & \omega_x & 0}
\end{equation}
\autoref{RBEqM_eq6} 和\autoref{RBEqM_eq4} 组成一个一阶常微分方程组\upref{ODEsys}， 写成标量的形式共有 12 条， 未知数分别为 $\omega_x, \omega_y, \omega_z$， $R_{i,j}$ 共 12 个．

事实上旋转矩阵 $\mat R$ 只有三个独立的自由度， 如果我们能用三个变量表示 $\mat R$， 就可以得到只含 6 个未知数的 6 个常微分方程． 一种方法是使用欧拉角， 但列出来后式子会比较复杂． 另一种方法是用 4 元数， 即用 4 个变量表示 $\mat R$， 可以得到形式相对简单的方程， 见 “刚体运动方程（四元数）\upref{RBEMQt}”．


\subsubsection{推导}
\autoref{RBEqM_eq4} 的推导见 “旋转矩阵的导数\upref{RotDer}”． 而\autoref{RBEqM_eq6} 就是\autoref{RBEqM_eq1} 的变形：
\begin{equation}\label{RBEqM_eq7}
\dot{\bvec \omega} = \mat I^{-1} (\bvec\tau - \bvec\omega\cross\bvec L)
\end{equation}
这里的角动量要用惯性张量来计算（\autoref{ITensr_eq3}~\upref{ITensr} 和\autoref{ITensr_eq6}~\upref{ITensr}）
\begin{equation}\label{RBEqM_eq2}
\bvec L = \mat I \bvec \omega = \mat R \mat I_0 \mat R\Tr \bvec \omega
\end{equation}
其中 $\mat I_0$ 不随时间变化， $\bvec L$， $\bvec \omega$ 和 $\bvec R$ 都是时间的函数． 另外 $\mat I = \mat R \mat I_0 \mat R\Tr$ 的逆矩阵是 $\mat I^{-1} = \mat R \mat I_0^{-1} \mat R\Tr$， $\mat I_0^{-1}$ 是 $\mat I_0$ 的逆矩阵． \autoref{RBEqM_eq2} 代入\autoref{RBEqM_eq7} 就是\autoref{RBEqM_eq6}．

要证明\autoref{RBEqM_eq6}， 从角动量定理（\autoref{AMLaw_eq1}~\upref{AMLaw}）得
\begin{equation}\label{RBEqM_eq3}
\bvec \tau = \dv{\bvec L}{t} = \dot{\mat I} \bvec\omega + \mat I \dot{\bvec\omega}
= \dv{t} (\bvec R\mat I_0 \mat R\Tr) \bvec \omega + \mat R \mat I_0 \mat R\Tr \dot{\bvec \omega}
\end{equation}
另外注意这里对矩阵求导就是对每个元分别求导．

我们把力矩 $\bvec \tau$ 看作是一个关于时间的已知函数， 把旋转矩阵 $\mat R$ 和角速度 $\bvec \omega$ 看做关于时间的未知函数（即微分方程的解）． $\mat R$ 和 $\bvec \omega$ 完整描述了刚体绕固定点转动的\textbf{状态}， 就像位置和动量可以完整描述了一个质点运动的状态．


现在我们可以化简\autoref{RBEqM_eq3} 右边第一项， 根据链式法则\upref{ChainR}和\autoref{RBEqM_eq4}， ？？
\begin{equation}
\begin{aligned}
\dv{\mat I}{t}\bvec\omega &= \dv{t}(\mat R \mat I_0 \mat R\Tr)\bvec\omega\\
&= \dv{\mat R}{t} \mat I_0 \mat R\Tr \bvec\omega + \mat R \mat I_0 \qty(\dv{\mat R}{t})\Tr \bvec\omega\\
&= \mat \Omega \mat R \mat I_0 \mat R\Tr \bvec\omega + \mat R \mat I_0 \mat R\Tr \mat \Omega\Tr \bvec\omega\\
&= \mat \Omega \mat R \mat I_0 \mat R\Tr \bvec\omega - \mat R \mat I_0 \mat R\Tr \mat \Omega \bvec\omega\\
&= \mat \Omega \mat R \mat I_0 \mat R\Tr \bvec\omega\\
&= \bvec \omega \cross \bvec L
\end{aligned}
\end{equation}
其中使用了 $\mat \Omega \bvec\omega = \bvec\omega \cross \bvec\omega = \bvec 0$． 所以\autoref{RBEqM_eq3} 变为
\begin{equation}
\begin{aligned}
\bvec\tau &= \bvec\omega \cross \bvec L + \mat I \bvec\alpha\\
&= \mat \Omega \mat R \mat I_0 \mat R\Tr \bvec\omega + \mat R \mat I_0 \mat R\Tr \dv{\bvec\omega}{t}
\end{aligned}
\end{equation}
 链接未完成

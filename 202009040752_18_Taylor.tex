% 泰勒展开
% 微积分|导数|高阶导数|泰勒展开|泰勒级数

\pentry{高阶导数\upref{HigDer}}

若函数$f$在开区间$I$内可以求任意阶的导数（例如幂函数，三角函数，指数函数，对数函数等），那么这个函数可以用多项式近似，且在某种意义下, 总项数 $N$ 越多，近似得越精确。 确切地说, 对于任何$x_0\in I$, 存在唯一一个数列$\{c_n\}$, 使得对于任何正整数$N$, 皆有
\begin{equation}\label{Taylor_eq1}
f(x) -\sum_{n = 0}^N  c_n (x - x_0)^n=O(|x-x_0|^{N+1}).
\end{equation}
每一个系数$c_n$由函数在 $x_0$ 处的第 $n$ 阶导数求得
\begin{equation}\label{Taylor_eq2}
c_n = \frac{1}{n!} f^{(n)}(x_0);
\end{equation}
注意其中 0 的阶乘为 $0! = 1$。 另外由\autoref{Taylor_eq1}得，当 $x=x_0$ 时，函数值等于多项式值。 当项数 $N$ 有限时，通常 $\abs{x-x_0}$ 越小多项式就越接近函数 。 以上这种把函数展开成多项式的方法就叫\textbf{泰勒展开}。 我们先来看一个例子:

\begin{example}{正弦函数}
我们在 $x_0=0$ 处展开 $\sin x$， 由\autoref{Taylor_eq1} 和\autoref{Taylor_eq2} 得
\begin{equation}\label{Taylor_eq3}
\sin x = x - \frac{1}{3!}{x^3} + \frac{1}{5!}{x^5} - \frac{1}{7!} x^7 + \ldots 
\end{equation}
取不同的项数 $N$ 求和，画图如\autoref{Taylor_fig1}。 可见随着项数增加，多项式慢慢趋近正弦函数。

\begin{figure}[ht]
\centering
\includegraphics[width=14cm]{./figures/Taylor_1.pdf}
\caption{$\sin x$ 在原点处的泰勒展开的前 $N$ 项求和。容易看出，求和的项数越多，多项式（橙）与 $\sin x$ （蓝）吻合得越好。}\label{Taylor_fig1}
\end{figure}
\end{example}

\subsection{公式的推导}
如果假设函数$f$在开区间$I$上无穷次可微, 那么可以利用分部积分公式\upref{IntBP}:
\begin{equation}
\begin{aligned}
f(x)
&=f(x_0)+\int_{x_0}^{x}f'(t)dt\\
&=f(x_0)-\int_{x_0}^{x}f'(t)\frac{d}{dt}(x-t)dt\\
&=f(x_0)+f'(x_0)(x-x_0)+\int_{x_0}^{x}f''(t)(x-t)dt.
\end{aligned}
\end{equation}
由于$(x-t)=-\frac{d}{dt}(x-t)^2/2!$, 故可以再次分部积分, 得到
\begin{equation}
\begin{aligned}
f(x)
=f(x_0)+f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2
+\frac{1}{2!}\int_{x_0}^{x}f^{(3)}(t)(x-t)^2dt.
\end{aligned}
\end{equation}
如此续行, 即得到
\begin{equation}
\begin{aligned}
f(x)
&=f(x_0)+f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+...+\frac{f^{(N)}(x_0)}{N!}(x-x_0)^N\\
&\quad+\frac{1}{N!}\int_{x_0}^{x}f^{(N+1)}(t)(x-t)^{N}dt.
\end{aligned}
\end{equation}
最后的误差可利用定积分估值估计为
\begin{equation}\label{Taylor_eq7}
\left|\frac{1}{N!}\int_{x_0}^{x}f^{(N+1)}(t)(x-t)^{N+1}dt\right|
\leq\frac{\sup_{t\in I}|f^{(N+1)}(t)|}{N!}|x-x_0|^{N+1}.
\end{equation}
显然, 这就给出了唯一一个满足开头要求的多项式近似.

\subsection{一些常见函数关于原点的泰勒展开}
作为练习，请验证以下泰勒展开式:

\begin{equation}
\sin x = x - \frac{1}{3!} x^3 + \frac{1}{5!} x^5 - \frac{1}{7!} x^7 \ldots
\end{equation}
\begin{equation}
\cos x = 1 - \frac{1}{2!} x^2 + \frac{1}{4!} x^4 -\frac{1}{6!} x^6 \ldots
\end{equation}
\begin{equation}\label{Taylor_eq11}
\E^x =1 + x + \frac{1}{2!} x^2 + \frac{1}{3!} x^3  \ldots
\end{equation}
\begin{equation}
\ln (1+x) = x - \frac12 x^2 + \frac13 x^3 - \frac14 x^4 \ldots
\end{equation}
\begin{equation}
\frac{1}{1+x} = 1 - x + x^2 - x^3 \ldots
\end{equation}
\begin{equation}
\sqrt{1+x} = 1 + \frac12 x - \frac18 x^2 + \frac{1}{16} x^3 \ldots
\end{equation}

\subsection{泰勒展开与近似}
事实上，泰勒展开可以看成是微分近似\upref{Diff}的一种高阶拓展。 微分近似中，在某点 $x_0$ 附近有
\begin{equation}
f(x) \approx f(x_0) + f'(x_0)(x - x_0)
\end{equation}
而这恰好是泰勒展开的前两项。 然而，这只是函数曲线在 $x_0$ 处的切线（见\autoref{Taylor_fig1} 中 $N=1$ 的情况），显然没有高阶的泰勒展开那么精确。 如果我们将 $f(x)$ 近似到其泰勒展开的 $x^n$ 项， 我们称这个近似精确到第 $n$ 阶， 因为它的误差小于或等于 $n + 1$ 阶无穷小\upref{Lim} $O(x^{n + 1})$。 在近似计算中, 可以使用\autoref{Taylor_eq7}来精确地估计近似多项式给出的误差. 例如, \autoref{Taylor_fig1}中画出的正弦函数与其近似多项式的误差即可按此公式计算.
% 拉格朗日方程的数值解

\begin{issues}
\issueDraft
\end{issues}

\pentry{拉格朗日方程\upref{Lagrng}}

若程序中给出拉格朗日量的数值函数 $L(q, \dot q, t)$， 输入和输出均为数值（例如双精度实数）， 那么如何数值求解运动方程呢？

问题的关键是如何列出一个一阶常微分方程组．
\begin{equation}
\dv{t} \pdv{L}{\dot q_i} = \pdv{L}{q_i}
\quad (i=1,\dots,N)
\end{equation}
根据全微分， 左边有
\begin{equation}
\dv{t} \pdv{L}{\dot q_i} = \sum_j\pdv{q_j}\pdv{L}{\dot q_i}\dot q_j + \sum_j\pdv{\dot q_j}\pdv{L}{\dot q_i}\ddot q_j + \pdv{t}\pdv{L}{\dot q_i}
\end{equation}
代入得
\begin{equation}
\sum_j\pdv{\dot q_j}\pdv{L}{\dot q_i}\ddot q_j = \pdv{L}{q_i} - \sum_j\pdv{q_j}\pdv{L}{\dot q_i}\dot q_j - \pdv{t}\pdv{L}{\dot q_i}
\end{equation}
这样， 二阶导数只存在于左边的 $\ddot q_j$， 其他项都只是 $q,\dot q, t$ 的函数． 该式中的偏微分全部可以通过差分来计算． 数值解线性方程， 就可以得到（令 $v_i = \dot q_i$）
\begin{equation}
\leftgroup{
&\dot v_i = f_i(q, v_i, t)\\
&\dot q_i = v_i
}\qquad (i = 1,\dots,N)
\end{equation}
就得到了 $2N$ 条方程组成的一阶常微分方程组， 变量一共有 $2N$ 个． 可以使用四阶龙格库塔法\upref{OdeRK4} 等方法求解．

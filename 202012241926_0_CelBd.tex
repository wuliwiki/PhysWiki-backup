% 开普勒问题
% keys 平方反比|开普勒问题|圆锥曲线轨道

\pentry{中心力场问题\upref{CenFrc}， 万有引力\upref{Gravty}， 椭圆的三种定义\upref{Elips3}， 双曲线的三种定义\upref{Hypb3}， 抛物线的三种定义\upref{Para3}}
在中心力场问题\upref{CenFrc} 中， 若 $F(r)$ 是平方反比的力（斥力为正引力为负）， 即
\begin{equation}
F(r) = \frac{k}{r^2}  \qquad V(r) = \frac{k}{r}
\end{equation}
则该问题被称为\textbf{开普勒问题}． 对于万有引力， 有 $k = -GMm$， 对于异种电荷间的库仑力\upref{ClbFrc}， 有\footnote{高中所学的库仑定律的系数 $k$ 在大学物理中通常记为 $1/(4\pi\epsilon_0)$， 其中 $\epsilon_0$ 为真空中的电介质常数．} $k = Qq/(4\pi\epsilon_0)$．

在开普勒问题中， 质点的轨道是圆锥曲线的一种， 力心处于焦点． 质点的机械能（动能加势能） $E$ 和角动量 $L$ 可以唯一地确定轨道的形状和大小． 轨道的形状一般由离心率 $e$ 描述， 大小由半通径 $p$ 描述（\autoref{Cone_eq5}~\upref{Cone}）． $E < 0$ 对应椭圆轨道， $E = 0$ 对应抛物线轨道\footnote{显然只有引力（$k < 0$）可以产生非正机械能， 即椭圆轨或抛物线轨道．}， $E > 0$ 对应双曲线轨道． 注意双曲线轨道有两支， 当 $k < 0$ （引力）时取离中心天体较近的一支， $k > 0$ （斥力）时取较远的一支．
\begin{align}
e &= \sqrt{1 + \frac{2EL^2}{mk^2}}\label{CelBd_eq2}\\
p &= \frac{L^2}{m\abs{k}}\label{CelBd_eq3}
\end{align}
椭圆或双曲线的大小和形状也可以由参数 $a,b$ 描述． $a,b$ 与 $e,p$ 的对应关系见“椭圆的三种定义\upref{Elips3}”和“双曲线的三种定义\upref{Hypb3}”．
\begin{align}
a &= \frac{\abs{k}}{2\abs{E}}\label{CelBd_eq7}\\
b &= \frac{L}{\sqrt{2m\abs{E}}}\label{CelBd_eq8}
\end{align}
证明见下文．

\subsection{位置与时间的关系}
若已知轨道形状， 我们来计算质点在轨道上的位置如何关于时间变化． 由\autoref{CenFrc_eq8}~\upref{CenFrc}得
\begin{equation}
t = \sqrt{\frac{m}{2}} \int_{r_0}^r \frac{\dd{r'}}{\sqrt{E - k/r' - L^2/(2mr'^2)}}
\end{equation}
该式对任何圆锥曲线轨道都适用， 其中 $r_0$ 是轨道离中心最近的一点， 令质点经过该点时 $t= 0$． 把这个积分的结果 $t(r)$ 取反函数， 就可以得到 $r(t)$． 同理， 有
\begin{equation}
\dd{t} = \frac{mr^2}{L}\dd{\theta}
\end{equation}
代入\autoref{Cone_eq5}~\upref{Cone}积分得
\begin{equation}
t = \frac{L^3}{mk^2} \int_{\theta_0}^\theta \frac{\dd{\theta'}}{(1 - e\cos \theta')^2 }
\end{equation}
对于\textbf{抛物线}， 有
\begin{equation}
t = \frac{L^3}{2mk^2} \qty(\tan\frac{\theta}{2} +  \frac{1}{3}\tan^3 \frac{\theta}{2})
\end{equation}

对于\textbf{椭圆}， 可以用一个参数\textbf{偏近点角（eccentric anomaly）} $\psi$ 来代替 $\theta$ 会更方便， 当 $\theta$ 从 $0$ 变化到 $2\pi$ 时， $\psi$ 也从 $0$ 变化到 $2\pi$， 只是速度不一样．
\begin{equation}
r = a(1-e\cos\psi)
\end{equation}
\begin{equation}
t = \sqrt{\frac{ma^3}{-k}} \int_0^\psi (1 - e\cos\psi')\dd{\psi'}
\end{equation}
开普勒第二定律也可以由该式验证．

对于\textbf{双曲线}（$k<0$）， 偏近点角使用不同的定义， 可取任意实数， 使得（推导未完成）
\begin{equation}
r = a(e\cosh\xi - 1)
\end{equation}
\begin{equation}
t = \sqrt{\frac{a^3}{-k}} (e\sinh\xi - \xi)
\end{equation}

\subsection{证明}
我们暂且假设质点轨道为圆锥曲线， 证明过程以后会在“普勒第一定律的证明\upref{Keple1}” 中看到．

\subsubsection{椭圆轨道}
令椭圆轨道距离焦点的最近和最远距离分别为 $r_1$ 和 $r_2$，列出总能量（动能加势能）守恒
\begin{equation}\label{CelBd_eq4}
\frac12 m v_1^2 - \frac{k}{r_1} = \frac12 mv_2^2 - \frac{k}{r_2}
\end{equation}
以及角动量守恒
\begin{equation}\label{CelBd_eq5}
mv_1 r_1 = mv_2 r_2
\end{equation}
把\autoref{CelBd_eq5} 中的 $v_2$ 代入\autoref{CelBd_eq4}，可得
\begin{equation}\label{CelBd_eq6}
v_1^2 = \frac{2k/m}{r_1 + r_2} \frac{r_2}{r_1}
\end{equation}
代入\autoref{CelBd_eq4} 的左边，并使用 $r_1+r_2=2a$ （\autoref{Elips3_eq9}~\upref{Elips3}）得到总能量
\begin{equation}\label{CelBd_eq9}
E = -\frac{k}{2a}
\end{equation}
把\autoref{CelBd_eq6} 代入\autoref{CelBd_eq5} 的左边，并使用 $r_1 r_2 = (a+c)(a-c) =b^2$ %未完成： 此处该引用公式
得角动量
\begin{equation}\label{CelBd_eq10}
L = b\sqrt{\frac{mk}{a}}
\end{equation}
将\autoref{CelBd_eq9} 和\autoref{CelBd_eq10} 逆转即可得到\autoref{CelBd_eq7} 和\autoref{CelBd_eq8}． 要得到\autoref{CelBd_eq2} \autoref{CelBd_eq3}， 只需使用\autoref{Elips3_eq7}~\upref{Elips3} 和\autoref{Elips3_eq8}~\upref{Elips3} 即可．

\subsubsection{双曲线轨道}
注意开普勒问题中的双曲线轨道只可能是双曲线离中心天体所在焦点较近的一支（较远的一支以后会在“反开普勒问题\upref{InvKep}” 中见到）． 令双曲线轨道离焦点最近的距离为 $r_1$， 可列出总能量守恒
\begin{equation}\label{CelBd_eq11}
\frac12 mv_0^2 = \frac12 mv_1^2 - \frac{k}{r_1}
\end{equation}
该式左边表示质点在无穷远处的总能量， 此时势能为 $0$， 总能量等于动能．再来看角动量守恒
\begin{equation}\label{CelBd_eq12}
m v_0 b = m v_1 r_1
\end{equation}
该式左边为无穷远处的角动量． 由\autoref{Hypb3_eq11}~\upref{Hypb3} 可知， 在无穷远处， 双曲线的渐近线与焦点的距离为 $b$．

用以上两式消去 $v_1$， 再利用 $r_1 = a - c$， 得
\begin{equation}\label{CelBd_eq13}
E = \frac 12 m v_0^2 = \frac{k}{2a}
\end{equation}
再将该式的 $v_0$ 代入\autoref{CelBd_eq12} 左边得到与\autoref{CelBd_eq10} 同样的结果．

\subsubsection{抛物线轨道}
已知抛物线轨道的总能量为零， 抛物线轨道离焦点的最近距离为焦距 $p/2$， 该点处， 动量和能量为
\begin{align}
L &= mv_0 \frac p2\\
0 = E &= \frac 12 mv_0^2 - \frac{k}{p/2}
\end{align}
两式消去 $v_0$ 得角动量为 $L = \sqrt{mkp}$． 证毕．

% 正交变换与对称变换
% license Usr
% type Tutor


\begin{issues}
\issueDraft 全文替换向量
\end{issues}

本文用“$(x,y)$”表示对任意两个向量作内积。
\subsection{正交变换}
\begin{definition}{}
定义实内积空间$V$上的满射$\mathcal A$。对于任意$(x,y)\in V$，若有：
\begin{equation}
(x,y)=(\mathcal A x,\mathcal A y)~,
\end{equation}
则称$\mathcal A$是$V$上的\textbf{正交变换}。也就是说，正交变换是保内积不变的满射，从而保向量长度和向量之间的夹角不变。
\end{definition}
实际上，正交变换是线性变换。
\begin{theorem}{}
实内积空间$V$上的正交变换$\mathcal A$一定是线性映射。
\end{theorem}
\textbf{证明：}
\begin{equation}
\begin{aligned}
|\mathcal A(x+y)-(\mathcal Ax+\mathcal Ay)|^2&=(x+y)^2+x^2+y^2-2\left(\mathcal A(x+y),\mathcal Ax+\mathcal Ay\right)\\
&=(x+y)^2+x^2+y^2-2(x+y,x)-2(x+y,y)\\
&=0
\end{aligned}
~,\end{equation}

因而$\mathcal A(x+y)=\mathcal Ax+\mathcal Ay$。同理可得$\mathcal A(kx)=k\mathcal A(x)$。

设$\{\bvec e_i\}^k_{i=1}$是$V$上的一组基，由线性性可知，$\{\mathcal A\bvec e_i\}^k_{i=1}$也是线性无关组。又因为$\mathcal A$是满射，所以$\{\mathcal A\bvec e_i\}^k_{i=1}$是$V$上的一组基，则该线性映射既单又满，是“同构映射”。由正交变换保内积可知，$\mathcal A$\textbf{把标准正交基映射为标准正交基。}

总结上述讨论，易证：$\mathcal A$是正交变换$\Longleftrightarrow \mathcal A$\textbf{把标准正交基映射为标准正交基。}后者是正交矩阵的定义，可见正交矩阵是正交变换的矩阵表示。\textbf{正交矩阵保二次型不变的性质等价于正交变换的内积定义，}\footnote{广义内积即二次型决定的对称双线性函数：$(x,y)\equiv \frac{1}{2}(q(x+y)-q(x)-q(y))$}或者说——

$\mathcal A$是正交变换$\Longleftrightarrow $对任意$x\in V,|\mathcal Ax|=|x|$。

令$O(n)$表示$n$维线性空间$V$上全体正交变换的集合。由定义可知，该集合具有如下性质：
\begin{enumerate}
\item 封闭性。若$A,B\in O(n)$，则$AB\in O(n)$；
\item 结合性。若$A,B,C\in O(n)$，则$A(BC)=(AB)C$；
\item 单位元存在性。$I\in O(n)$；
\item 逆元存在性。若$A\in O(n)$，则$A^-1\in O(n)$；
\end{enumerate}
所以，正交变换构成一个群。

在欧几里得空间中，正交矩阵的行列式为$1$或者$-1$，常称行列式为$1$的正交变换为\textbf{第一类的（旋转）}；行列式为$-1$的正交变换则是\textbf{第二类的}。
\subsubsection{正交变换的特征值}
由上述讨论可知，正交变换若有特征向量，则特征值的模长为$1$，从而保证向量的模长不变。
\begin{corollary}{}
 设$\lambda$为正交变换$A$的特征值，则$|\lambda|=1$。若$V$定义在实数域上，$\lambda=\pm 1$。
\end{corollary}
\begin{corollary}{}
若$V$是奇数维线性空间，$A$必有特征值$1$。
\end{corollary}
\textbf{证明：}
实数域上易证推论2，下面讨论复数域的情况。由于特征值是特征多项式的根，且一元多项式方程里复根成对出现（若$\lambda_0$为特征值，则$\lambda_0^{*}$也为特征值），所以$A$有偶数个模为$1$的复根，这些特征值连乘为$1$。结合行列式等于特征值连乘这一\autoref{the_MatEig_3}~\upref{MatEig}，可知剩下奇数个连乘结果为1的实特征值，得证。
\subsubsection{正交变换的块对角形式}
为了简化正交矩阵的形式，我们先来证明两个常用结论。
\begin{lemma}{}
设$f$为\textbf{实线性空间}$V$上的线性映射，存在$f$的不变子空间$W\subseteq V$，且$\opn{dim}W\in\{1,2\}$。
\end{lemma}
\textbf{证明：\footnote{参考Jier Peter的《代数学基础》}}

若$f$有若干个实特征值，则其对应的特征向量是$V$上的一维不变子空间。

将$n$维$V$复化为$U$。若$\{\bvec e_i\}$为$V$上的一组基，则任意$x\in U$可表示为：
\begin{equation}
x=a^i\bvec e_i+\mathrm i b^j\bvec e_j=\bvec u+\mathrm i\bvec v~.
\end{equation}
其中$a^i,b^i\in \mathbb R,\bvec u,\bvec v\in V$。显然$U\supseteq V$。
在复数域上，$f$有$n$个特征值。设有$k$个实特征值，则对应的特征向量是$V$上的一维不变子空间。设复特征值表示为$a+\mathrm ib$，对应特征向量表示为$x+\mathrm i y\,(x,y\in V)$。利用$f$的线性可得：
\begin{equation}
\begin{aligned}
f(x+\mathrm i y)&=(a+\mathrm i b)(x+\mathrm i y)\\
&=(ax-by)+\mathrm i(ay+bx)\\
&=f(x)+\mathrm if(y)
\end{aligned}~.
\end{equation}
即：
\begin{equation}\label{eq_ortho_1}
\begin{aligned}
f(x)&=ax-by\\
f(y)&=ay+bx
\end{aligned}~,
\end{equation}
所以$\opn{Span}\{x,y\}$为$f$在$V$上的一个二维不变子空间。
\begin{lemma}{}
若正交变换$A$有复根，对应特征向量$x=\bvec u+\mathrm i\bvec v$。则$\bvec u,\bvec v$是相互正交的特征向量。令$W=\opn{Span}\{\bvec u,\bvec v\}$，则有：
\begin{equation}\label{eq_ortho_2}
A|_W=\left[\begin{array}{rr}
\cos \phi & \sin \phi \\
-\sin \phi & \cos \phi
\end{array}\right]~.
\end{equation}
\end{lemma}
\textbf{证明：}
设复特征值$\lambda=a+b\mathrm i=\opn{cos}\phi+\mathrm i \opn{sin}\phi$，代入\autoref{eq_ortho_1} 便可得形式为\autoref{eq_ortho_2} 的$A|_W$。接下来只需要证明实部和虚部分量是标准正交即可。为方便计，把转置操作表示为'。

由于$kx$依然是$A$的特征向量，我们可以归一化其实部分量，使得$\bvec u^2=1$。则
\begin{equation}
\ali
\end{equation}

由于$A'=A^{-1}$且$Ax=\lambda x$，则$A'x=A^{-1}x=\frac{1}{\lambda}x=\lambda^* x$。左乘特征向量的转置得：
\begin{equation}
x'A'x=\lambda^* x'x=(Ax)'x=\lambda x'x~,
\end{equation}
因此$x'x=0$。


\begin{lemma}{}
设$A$为$V$上的正交变换，若$W$为其不变子空间，则$W^{\bot}$也是其不变子空间。
\end{lemma}
设$\{\bvec e_i\}$为$W$上的一组标准正交基，并扩展到全空间，使得$\opn{Span}\{\bvec {\theta}_i\}$张成$W^{\bot}$。由题设知$\{A\bvec e_i\}$依然张成$W$，由于$(A\bvec {\theta}_i,A\bvec e_i)=0$，因此$A\bvec{\theta}_i\in W^{\bot}$，得证。

由定理3可知，在$\{\bvec e_i\}\cup\{\bvec {\theta}_i\}$下，$A$有块对角形式：$A=A|_W\oplus A|_{W^{\bot}}$。实际上，该块对角形式可以进一步“细化”。
\begin{theorem}{}
设$A$为\textbf{实线性空间}$V$上的正交变换。则在$V$内存在一组\textbf{标准正交基}，使得$A$具有如下块对角形式：
\begin{equation}
A=\left[\begin{array}{lllllll}
\lambda_1 & & & & & & \\
& \lambda_2 & & & & & \\
& & \ddots & & & 0 & \\
& & & \lambda_k & & & \\
& & & & S_1 & & \\
& & 0 & & & \ddots & \\
& & & & & & S_l
\end{array}\right]~,
\end{equation}
其中$\lambda_i=\pm 1(i=1,2...k)$，$S_i$为二阶非对角矩阵。
\end{theorem}

\subsection{对称变换}



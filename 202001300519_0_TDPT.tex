% 含时微扰理论
% 微扰理论|量子力学|薛定谔方程|近似
% 未完成：是否考虑把系数 C 换成 c 以区分矢量和矩阵

在讲微扰理论之前，我们先来看如何把含时薛定谔方程写为矩阵的形式．含时薛定谔方程的一般形式为
\begin{equation}\label{TDPT_eq1}
H \ket{\psi(t)} = \I\hbar \pdv{t} \ket{\psi(t)}
\end{equation}
我们把哈密顿算符分为含时部分和不含时部分
\begin{equation}
H = H_U + H'(t)
\end{equation}
我们已经知道 % 链接未完成
$H'(t) = 0$ 的情况下含时薛定谔方程的通解：先解出对应的定态薛定谔方程的波函数 $\ket{\psi_n}$ 和能级 $E_n$，通解可表示为
\begin{equation}
\ket{\psi_U(t)} = \sum_n c_n \ket{\psi_n} \E^{-\I E_n t/\hbar}
\end{equation}
注意其中 $c_n$ 为常数，由初始波函数决定．我们可以定义一组含时基底
\begin{equation}
\ket{\phi_n(t)} = \ket{\psi_n} \E^{-\I E_n t/\hbar}
\end{equation}
用于展开\autoref{TDPT_eq1} 中的含时波函数．注意任何时刻这组基底都正交归一．
\begin{equation}
\ket{\psi(t)} = \sum_n c_n(t) \ket{\phi_n(t)} = \sum_n c_n(t) \ket{\psi_n} \E^{-\I E_n t/\hbar}
\end{equation}
由于基底并不是总哈密顿算符的本征矢，系数需由常数拓展为时间的函数．

选择了基底后，就可以把薛定谔方程表示为矩阵的形式． % 链接未完成
把上式代入薛定谔方程（\autoref{TDPT_eq1}）得
\begin{equation}\begin{aligned}
&\sum_n c_n(t) H_0 \ket{\phi_n(t)} + \sum_n c_n(t) H'(t) \ket{\phi_n(t)} \\ 
={} &\I\hbar \sum_n \dv{t} c_n(t) \ket{\phi_n(t)}
+ \I\hbar \sum_n c_n(t) \dv{t} \ket{\phi_n(t)}
\end{aligned}\end{equation}
考虑到上式左边的 $H_0\ket{\phi_n(t)} = E_n\ket{\phi_n(t)}$ 和右边的 $\I\hbar \dv*{\ket{\phi_n(t)}}{t} = E_n\ket{\phi_n(t)}$ 相等，可化简为
\begin{equation}
\sum_n c_n(t) H'(t) \ket{\phi_n(t)}
= \I\hbar \sum_n \dv{t} c_n(t) \ket{\phi_n(t)}
\end{equation}
两边左乘 $\bra{\phi_m(t)} = \E^{\I E_m t/\hbar}\bra{\psi_m}$ 得\footnote{这样做的物理意义是要求每个基底上的分量相等} % 链接未完成
\begin{equation}\label{TDPT_eq2}
\sum_n H'_{mn} c_n(t)
= \I\hbar \dv{t} c_m(t)
\end{equation}
其中
\begin{equation}\label{TDPT_eq7}
H'_{mn} = \bra{\phi_m(t)} H'(t) \ket{\phi_n(t)} = \bra{\psi_m} H'(t) \ket{\psi_n} \E^{\I(E_m-E_n)t/\hbar}
\end{equation}
把\autoref{TDPT_eq2} 写成矩阵形式为（对矢量求导即对每个分量分别求导\upref{DerV}）
\begin{equation}\label{TDPT_eq3}
\mat {H'} \bvec c = \I\hbar \dv{t} \bvec c
\end{equation}
到此为止我们还没有做任何近似，上式和\autoref{TDPT_eq1} 完全等效．

若哈密顿算符中的势能包含时间，只有极少数情况下存在解析解．这时我们可以用\textbf{含时微扰理论}来近似求解．类比不含时微扰理论，我们引入一个常数 $\lambda$ 来分离不同阶数的近似，最后只需令 $\lambda = 1$ 即可．理论上当阶数足够高时，近似解将会逼近精确解．% 未完成：真的吗？？

令哈密顿算符，系数矢量分别为
\begin{equation}
H = H_0 + \lambda H'(t)
\end{equation}
\begin{equation}
\bvec c(t) = \bvec c^{(0)}(t) + \lambda\bvec c^{(1)}(t) + \lambda^2\bvec c^{(2)}(t) \dots
\end{equation}
代入\autoref{TDPT_eq3}，根据 $\lambda = 1$ 的阶数分离方程，得
\begin{align}
&\dv{t} \bvec c^{(0)}(t) = \bvec 0 &&\text{（0 阶近似）}\label{TDPT_eq4}\\
&\dv{t} \bvec c^{(1)}(t) = \frac{1}{\I\hbar} \mat H'(t) \bvec c^{(0)}(t) &&\text{（1 阶近似）} \label{TDPT_eq5}\\
%\vdots\notag \\
&\dv{t} \bvec c^{(n)}(t) = \frac{1}{\I\hbar} \mat H'(t) \bvec c^{(n-1)}(t) &&\text{（$n$ 阶近似）} \label{TDPT_eq6}
\end{align}

为了求解各阶近似，我们假设 $t=0$ 时只有 0 阶系数 $\bvec c^{(0)}(0)$ 不为零．若给出初始波函数 $\ket{\psi(0)}$，可用 $\ket{\phi_n(0)} = \ket{\psi_n}$ 展开得到 $\bvec c^{(0)}(0)$．\autoref{TDPT_eq4} 说明零阶系数矢量为常数，所以零阶近似解就是 $\bvec c^{(0)}(t) = \bvec c^{(0)}(0)$．继续把 $\bvec c^{(0)}(t)$ 代入\autoref{TDPT_eq5}，两边对时间从 0 到 $t$ 定积分（矢量的积分即对每个分量分别积分）得
\begin{equation}
\bvec c^{(1)}(t) - \bvec c^{(1)}(0) = \frac{1}{\I\hbar} \int_{0}^{t}  \mat H'(t) \bvec c^{(0)}(t) \dd{t}
\end{equation}
代入 $\bvec c^{(1)}(0) = 0$，$\bvec c^{(0)}(t) = \bvec c^{(0)}(0)$，得一阶近似解为
\begin{equation}\label{TDPT_eq9}
\bvec c^{(1)}(t) = \frac{1}{\I\hbar} \int_{0}^{t}  \mat H'(t)\bvec c^{(0)}(0) \dd{t}
\end{equation}
类似地，对\autoref{TDPT_eq6} 积分，若已知 $\bvec c^{(n-1)}(t)$， 有
\begin{equation}\label{TDPT_eq8}
\bvec c^{(n)}(t) = \frac{1}{\I\hbar} \int_{0}^{t}  \mat H'(t) \bvec c^{(n-1)}(t) \dd{t}
\end{equation}
所以要想得到 $n$ 阶近似解，积分 $n$ 次即可．要注意的是，许多教材中不使用\autoref{TDPT_eq7} 定义矩阵 $\mat H'$，而是定义其矩阵元为\textbf{跃迁偶极子（Transition Dipole）} \begin{equation}
H'_{mn} = \bra{\psi_m} H'(t)\ket{\psi_n}
\end{equation}
为了明确起见，\autoref{TDPT_eq8} 的分量表达式为
\begin{equation}
c_i^{(n)}(t) = \frac{1}{\I\hbar} \int_{0}^{t}  \sum_j \bra{\psi_i} H'(t)\ket{\psi_j} \E^{\I(E_i-E_j)t/\hbar} c_j^{(n-1)}(t) \dd{t}
\end{equation}

大多数情况下我们只使用一阶近似，一种较简单的情况是，若初始波函数为某一个 $\ket{\psi_i}$， 且 $\bra{j}\Q H'\ket{i} = W_{ji}f(t)$，$W_{ji}$ 为常数，此时\autoref{TDPT_eq9} 变为 $f(t)$ 关于角频率 $\omega_{ji} = (E_j-E_i)/\hbar$ 的反傅里叶变换．
\begin{equation}
c_j^{(1)}(t) = \frac{W_{ji}}{\I\hbar} \int_0^t f(t)\E^{\I\omega_{ji} t} \dd{t}
\end{equation}
所以在一阶近似中，波函数在 $[0,t]$ 时间段内由 $\ket{\psi_i}$ 跃迁到 $\ket{\psi_j}$ 的概率约为
\begin{equation}
P_{ji}(t) = \abs{c_j^{(1)}(t)}^2
\end{equation}
